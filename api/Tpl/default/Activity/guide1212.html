<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
		<meta name="format-detection" content="telephone=no" searchtype="map">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="360-site-verification" content="188bc9bbbe2e50aaf86c811cf61d5cdb" />
		<meta name="baidu-site-verification" content="ayLnKZTrby" />
		<meta name="sogou_site_verification" content="gz86ImwtMQ"/>
		<title>12.12主会场</title>
		<script>
			var version = location.href.indexOf("?tdev") > 0 ? (1 + Math.round(Math.random() * 9999 - 1)) : '1.2';
			document.write('<link href="/statics/css/tBase.css?v='+version+'" rel="stylesheet" type="text/css" />');
			document.write('<link href="/statics/css/1212themes.css?v='+version+'" rel="stylesheet" type="text/css" />');
			(function(b, c) {
				var d = b.documentElement,
					resizeEvt = 'orientationchange' in c ? 'orientationchange' : 'resize',
					recalc = function() {
						var a = d.clientWidth
						if (!a) return;
						d.style.fontSize = (20 * (a / 320)) > 40 ? 40 + "px" : (20 * (a / 320)) + 'px'
					},
					anime = c.requestAnimationFrame || c.webkitRequestAnimationFrame || c.mozRequestAnimationFrame || c.oRequestAnimationFrame ||
				function(e) {
					return setTimeout(e, 16.67)
				};
				if (!b.addEventListener) return;
				c.addEventListener(resizeEvt, recalc, false);
				b.addEventListener('DOMContentLoaded', recalc, false)
			})(document, window);
			function connectWebViewJavascriptBridge(callback) {
			    if (window.WebViewJavascriptBridge) {
			        callback(WebViewJavascriptBridge)
			    } else {
			        document.addEventListener('WebViewJavascriptBridgeReady',
			        function() {
			            callback(WebViewJavascriptBridge)
			        },
			        false)
			    }
			}
			connectWebViewJavascriptBridge(function(bridge) {

			    /* Init your app here */

			    // 刚进来就调用
			    bridge.init(function(message, responseCallback) {
			        if (responseCallback) {
			            responseCallback("Right back atcha")
			        }
			    });
			    bridge.send('Please respond to this',
			    function responseCallback(responseData) {
			        console.log("Javascript got its response", responseData)
			    });
			}); 

			var browser = {
			  versions: function () {
			      var u = navigator.userAgent, app = navigator.appVersion;
			      return { //移动终端浏览器版本信息 
			          mobile: !!u.match(/AppleWebKit.*Mobile.*/),
			          ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端 
			          android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器 
			          iPhone: u.indexOf('iPhone') > -1, //是否为iPhone或者QQHD浏览器 
			         iPad: u.indexOf('iPad') > -1, //是否iPad]
			         weixin : u.match("MicroMessenger")
			     };
			 }(),
			};
		</script>
	</head>
	<body>
		<div class="mainHost">
			<div class="headBanner1">
				<!-- banner区域 -->
				<div class="headerBanner">
					<img src="/statics/images/1212themes/mainBanner01_12.jpg" />
					<img src="/statics/images/1212themes/mainBanner02_12.jpg" />
					<img src="/statics/images/1212themes/mainBanner03_12.jpg" />
					<img src="/statics/images/1212themes/mainBanner04_12.jpg" />
					<!--<img src="/statics/images/1212themes/mainBanner05_12.jpg" />
					<img src="/statics/images/1212themes/mainBanner06_12.jpg" />-->
				</div>
			</div>

			<!-- 今日抄底价 -->
			<div class="ThemesBigBox">
				<img src="/statics/images/1212themes/mainBanner10_12.png" title="ThemesboxBanner" class="BannerTitle"/>
				<div class="ThemesBanner">
				</div>
			</div>
			<!-- 商品列表1 -->
			<div class="proList">
				<img src="/statics/images/1212themes/mainBanner11_12.png" class="BannerTitle" />
				<ul class="gmPro clearFix">
				</ul>
			</div>
			<!-- 商品列表2 -->
			<div class="proList">
				<img src="/statics/images/1212themes/mainBanner12_12.png" class="BannerTitle" />
				<ul class="wlPro clearFix">
				</ul>
			</div>
			<!-- 商品列表3 -->
			<div class="proList">
				<img src="/statics/images/1212themes/mainBanner13_12.png" class="BannerTitle" />
				<ul class="wrPro clearFix">
				</ul>
			</div>
			<!-- 商品列表4 -->
			<div class="proList">
				<img src="/statics/images/1212themes/mainBanner14_12.png" class="BannerTitle" />
				<ul class="czPro clearFix">
				</ul>
			</div>
			<a class="shareBtn" href="javascript:;"></a>
			<i class="toTop"></i>
		</div>
		<!-- 主题会场 -->
		<div class="ThemesBox">
			<img src="/statics/images/1212themes/mainBanner22.png" title="ThemesboxBanner" />
			<div class="ThemesItem">
				<a href="javascript:;" class="otherThemes_link" pros-status="0" data-id="44" pro-type="1">
					<img src="/statics/images/1212themes/mainBanner15.jpg" title="ThemesboxBanner" />
				</a>
				<a href="javascript:;" class="otherThemes_link" pros-status="0" data-id="39" pro-type="2">
					<img src="/statics/images/1212themes/mainBanner16.jpg" title="ThemesboxBanner" />
				</a>
				<a href="javascript:;" class="otherThemes_link" pros-status="0" data-id="41" pro-type="3">
					<img src="/statics/images/1212themes/mainBanner17.jpg" title="ThemesboxBanner" />
				</a>
				<a href="javascript:;" class="otherThemes_link" pros-status="0" data-id="32" pro-type="4">
					<img src="/statics/images/1212themes/mainBanner18.jpg" title="ThemesboxBanner" />
				</a>
				<a href="javascript:;" class="otherThemes_link" pros-status="0" data-id="40" pro-type="5">
					<img src="/statics/images/1212themes/mainBanner19.jpg" title="ThemesboxBanner" />
				</a>
				<!-- <a href="javascript:;" class="jumpH5">
					<img src="/statics/images/1212themes/mainBanner20.jpg" title="ThemesboxBanner" />
				</a> -->
				<a href="javascript:;" class="otherThemes_link" pros-status="0" data-id="42" pro-type="6">
					<img src="/statics/images/1212themes/mainBanner20.jpg" title="ThemesboxBanner" />
				</a> 
			</div>
		<a href="javascript:;" class="tb-meet"><img src="/statics/images/1212themes/mainBanner25.jpg"></a>
		</div>
		<a href="javascript:;" class="bBanner"><img src="/statics/images/1212themes/mainBanner21.png"/></a>
	</body>
	<!--<script src="/statics/js/mobstat.js"></script>-->
	<script src="http://img1.static.feibo.com/double11/jquery-1.8.0.min.js"></script>
	<script src="http://img1.static.feibo.com/double11/jquery.lazyload.js"></script>
		
	<script>
		$(".tabs ul li").on("click",function(){
			var index = $(this).index();
			var $list = $(".TimeboxStart").children("div.listbox");
			$(this).addClass("current").siblings().removeClass("current");
			$list.eq(index).show().siblings("div.listbox").hide();
		})
		var $win = $(window),$doc = $(document);
		var jump = true;
		var init = {
			aFuc : function(){
				var c = function(data){
					var d = data.data, kbPro = "", proL = "", k = d.list['口碑爆款'], gm = d.list['国民小食'], gmLenght = gm.length, wl = d.list['味蕾旅行'], wlLenght = wl.length, wr = d.list['无肉不欢'], wrLenght = wr.length, cz = d.list['超值精选'], czLenght = cz.length;

					//口碑爆款信息加载
					for(i = 0;i<k.length;i++){
						kbPro += '<a href="javascript:void(0)" class="themes_link"><img data-original="' + k[i].image_src + '" /><i></i></a>' 
					}
					$(".ThemesBanner").html(kbPro);
					//商品列表信息加载
					var proList = function(obj,data,dLenghth,proL){
						for(i = 0;i<dLenghth;i++){
							if(data[i].title==""||data[i].title==null||data[i].title==" "){
								data[i].title = "该商品暂无标题";
							}
							if(data[i].desc==""||data[i].desc==null||data[i].desc==" "){
								data[i].desc = "该商品暂无描述";
							}
							proL += '<li><i></i><a href="javascript:;" class="themes_link"><div class="img"><div class="imgBox"><img data-original="' + data[i].image_src + '" /></div><div class="imgTitle"><span class="bigTitle">' + data[i].title + '</span><span class="smallTitle">' + data[i].desc + '</span></div></div><div class="priceBox clearFix"><div class="priceFl priceFlBox"><span class="current_price"><span class="market_price">¥</span>' + data[i].price + '</span></div><span class="themes_link nowBtn" title="now"></span></div></a></li>';	
						}
						obj.html(proL); 
					}
					proList($('.gmPro'),gm,gmLenght,proL);
					proList($('.wlPro'),wl,wlLenght,proL);
					proList($('.wrPro'),wr,wrLenght,proL);
					proList($('.czPro'),cz,czLenght,proL);

					$("img[data-original]").lazyload({
						"effect" : "fadeIn"
					});

					var w=$(".TimeboxStart ul li img").width();
					var w2=$(".imgBox img").width();
					var w3=$(".priceBox .nowBtn").width();
					$(".TimeboxStart ul li img").css("height",w);
					$(".imgBox").css("height",w2);
					$(".priceBox .nowBtn").css("height",w3/(1.3))

					/* mid */
					for(var i in k) {//给口碑爆款商品加上商品id和商品状态
						$(".ThemesBanner").children("a").eq(i).attr("data-id",k[i].spu_id).attr("pros-status",k[i].status);
					}
					$('.ThemesBanner').find('a').each(function(){
						var pros_status = $(this).attr('pros-status');
						if(pros_status == 1){
							$(this).addClass('out');
						}
					})		
					var proMs = function(a,t){//商品状态判断，加上对应的售空样式
						for(var i in a) {
							var status = a[i].status;
							// 类型：0，正常状态；1,已售空;
							switch(status) {
								case 0 : ''; break;
								case 1 : $(".proList:eq("+t+") ul").children("li").eq(i).addClass("out");break;
							}
							$(".proList:eq("+t+") ul").children("li").find("a").eq(i).attr("data-id",a[i].spu_id).attr("pros-status",a[i].status);
						}
					}
					/* 商品状态判断，加上对应的售空样式方法调用 */
					proMs(gm,0),proMs(wl,1),proMs(wr,2),proMs(cz,3);


					var host = window.location.host;//获取当前域名
					var shareIn = {
						title : "high购72小时，不止50%",
				        desc : "登陆就送46元优惠券！感恩有礼，全场满赠！你不可错过的零食狂欢节！",
				        imgUrl : "http://" +  host + "/statics/images/share/share_icon.jpg"
					} 

					if(browser.versions.android) {
//						try{
//							window.bridge.mainActivityPageStart();
//						}catch(e){
//							console.log("error");									
//						}
						$(".themes_link").on("click",function(){
							if (jump) {
								jump = false;
								// 在进行中，而且在没有售空的状态下可跳转商品详情
								var status = $(this).attr("pros-status");
								if(status == 0) {
									var id = parseInt($(this).attr("data-id"));
									//alert(id);
									window.bridge.javascriptJumpAction(16,"",id,"");
								}
								jump = true;
							};
						});
						$(".otherThemes_link").on("click",function(){
							// 在进行中，而且在没有售空的状态下可跳转商品详情
							
							var status = $(this).attr("pros-status");
							if (jump) {
								jump = false;
								if(status == 0) {
									var id = parseInt($(this).attr("data-id"));
									var typeStr = $(this).attr("pro-type");
									if(typeStr==1){
										typeStr = "进口零食";
									}
									if(typeStr==2){
										typeStr = "无肉不欢";
									}
									if(typeStr==3){
										typeStr = "甜蜜风暴";
									}
									if(typeStr==4){	
										typeStr = "坚果狂欢";
									}
									if(typeStr==5){
										typeStr = "国民小食";
									}
									if(typeStr==6){
										typeStr = "冲饮";
									}
									window.bridge.javascriptJumpAction(4,typeStr,id,"");
								}
								jump = true;
							};
						});
						//设置title
    					 window.bridge.setAppTitle("12.12主会场");
    					$(".shareBtn").on("click",function() { 
					        window.bridge.setShareInfo(0, shareIn.desc,shareIn.title, shareIn.imgUrl,"http://" + host + "/api/Tpl/default/Activity/shareGuide1212.html",0);
					    });

//  					//口碑爆款埋点
							$('.ThemesBanner').find('a').on('click',function(){
								var kbIndex = $(this).index()+1;
//								try{
//									window.bridge.clickActivityKoubei('口碑爆款_'+kbIndex+'');
//								}catch(e){
//									console.log("error");									
//								}
								
							})
//
//						//淘宝分会场
							$('.tb-meet').on("click",function(){
								window.bridge.javascriptJumpAction(1,"淘宝零食会场","http://s.click.taobao.com/lmvpkix","");
//								try{
//									window.bridge.clickActivityTaobao('淘宝分会场');
//									}catch(e){
//									console.log("error");									
//								}
							});
/
//						//点击主会场分类埋点
							$('.ThemesItem').find('a').on('click',function(){
								var ThemesIndex = $(this).index()+1;
//								try{
//								window.bridge.clickActivityClassify('主会场分类_'+ThemesIndex+'');
//								}catch(e){
//									console.log("error");									
//								}
							})

						// 商品列表分类
							$('body').delegate('.proList li','click',function(){
									var porlistIndex;
									var d = $(this).parents('.proList').index();
									var proIndex =  $(this).index(); 
										a = $(this).parents('.proList').prevAll('.proList').find('li').length;
										porlistIndex = a + proIndex + 1;
//										try{
//									window.bridge.clickActivityGoodsList('商品列表_'+porlistIndex+'');
//									}catch(e){
//									console.log("error");									
//								}
							})

							//卸载页面时埋点
							$(window).on('unload', function(){
//								try{
//								  window.bridge.mainActivityPageEnd();
//								  }catch(e){
//									console.log("error");									
//								}
							});
					}else if(browser.versions.iPhone || browser.versions.iPad){

					     connectWebViewJavascriptBridge(function(bridge) {
							$(".themes_link").on("click",function(){
								// 在进行中，而且在没有售空的状态下可跳转商品详情
								
								var status = $(this).attr("pros-status");
								if(status == 0) {
									var id = parseInt($(this).attr("data-id"));
									bridge.callHandler("javascriptJumpAction",{
					                    type : 16,
					                    title : "",
					                    param1 : id

					                },function(data, responseCallback) {})
								}
							});

							$(".otherThemes_link").on("click",function(){
								// 在进行中，而且在没有售空的状态下可跳转商品详情
								
								var status = $(this).attr("pros-status");
								if(status == 0) {
									var id = parseInt($(this).attr("data-id"));
									var typeStr = $(this).attr("pro-type");
									if(typeStr==1){
										typeStr = "进口零食";
									}
									if(typeStr==2){
										typeStr = "无肉不欢";
									}
									if(typeStr==3){
										typeStr = "甜蜜风暴";
									}
									if(typeStr==4){
										typeStr = "坚果狂欢";
									}
									if(typeStr==5){
										typeStr = "国民小食";
									}
									if(typeStr==6){
										typeStr = "冲饮";
									}
									bridge.callHandler("javascriptJumpAction",{
					                    type : 4,
					                    title : typeStr,
					                    param1 : id

					                },function(data, responseCallback) {})
								}
							});
							//一进入就埋点
//							bridge.callHandler("mainActivityPageStart",{},function(data,responseCallback){});
							$(".tb-meet").on("click",function(){
								bridge.callHandler("javascriptJumpAction",{
				                    type : 1,
				                    title : "淘宝零食会场",
				                    param1 : "http://s.click.taobao.com/lmvpkix"

				                },function(data, responseCallback) {})
							});
							//设置title
							bridge.callHandler("setAppTitle",{title : "12.12主会场"},function(data,responseCallback){});
							$(".shareBtn").on("click",function(e) { 
					        bridge.callHandler("setShareInfo", {
					            id: 0,
					            desc: shareIn.desc,
					            title: shareIn.title,
					            imgUrl: shareIn.imgUrl,
					            contentUrl: "http://" + host + "/api/Tpl/default/Activity/shareGuide1212.html",
					            type: 0
					        },function(data,responseCallback){
					                //log(data);
					            })
					        });

					        //口碑爆款埋点
							$('.ThemesBanner').find('a').on('click',function(){
								var kbIndex = $(this).index()+1;
								bridge.callHandler("clickActivityKoubei", {
					           		eventLabel:'口碑爆款_'+kbIndex+''
						        },function(data,responseCallback){
						                //log(data);
						            })

							})

							//淘宝分会场
							$('.tb-meet').on("click",function(){
									bridge.callHandler("clickActivityTaobao", {
										eventLabel:'淘宝分会场'
									},function(data,responseCallback){
							                //log(data);
						            })
							});

							//点击主会场分类埋点
							$('.ThemesItem').find('a').on('click',function(){
								var ThemesIndex = $(this).index()+1;
								bridge.callHandler("clickActivityClassify", {
					           		eventLabel:'主会场分类_'+ThemesIndex+''
						        },function(data,responseCallback){
						                //log(data);
					            })
							})
							// 主会场商品列表
							$('body').delegate('.proList li','click',function(){
								var porlistIndex;
								var d = $(this).parents('.proList').index();
								var proIndex =  $(this).index(); 
							switch (d){
							case 2:
									porlistIndex = $(this).index()+1;
									break;
						    case 3:
						    		a = $(this).parents('.proList').prevAll('.proList').find('li').length;
						    		porlistIndex = a + proIndex + 1;
						 
									break;
							case 4:
								    b = $(this).parents('.proList').prevAll('.proList').find('li').length;
						    		porlistIndex = b + proIndex + 1;
						    		
								    break;
							case 5:
								    c = $(this).parents('.proList').prevAll('.proList').find('li').length;
						    		porlistIndex = c + proIndex + 1;
						 
								    break;
					  		}
					  		bridge.callHandler("clickActivityGoodsList", {
						           		eventLabel:'商品列表_'+porlistIndex+''
							      },function(data,responseCallback){
							                //log(data);
						          })
							})
							
//							/*$(window).on('unload', function(){
//								  bridge.callHandler("mainActivityPageEnd", {},function(data,responseCallback){
//							                //log(data);
//						          })
//							});*/
					    });
					}


				};
				var e = function(d){//输出错误信息
					console.log(d);
				};

				var url = "/api.php?apptype=0&srv=2218&cid=10002&uid=0&tms=20150721190147&sig=8c35f5a024148111&wssig=308efe4382a088e0&os_type=3&version=13";

				var d = {
					url : url, 
					dataType : "json",
					type : "get",
					success : c,
					error : e
				};
				$.ajax(d);
			}

		}
		init.aFuc();

		$win.on("scroll",function(){
			var t = $win.scrollTop();
			t > 1000 ? $(".toTop").show().addClass("rotateIn") : $(".toTop").hide();
		})
		$(".toTop").on("click",function(){
			$('body,html').animate({ scrollTop: 0 }, 800),
			$(this).hide();
		});
		$(".bBanner").on("click",function(){
			$('body,html').animate({ scrollTop: 0 }, 800);
		});
	</script>
</html>