(function(){function getListener(e,t,n){var r;return t=t.toLowerCase(),(r=e.__allListeners||n&&(e.__allListeners={}))&&(r[t]||n&&(r[t]=[]))}function getDomNode(e,t,n,r,i,s){var o=r&&e[t],u;!o&&(o=e[n]);while(!o&&(u=(u||e).parentNode)){if(u.tagName=="BODY"||s&&!s(u))return null;o=u[n]}return o&&i&&!i(o)?getDomNode(o,t,n,!1,i):o}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu,window.UE=baidu.editor={},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE.version="1.2.3.0";var dom=UE.dom={},browser=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:!!window.ActiveXObject,opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera;var r=0;n.ie&&(r=parseFloat(e.match(/msie (\d+)/)[1]),n.ie9Compat=document.documentMode==9,n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=r==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=r<7||n.quirks);if(n.gecko){var i=e.match(/rv:([\d\.]+)/);i&&(i=i[1].split("."),r=i[0]*1e4+(i[1]||0)*100+(i[2]||0)*1)}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(r=parseFloat(t.version())),n.webkit&&(r=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=r,n.isCompatible=!n.mobile&&(n.ie&&r>=6||n.gecko&&r>=10801||n.opera&&r>=9.5||n.air&&r>=1||n.webkit&&r>=522||!1),n}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera,utils=UE.utils={makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var r in t)if(!n||!e.hasOwnProperty(r))e[r]=t[r];return e},isArray:function(e){return Object.prototype.toString.apply(e)==="[object Array]"},isString:function(e){return typeof e=="string"||e.constructor==String},inherits:function(e,t){var n=e.prototype,r=utils.makeInstance(t.prototype);return utils.extend(r,n,!0),e.prototype=r,r.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var r;return function(){n&&clearTimeout(r),r=setTimeout(e,t)}},indexOf:function(e,t,n){for(var r=n||0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},findNode:function(e,t,n){for(var r=0,i;i=e[r++];)if(n?n(i):this.indexOf(t,i.tagName.toLowerCase())!=-1)return i},removeItem:function(e,t){for(var n=0,r=e.length;n<r;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t=0,n,r={};n=e[t++];)r[n.toUpperCase()]=r[n]=1;return r},unhtml:function(e,t){return e?e.replace(t||/[&<">]/g,function(e){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">"}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":e.cssFloat!=undefined?"cssFloat":e.styleFloat!=undefined?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){var e={};return function(t,n,r){var i=e[n.src||n.href];if(i){utils.isArray(i.funs)&&(i.ready?r():e[n.src||n.href].funs.push(r));return}e[n.src||n.href]=r?{funs:[r]}:1;if(!t.body){t.write('<script src="'+n.src+'"></script>');return}if(n.id&&t.getElementById(n.id))return;var s=t.createElement(n.tag);delete n.tag;for(var o in n)s.setAttribute(o,n[o]);s.onload=s.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){i=e[n.src||n.href];if(i.funs){i.ready=1;for(var t;t=i.funs.pop();)t()}s.onload=s.onreadystatechange=null}},t.getElementsByTagName("head")[0].appendChild(s)}}(),isEmptyObject:function(e){for(var t in e)return!1;return!0},isFunction:function(e){return"[object Function]"==Object.prototype.toString.call(e)},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var r=0,i;i=n[r++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(e){function i(e,t){if(!e)return"";var n=e.top,r=e.bottom,i=e.left,s=e.right,o="";if(!n||!i||!r||!s)for(var u in e)o+=";"+t+"-"+u+":"+e[u]+";";else o+=";"+t+":"+(n==r&&r==i&&i==s?n:n==r&&i==s?n+" "+i:i==s?n+" "+i+" "+r:n+" "+s+" "+r+" "+i)+";";return o}var t,n,r;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,r,i,s){if(s.split(" ").length==1)switch(r){case"padding":return!t&&(t={}),t[i]=s,"";case"margin":return!n&&(n={}),n[i]=s,"";case"border":return s=="initial"?"":e}return e}),e+=i(t,"padding")+i(n,"margin"),e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},domReady:function(){function n(){e=!0;for(var n;n=t.pop();)n()}var e=!1,t=[];return function(r){if(document.readyState==="complete")return r&&setTimeout(r,1);r&&t.push(r),e&&n(),browser.ie?(function(){if(e)return;try{document.documentElement.doScroll("left")}catch(t){setTimeout(arguments.callee,0);return}n()}(),window.attachEvent("onload",n)):(document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),n()},!1),window.addEventListener("load",n,!1))}}()};utils.domReady();var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(e,t){e=utils.trim(e).split(" ");for(var n=0,r;r=e[n++];)getListener(this,r,!0).push(t)},removeListener:function(e,t){e=utils.trim(e).split(" ");for(var n=0,r;r=e[n++];)utils.removeItem(getListener(this,r)||[],t)},fireEvent:function(e){e=utils.trim(e).split(" ");for(var t=0,n;n=e[t++];){var r=getListener(this,n),i,s,o;if(r){o=r.length;while(o--)s=r[o].apply(this,arguments),s!==undefined&&(i=s)}if(s=this["on"+n.toLowerCase()])i=s.apply(this,arguments)}return i}};var dtd=dom.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}function t(e){var t=arguments;for(var n=1;n<t.length;n++){var r=t[n];for(var i in r)e.hasOwnProperty(i)||(e[i]=r[i])}return e}var n=e({isindex:1,fieldset:1}),r=e({input:1,button:1,select:1,textarea:1,label:1}),i=t(e({a:1}),r),s=t({iframe:1},i),o=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),u=e({ins:1,del:1,script:1,style:1}),a=t(e({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),u),f=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),a),l=t(e({p:1}),f),c=t(e({iframe:1}),f,r),h=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),p=t(e({a:0}),c),d=e({tr:1}),v=e({"#":1}),m=t(e({param:1}),h),g=t(e({form:1}),n,s,o,l),y=e({li:1}),b=e({style:1,script:1}),w=e({base:1,link:1,meta:1,title:1}),E=t(w,b),S=e({head:1,body:1}),x=e({html:1}),T=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),N=e({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return e({$nonBodyContent:t(x,S,w),$block:T,$inline:p,$body:t(e({script:1,style:1}),T),$cdata:e({script:1,style:1}),$empty:N,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:S,head:E,style:v,script:v,body:g,base:{},link:{},meta:{},title:v,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:g,td:g,br:{},th:g,center:g,kbd:p,button:t(l,o),basefont:{},h5:p,h4:p,samp:p,h6:p,ol:y,h1:p,h3:p,option:v,h2:p,form:t(n,s,o,l),select:e({optgroup:1,option:1}),font:p,ins:p,menu:y,abbr:p,label:p,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:p,tfoot:d,cite:p,li:g,input:{},iframe:g,strong:p,textarea:v,noframes:g,big:p,small:p,span:e({"#":1,br:1}),hr:p,dt:p,sub:p,optgroup:e({option:1}),param:{},bdo:p,"var":p,div:g,object:m,sup:p,dd:g,strike:p,area:{},dir:y,map:t(e({area:1,form:1,p:1}),n,u,o),applet:m,dl:e({dt:1,dd:1}),del:p,isindex:{},fieldset:t(e({legend:1}),h),thead:d,ul:y,acronym:p,b:p,a:t(e({a:1}),c),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),g),caption:p,i:p,u:p,tbody:d,s:p,address:t(s,l),tt:p,legend:p,q:p,pre:t(a,i),p:t(e({a:1}),p),em:p,dfn:p})}(),attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"﻿":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;var n,r=[e],i=[t];n=e;while(n=n.parentNode){if(n===t)return 10;r.push(n)}n=t;while(n=n.parentNode){if(n===e)return 20;i.push(n)}r.reverse(),i.reverse();if(r[0]!==i[0])return 1;var s=-1;while(s++,r[s]===i[s]);e=r[s],t=i[s];while(e=e.nextSibling)if(e===t)return 4;return 2},getNodeIndex:function(e,t){var n=e,r=0;while(n=n.previousSibling){if(t&&n.nodeType==3)continue;r++}return r},inDoc:function(e,t){while(e=e.parentNode)if(e===t)return!0;return!1},findParent:function(e,t,n){if(!domUtils.isBody(e)){e=n?e:e.parentNode;while(e){if(!t||t(e)||this.isBody(e))return t&&!t(e)&&this.isBody(e)?null:e;e=e.parentNode}}return null},findParentByTagName:function(e,t,n,r){if(e&&e.nodeType&&!this.isBody(e)&&(e.nodeType==1||e.nodeType)){t=utils.listToMap(utils.isArray(t)?t:[t]),e=e.nodeType==3||!n?e.parentNode:e;while(e&&e.tagName&&e.nodeType!=9){if(r&&r(e))break;if(t[e.tagName])return e;e=e.parentNode}}return null},findParents:function(e,t,n,r){var i=t&&(n&&n(e)||!n)?[e]:[];while(e=domUtils.findParent(e,n))i.push(e);return r?i:i.reverse()},insertAfter:function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},remove:function(e,t){var n=e.parentNode,r;if(n){if(t&&e.hasChildNodes())while(r=e.firstChild)n.insertBefore(r,e);n.removeChild(e)}return e},getNextDomNode:function(e,t,n,r){return getDomNode(e,"firstChild","nextSibling",t,n,r)},isBookmarkNode:function(e){return e.nodeType==1&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;var n=[e],r=[t],i=e,s=-1;while(i=i.parentNode){if(i===t)return i;n.push(i)}i=t;while(i=i.parentNode){if(i===e)return i;r.push(i)}n.reverse(),r.reverse();while(s++,n[s]===r[s]);return s==0?null:n[s-1]},clearEmptySibling:function(e,t,n){function r(e,t){var n;while(e&&!domUtils.isBookmarkNode(e)&&(domUtils.isEmptyInlineElement(e)||!(new RegExp("[^	\n\r"+domUtils.fillChar+"]")).test(e.nodeValue)))n=e[t],domUtils.remove(e),e=n}!t&&r(e.nextSibling,"nextSibling"),!n&&r(e.previousSibling,"previousSibling")},split:function(e,t){var n=e.ownerDocument;if(browser.ie&&t==e.nodeValue.length){var r=n.createTextNode("");return domUtils.insertAfter(e,r)}var i=e.splitText(t);if(browser.ie8){var s=n.createTextNode("");domUtils.insertAfter(i,s),domUtils.remove(s)}return i},isWhitespace:function(e){return!(new RegExp("[^ 	\n\r"+domUtils.fillChar+"]")).test(e.nodeValue)},getXY:function(e){var t=0,n=0;while(e.offsetParent)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},on:function(e,t,n){var r=utils.isArray(t)?t:[t],i=r.length;if(i)while(i--){t=r[i];if(e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={});var s=t+n.toString();n._d[s]||(n._d[s]=function(e){return n.call(e.srcElement,e||window.event)},e.attachEvent("on"+t,n._d[s]))}}e=null},un:function(e,t,n){var r=utils.isArray(t)?t:[t],i=r.length;if(i)while(i--){t=r[i];if(e.removeEventListener)e.removeEventListener(t,n,!1);else{var s=t+n.toString();e.detachEvent("on"+t,n._d?n._d[s]:n),n._d&&n._d[s]&&delete n._d[s]}}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return 0;var n=e.attributes,r=t.attributes;if(!ie&&n.length!=r.length)return 0;var i,s,o=0,u=0;for(var a=0;i=n[a++];){if(i.nodeName=="style"){i.specified&&o++;if(domUtils.isSameStyle(e,t))continue;return 0}if(ie){if(!i.specified)continue;o++,s=r.getNamedItem(i.nodeName)}else s=t.attributes[i.nodeName];if(!s.specified||i.nodeValue!=s.nodeValue)return 0}if(ie){for(a=0;s=r[a++];)s.specified&&u++;if(o!=u)return 0}return 1},isSameStyle:function(e,t){var n=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),r=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){n=e.style,r=t.style;if(n.length!=r.length)return 0;for(var i in n){if(/^(\d+|csstext)$/i.test(i))continue;if(n[i]!=r[i])return 0}return 1}if(!n||!r)return n==r?1:0;n=n.split(";"),r=r.split(";");if(n.length!=r.length)return 0;for(var s=0,o;o=n[s++];)if(utils.indexOf(r,o)==-1)return 0;return 1},isBlockElm:function(e){return e.nodeType==1&&(dtd.$block[e.tagName]||styleBlock[domUtils.getComputedStyle(e,"display")])&&!dtd.$nonChild[e.tagName]},isBody:function(e){return e&&e.nodeType==1&&e.tagName.toLowerCase()=="body"},breakParent:function(e,t){var n,r=e,i=e,s,o;do{r=r.parentNode,s?(n=r.cloneNode(!1),n.appendChild(s),s=n,n=r.cloneNode(!1),n.appendChild(o),o=n):(s=r.cloneNode(!1),o=s.cloneNode(!1));while(n=i.previousSibling)s.insertBefore(n,s.firstChild);while(n=i.nextSibling)o.appendChild(n);i=r}while(t!==r);return n=t.parentNode,n.insertBefore(s,t),n.insertBefore(o,t),n.insertBefore(e,o),domUtils.remove(t),e},isEmptyInlineElement:function(e){if(e.nodeType!=1||!dtd.$removeEmpty[e.tagName])return 0;e=e.firstChild;while(e){if(domUtils.isBookmarkNode(e))return 0;if(e.nodeType==1&&!domUtils.isEmptyInlineElement(e)||e.nodeType==3&&!domUtils.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){var n;while((n=e[t])&&n.nodeType==3&&domUtils.isWhitespace(n))e.removeChild(n)}t("firstChild"),t("lastChild")},mergChild:function(e,t,n){var r=domUtils.getElementsByTagName(e,e.tagName.toLowerCase());for(var i=0,s;s=r[i++];){if(!s.parentNode||domUtils.isBookmarkNode(s))continue;if(s.tagName.toLowerCase()=="span"){if(e===s.parentNode){domUtils.trimWhiteTextNode(e);if(e.childNodes.length==1){e.style.cssText=s.style.cssText+";"+e.style.cssText,domUtils.remove(s,!0);continue}}s.style.cssText=e.style.cssText+";"+s.style.cssText;if(n){var o=n.style;if(o){o=o.split(";");for(var u=0,a;a=o[u++];)s.style[utils.cssStyleToDomStyle(a.split(":")[0])]=a.split(":")[1]}}domUtils.isSameStyle(s,e)&&domUtils.remove(s,!0);continue}domUtils.isSameElement(e,s)&&domUtils.remove(s,!0)}if(t=="span"){var f=domUtils.getElementsByTagName(e,"a");for(var i=0,l;l=f[i++];)l.style.cssText=";"+e.style.cssText,l.style.textDecoration="underline"}},getElementsByTagName:function(e,t){var n=e.getElementsByTagName(t),r=[];for(var i=0,s;s=n[i++];)r.push(s);return r},mergToParent:function(e){var t=e.parentNode;while(t&&dtd.$removeEmpty[t.tagName]){if(t.tagName==e.tagName||t.tagName=="A"){domUtils.trimWhiteTextNode(t);if(t.tagName=="SPAN"&&!domUtils.isSameStyle(t,e)||t.tagName=="A"&&e.tagName=="SPAN"){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText,t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText,t.tagName=="A"&&(t.style.textDecoration="underline")}if(t.tagName!="A"){t===e.parentNode&&domUtils.remove(e,!0);break}}t=t.parentNode}},mergSibling:function(e,t,n){function r(e,t,n){var r;if((r=n[e])&&!domUtils.isBookmarkNode(r)&&r.nodeType==1&&domUtils.isSameElement(n,r)){while(r.firstChild)t=="firstChild"?n.insertBefore(r.lastChild,n.firstChild):n.appendChild(r.firstChild);domUtils.remove(r)}}!t&&r("previousSibling","firstChild",e),!n&&r("nextSibling","lastChild",e)},unselectable:ie||browser.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t=0,n;n=e.all[t++];)switch(n.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:n.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){for(var n=0,r;r=t[n++];){r=attrFix[r]||r;switch(r){case"className":e[r]="";break;case"style":e.style.cssText="",!browser.ie&&e.removeAttributeNode(e.getAttributeNode("style"))}e.removeAttribute(r)}},creElm:function(e,t,n){return this.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t){var r=t[n];switch(n){case"class":e.className=r;break;case"style":e.style.cssText=e.style.cssText+";"+r;break;case"innerHTML":e[n]=r;break;case"value":e.value=r;break;default:e.setAttribute(attrFix[n]||n,r)}}return e},getComputedStyle:function(e,t){function n(e,t){return e=="font-size"&&/pt$/.test(t)&&(t=Math.round(parseFloat(t)/.75)+"px"),t}e.nodeType==3&&(e=e.parentNode);if(browser.ie&&browser.version<9&&t=="font-size"&&!e.style.fontSize&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]){var r=e.ownerDocument.createElement("span");r.style.cssText="padding:0;border:0;font-family:simsun;",r.innerHTML=".",e.appendChild(r);var i=r.offsetHeight;return e.removeChild(r),r=null,i+"px"}try{var s=domUtils.getStyle(e,t)||(window.getComputedStyle?domUtils.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[utils.cssStyleToDomStyle(t)])}catch(o){return null}return n(t,utils.fixColor(t,s))},removeClasses:function(e,t){t=utils.isArray(t)?t:[t],e.className=(" "+e.className+" ").replace(new RegExp("(?:\\s+(?:"+t.join("|")+"))+\\s+","g")," ")},addClass:function(e,t){this.hasClass(e,t)||(e.className+=" "+t)},removeStyle:function(e,t){e.style[utils.cssStyleToDomStyle(t)]="",e.style.cssText||domUtils.removeAttributes(e,["style"])},hasClass:function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},getStyle:function(e,t){var n=e.style[utils.cssStyleToDomStyle(t)];return utils.fixColor(t,n)},setStyle:function(e,t,n){e.style[utils.cssStyleToDomStyle(t)]=n},setStyles:function(e,t){for(var n in t)t.hasOwnProperty(n)&&domUtils.setStyle(e,n,t[n])},removeDirtyAttr:function(e){for(var t=0,n,r=e.getElementsByTagName("*");n=r[t++];)n.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,r=e.firstChild;t=t||function(){return 1};while(r)t(r)&&n++,r=r.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||domUtils.getChildCount(e,function(e){return!domUtils.isBr(e)&&!domUtils.isBookmarkNode(e)&&!domUtils.isWhitespace(e)})==0},clearSelectedArr:function(e){var t;while(t=e.pop())domUtils.removeAttributes(t,["class"])},scrollToView:function(e,t,n){var r=function(){var e=t.document,n=e.compatMode=="CSS1Compat";return{width:(n?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(n?e.documentElement.clientHeight:e.body.clientHeight)||0}},i=function(e){if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},s=r().height,o=s*-1+n;o+=e.offsetHeight||0;var u=domUtils.getXY(e);o+=u.y;var a=i(t).y;(o>a||o<a-s)&&t.scrollTo(0,o+(o<0?-20:20))},isBr:function(e){return e.nodeType==1&&e.tagName=="BR"},isFillChar:function(e){return e.nodeType==3&&!e.nodeValue.replace(new RegExp(domUtils.fillChar),"").length},isStartInblock:function(e){var t=e.cloneRange(),n=0,r=t.startContainer,i;while(r&&domUtils.isFillChar(r))i=r,r=r.previousSibling;i&&(t.setStartBefore(i),r=t.startContainer),r.nodeType==1&&domUtils.isEmptyNode(r)&&t.startOffset==1&&t.setStart(r,0).collapse(!0);while(!t.startOffset){r=t.startContainer;if(domUtils.isBlockElm(r)||domUtils.isBody(r)){n=1;break}var s=t.startContainer.previousSibling,o;if(!s)t.setStartBefore(t.startContainer);else{while(s&&domUtils.isFillChar(s))o=s,s=s.previousSibling;o?t.setStartBefore(o):t.setStartBefore(t.startContainer)}}return n&&!domUtils.isBody(t.startContainer)?1:0},isEmptyBlock:function(e){var t=new RegExp("[ 	\r\n"+domUtils.fillChar+"]","g");if(e[browser.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var n in dtd.$isNotEmpty)if(e.getElementsByTagName(n).length)return 0;return 1},setViewportOffset:function(e,t){var n=parseInt(e.style.left)|0,r=parseInt(e.style.top)|0,i=e.getBoundingClientRect(),s=t.left-i.left,o=t.top-i.top;s&&(e.style.left=n+s+"px"),o&&(e.style.top=r+o+"px")},fillNode:function(e,t){var n=browser.ie?e.createTextNode(domUtils.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(n)},moveChild:function(e,t,n){while(e.firstChild)n&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return browser.ie?/^<\w+\s*?>/.test(e.outerHTML):e.attributes.length==0},isCustomeNode:function(e){return e.nodeType==1&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return e.nodeType==1&&e.tagName.toLowerCase()==t}},fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){function r(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function i(e,t,n,i){return t.nodeType==1&&(dtd.$empty[t.tagName]||dtd.$nonChild[t.tagName])&&(n=domUtils.getNodeIndex(t)+(e?0:1),t=t.parentNode),e?(i.startContainer=t,i.startOffset=n,i.endContainer||i.collapse(!0)):(i.endContainer=t,i.endOffset=n,i.startContainer||i.collapse(!1)),r(i),i}function s(e,t){var n=e.startContainer,r=e.endContainer,i=e.startOffset,s=e.endOffset,o=e.document,u=o.createDocumentFragment(),a,f;n.nodeType==1&&(n=n.childNodes[i]||(a=n.appendChild(o.createTextNode("")))),r.nodeType==1&&(r=r.childNodes[s]||(f=r.appendChild(o.createTextNode(""))));if(n===r&&n.nodeType==3)return u.appendChild(o.createTextNode(n.substringData(i,s-i))),t&&(n.deleteData(i,s-i),e.collapse(!0)),u;var l,c,h=u,p=domUtils.findParents(n,!0),d=domUtils.findParents(r,!0);for(var v=0;p[v]==d[v];)v++;for(var m=v,g;g=p[m];m++){l=g.nextSibling,g==n?a||(e.startContainer.nodeType==3?(h.appendChild(o.createTextNode(n.nodeValue.slice(i))),t&&n.deleteData(i,n.nodeValue.length-i)):h.appendChild(t?n:n.cloneNode(!0))):(c=g.cloneNode(!1),h.appendChild(c));while(l){if(l===r||l===d[m])break;g=l.nextSibling,h.appendChild(t?l:l.cloneNode(!0)),l=g}h=c}h=u,p[v]||(h.appendChild(p[v-1].cloneNode(!1)),h=h.firstChild);for(var m=v,y;y=d[m];m++){l=y.previousSibling,y==r?!f&&e.endContainer.nodeType==3&&(h.appendChild(o.createTextNode(r.substringData(0,s))),t&&r.deleteData(0,s)):(c=y.cloneNode(!1),h.appendChild(c));if(m!=v||!p[v])while(l){if(l===n)break;y=l.previousSibling,h.insertBefore(t?l:l.cloneNode(!0),h.firstChild),l=y}h=c}return t&&e.setStartBefore(d[v]?p[v]?d[v]:p[v-1]:d[v-1]).collapse(!0),a&&domUtils.remove(a),f&&domUtils.remove(f),u}function u(e,t){try{if(n&&domUtils.inDoc(n,e))if(!n.nodeValue.replace(fillCharReg,"").length){var r=n.parentNode;domUtils.remove(n);while(r&&domUtils.isEmptyInlineElement(r)&&!r.contains(t))n=r.parentNode,domUtils.remove(r),r=n}else n.nodeValue=n.nodeValue.replace(fillCharReg,"")}catch(i){}}function a(e,t){var n;e=e[t];while(e&&domUtils.isFillChar(e))n=e[t],domUtils.remove(e),e=n}var e=0,t=domUtils.fillChar,n,o=dom.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=e,t.collapsed=!0};o.prototype={cloneContents:function(){return this.collapsed?null:s(this,0)},deleteContents:function(){var e;return this.collapsed||s(this,1),browser.webkit&&(e=this.startContainer,e.nodeType==3&&!e.nodeValue.length&&(this.setStartBefore(e).collapse(!0),domUtils.remove(e))),this},extractContents:function(){return this.collapsed?null:s(this,2)},setStart:function(e,t){return i(!0,e,t,this)},setEnd:function(e,t){return i(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEnd(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},cloneRange:function(){var e=this,t=new o(e.document);return t.setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){var t=this,n,r=t.collapsed;while(t.startContainer.nodeType==1&&(n=t.startContainer.childNodes[t.startOffset])&&n.nodeType==1&&!domUtils.isBookmarkNode(n)&&!dtd.$empty[n.tagName]&&!dtd.$nonChild[n.tagName])t.setStart(n,0);if(r)return t.collapse(!0);if(!e)while(t.endContainer.nodeType==1&&t.endOffset>0&&(n=t.endContainer.childNodes[t.endOffset-1])&&n.nodeType==1&&!domUtils.isBookmarkNode(n)&&!dtd.$empty[n.tagName]&&!dtd.$nonChild[n.tagName])t.setEnd(n,n.childNodes.length);return t},getCommonAncestor:function(e,t){var n=this.startContainer,r=this.endContainer;return n===r?e&&n.nodeType==1&&this.startOffset==this.endOffset-1?n.childNodes[this.startOffset]:t&&n.nodeType==3?n.parentNode:n:domUtils.getCommonAncestor(n,r)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,r=this.collapsed,i=this.endContainer;if(t.nodeType==3){if(n==0)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var s=domUtils.split(t,n);t===i?this.setEnd(s,this.endOffset-n):t.parentNode===i&&(this.endOffset+=1),this.setStartBefore(s)}if(r)return this.collapse(!0)}return e||(n=this.endOffset,i=this.endContainer,i.nodeType==3&&(n==0?this.setEndBefore(i):n>=i.nodeValue.length?this.setEndAfter(i):(domUtils.split(i,n),this.setEndAfter(i)))),this},txtToElmBoundary:function(){function e(e,t){var n=e[t+"Container"],r=e[t+"Offset"];n.nodeType==3&&(r?r>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return this.collapsed||(e(this,"start"),e(this,"end")),this},insertNode:function(e){var t=e,n=1;e.nodeType==11&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var r=this.startContainer,i=this.startOffset,s=r.childNodes[i];return s?r.insertBefore(e,s):r.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(t,n){var r,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("﻿")),i.id="_baidu_bookmark_start_"+(n?"":e++),this.collapsed||(r=i.cloneNode(!0),r.id="_baidu_bookmark_end_"+(n?"":e++)),this.insertNode(i),r&&(this.collapse(!1).insertNode(r),this.setEndBefore(r)),this.setStartAfter(i),{start:t?i.id:i,end:r?t?r.id:r:null,id:t}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),domUtils.remove(t),n?(this.setEndBefore(n),domUtils.remove(n)):this.collapse(!0),this},enlarge:function(e,t){var n=domUtils.isBody,r,i,s=this.document.createTextNode("");if(e){i=this.startContainer,i.nodeType==1?i.childNodes[this.startOffset]?r=i=i.childNodes[this.startOffset]:(i.appendChild(s),r=i=s):r=i;for(;;){if(domUtils.isBlockElm(i)){i=r;while((r=i.previousSibling)&&!domUtils.isBlockElm(r))i=r;this.setStartBefore(i);break}r=i,i=i.parentNode}i=this.endContainer,i.nodeType==1?((r=i.childNodes[this.endOffset])?i.insertBefore(s,r):i.appendChild(s),r=i=s):r=i;for(;;){if(domUtils.isBlockElm(i)){i=r;while((r=i.nextSibling)&&!domUtils.isBlockElm(r))i=r;this.setEndAfter(i);break}r=i,i=i.parentNode}s.parentNode===this.endContainer&&this.endOffset--,domUtils.remove(s)}if(!this.collapsed){while(this.startOffset==0){if(t&&t(this.startContainer))break;if(n(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(t&&t(this.endContainer))break;if(n(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!domUtils.isBody(this.endContainer)&&!this.endOffset)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return e.nodeType==1&&domUtils.isBlockElm(e)}).adjustmentBoundary();var r=this.createBookmark(),i=r.end,s=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br":!domUtils.isWhitespace(e)},o=domUtils.getNextDomNode(r.start,!1,s),u,a,f=this.cloneRange();while(o&&domUtils.getPosition(o,i)&domUtils.POSITION_PRECEDING)if(o.nodeType==3||dtd[e][o.tagName]){f.setStartBefore(o),u=o;while(u&&(u.nodeType==3||dtd[e][u.tagName])&&u!==i)a=u,u=domUtils.getNextDomNode(u,u.nodeType==1,null,function(t){return dtd[e][t.tagName]});var l=f.setEndAfter(a).extractContents(),c;if(n&&n.length>0){var h,p;p=h=n[0].cloneNode(!1);for(var d=1,v;v=n[d++];)h.appendChild(v.cloneNode(!1)),h=h.firstChild;c=h}else c=f.document.createElement(e);t&&domUtils.setAttributes(c,t),c.appendChild(l),f.insertNode(n?p:c);var m;e=="span"&&t.style&&/text\-decoration/.test(t.style)&&(m=domUtils.findParentByTagName(c,"a",!0))?(domUtils.setAttributes(m,t),domUtils.remove(c,!0),c=m):(domUtils.mergSibling(c),domUtils.clearEmptySibling(c)),domUtils.mergChild(c,e,t),o=domUtils.getNextDomNode(c,!1,s),domUtils.mergToParent(c);if(u===i)break}else o=domUtils.getNextDomNode(o,!0,s);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=utils.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();var t=this.startContainer,n=this.endContainer;for(;;){if(t.nodeType==1){if(utils.indexOf(e,t.tagName.toLowerCase())>-1)break;if(t.tagName.toLowerCase()=="body"){t=null;break}}t=t.parentNode}for(;;){if(n.nodeType==1){if(utils.indexOf(e,n.tagName.toLowerCase())>-1)break;if(n.tagName.toLowerCase()=="body"){n=null;break}}n=n.parentNode}var r=this.createBookmark(),i,s;t&&(s=this.cloneRange().setEndBefore(r.start).setStartBefore(t),i=s.extractContents(),s.insertNode(i),domUtils.clearEmptySibling(t,!0),t.parentNode.insertBefore(r.start,t)),n&&(s=this.cloneRange().setStartAfter(r.end).setEndAfter(n),i=s.extractContents(),s.insertNode(i),domUtils
.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(r.end,n.nextSibling));var o=domUtils.getNextDomNode(r.start,!1,function(e){return e.nodeType==1}),u;while(o&&o!==r.end)u=domUtils.getNextDomNode(o,!0,function(e){return e.nodeType==1}),utils.indexOf(e,o.tagName.toLowerCase())>-1&&domUtils.remove(o,!0),o=u;return this.moveToBookmark(r)},getClosedNode:function(){var e;if(!this.collapsed){var t=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(t.startContainer.nodeType==1&&t.startContainer===t.endContainer&&t.endOffset-t.startOffset==1){var n=t.startContainer.childNodes[t.startOffset];n&&n.nodeType==1&&(dtd.$empty[n.tagName]||dtd.$nonChild[n.tagName])&&(e=n)}}return e},select:browser.ie?function(e,r){var i;this.collapsed||this.shrinkBoundary();var s=this.getClosedNode();if(s&&!r){try{i=this.document.body.createControlRange(),i.addElement(s),i.select()}catch(o){}return this}var f=this.createBookmark(),l=f.start,c;i=this.document.body.createTextRange(),i.moveToElementText(l),i.moveStart("character",1);if(!this.collapsed){var h=this.document.body.createTextRange();c=f.end,h.moveToElementText(c),i.setEndPoint("EndToEnd",h)}else if(!e&&this.startContainer.nodeType!=3){var p=this.document.createTextNode(t),d=this.document.createElement("span");d.appendChild(this.document.createTextNode(t)),l.parentNode.insertBefore(d,l),l.parentNode.insertBefore(p,l),u(this.document,p),n=p,a(d,"previousSibling"),a(l,"nextSibling"),i.moveStart("character",-1),i.collapse(!0)}this.moveToBookmark(f),d&&domUtils.remove(d);try{i.select()}catch(o){}return this}:function(e){var r=domUtils.getWindow(this.document),i=r.getSelection(),s;browser.gecko?this.document.body.focus():r.focus();if(i){i.removeAllRanges();if(this.collapsed){if(e&&browser.opera&&!domUtils.isBody(this.startContainer)&&this.startContainer.nodeType==1){var o=this.document.createTextNode("");this.insertNode(o).setStart(o,0).collapse(!0)}e||(s=this.document.createTextNode(t),this.insertNode(s),u(this.document,s),a(s,"previousSibling"),a(s,"nextSibling"),n=s,this.setStart(s,browser.webkit?1:0).collapse(!0))}var f=this.document.createRange();f.setStart(this.startContainer,this.startOffset),f.setEnd(this.endContainer,this.endOffset),i.addRange(f)}return this},scrollToView:function(e,t){e=e?window:domUtils.getWindow(this.document);var n=this.document.createElement("span");n.innerHTML="&nbsp;";var r=this.cloneRange();return r.insertNode(n),domUtils.scrollToView(n,e,t),domUtils.remove(n),this}}})(),function(){function e(e,t){var n=domUtils.getNodeIndex;e=e.duplicate(),e.collapse(t);var r=e.parentElement();if(!r.hasChildNodes())return{container:r,offset:0};var i=r.children,s,o=e.duplicate(),u=0,a=i.length-1,f=-1,l;while(u<=a){f=Math.floor((u+a)/2),s=i[f],o.moveToElementText(s);var c=o.compareEndPoints("StartToStart",e);if(c>0)a=f-1;else{if(!(c<0))return{container:r,offset:n(s)};u=f+1}}if(f==-1){o.moveToElementText(r),o.setEndPoint("StartToStart",e),l=o.text.replace(/(\r\n|\r)/g,"\n").length,i=r.childNodes;if(!l)return s=i[i.length-1],{container:s,offset:s.nodeValue.length};var h=i.length;while(l>0)l-=i[--h].nodeValue.length;return{container:i[h],offset:-l}}o.collapse(c>0),o.setEndPoint(c>0?"StartToStart":"EndToStart",e),l=o.text.replace(/(\r\n|\r)/g,"\n").length;if(!l)return dtd.$empty[s.tagName]||dtd.$nonChild[s.tagName]?{container:r,offset:n(s)+(c>0?0:1)}:{container:s,offset:c>0?0:s.childNodes.length};while(l>0)try{var p=s;s=s[c>0?"previousSibling":"nextSibling"],l-=s.nodeValue.length}catch(d){return{container:r,offset:n(p)}}return{container:s,offset:c>0?-l:s.nodeValue.length+l}}function t(t,n){if(t.item)n.selectNode(t.item(0));else{var r=e(t,!0);n.setStart(r.container,r.offset),t.compareEndPoints("StartToEnd",t)!=0&&(r=e(t,!1),n.setEnd(r.container,r.offset))}return n}function n(e){var t;try{t=e.getNative().createRange()}catch(n){return null}var r=t.item?t.item(0):t.parentElement();return(r.ownerDocument||r)===e.document?t:null}var r=dom.Selection=function(e){var t=this,r;t.document=e,ie&&(r=domUtils.getWindow(e).frameElement,domUtils.on(r,"beforedeactivate",function(){t._bakIERange=t.getIERange()}),domUtils.on(r,"activate",function(){try{!n(t)&&t._bakIERange&&t._bakIERange.select()}catch(e){}t._bakIERange=null})),r=e=null};r.prototype={getNative:function(){var e=this.document;try{return e?ie?e.selection:domUtils.getWindow(e).getSelection():null}catch(t){return null}},getIERange:function(){var e=n(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?domUtils.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return browser.ie&&n(this)||!browser.ie&&this.getNative().rangeCount?!0:!1}catch(e){return!1}},getRange:function(){function n(t){var n=e.document.body.firstChild,r=t.collapsed;while(n&&n.firstChild)t.setStart(n,0),n=n.firstChild;t.startContainer||t.setStart(e.document.body,0),r&&t.collapse(!0)}var e=this;if(e._cachedRange!=null)return this._cachedRange;var r=new baidu.editor.dom.Range(e.document);if(ie){var i=e.getIERange();i?t(i,r):n(r)}else{var s=e.getNative();if(s&&s.rangeCount){var o=s.getRangeAt(0),u=s.getRangeAt(s.rangeCount-1);r.setStart(o.startContainer,o.startOffset).setEnd(u.endContainer,u.endOffset),r.collapsed&&domUtils.isBody(r.startContainer)&&!r.startOffset&&n(r)}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;n(r)}}return this._bakRange=r},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e=ie?this.getIERange():this.getRange(),t,n,r,i;if(ie){if(!e)return this.document.body.firstChild;if(e.item)return e.item(0);t=e.duplicate(),t.text.length>0&&t.moveStart("character",1),t.collapse(1),n=t.parentElement(),i=r=e.parentElement();while(r=r.parentNode)if(r==n){n=i;break}}else{e.shrinkBoundary(),n=e.startContainer,n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,e.startOffset)]);if(n.nodeType==3)return n.parentNode}return n},getText:function(){var e,t;return this.isFocus()&&(e=this.getNative())?(t=browser.ie?e.createRange():e.getRangeAt(0),browser.ie?t.text:t.toString()):""}}}(),function(){function n(e){var t=e.getElementsByTagName("img"),n;for(var r=0,i;i=t[r++];)if(n=i.getAttribute("orgSrc"))i.src=n,i.removeAttribute("orgSrc");var s=e.getElementsByTagName("a");for(var r=0,o;o=s[r++];r++)o.getAttribute("data_ue_src")&&o.setAttribute("href",o.getAttribute("data_ue_src"))}function r(e,t){var n;if(t.textarea)if(utils.isString(t.textarea)){for(var r=0,i,s=domUtils.getElementsByTagName(e,"textarea");i=s[r++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||e.appendChild(n=domUtils.creElm(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),n.value=t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0)}var e=0,t,i=UE.Editor=function(t){var n=this;n.uid=e++,EventBase.call(n),n.commands={},n.options=utils.extend(t||{},UEDITOR_CONFIG,!0),n.setOpt({isShow:!0,initialContent:"欢迎使用ueditor!",autoClearinitialContent:!1,iframeCssUrl:n.options.UEDITOR_HOME_URL+"/themes/default/iframe.css",textarea:"editorValue",focus:!1,minFrameHeight:320,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",pageBreakTag:"_baidu_page_break_tag_",customDomain:!1,lang:"zh-cn",langPath:n.options.UEDITOR_HOME_URL+"lang/",allHtmlEnabled:!1}),utils.loadFile(document,{src:n.options.langPath+n.options.lang+"/"+n.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){for(var e in UE.plugins)UE.plugins[e].call(n);n.langIsReady=!0,n.fireEvent("langReady")}),UE.instants["ueditorInstant"+n.uid]=n};i.prototype={ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};utils.isString(e)?n[e]=t:n=e,utils.extend(this.options,n,!0)},destroy:function(){var e=this;e.fireEvent("destroy"),e.container.innerHTML="",domUtils.remove(e.container);for(var t in e)e.hasOwnProperty(t)&&delete this[t]},render:function(e){var t=this,n=t.options;e.constructor===String&&(e=document.getElementById(e));if(e){var r=ie&&browser.version<9,i=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(r?"":" class='view'")+"><head>"+(n.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(n.iframeCssUrl)+"'/>":"")+"<style type='text/css'>"+".selectTdClass{background-color:#3399FF !important;}"+"table.noBorderTable td{border:1px dashed #ddd !important}"+"table{clear:both;margin-bottom:10px;border-collapse:collapse;word-break:break-all;}"+".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}"+".anchorclass{background: url('"+t.options.UEDITOR_HOME_URL+"themes/default/images/anchor.gif') no-repeat scroll left center transparent;border: 1px dotted #0000FF;cursor: auto;display: inline-block;height: 16px;width: 15px;}"+".view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\n"+"body{margin:8px;font-family:'宋体';font-size:16px;}"+"li{clear:both}"+"p{margin:5px 0;}"+(n.initialStyle||"")+"</style></head><body"+(r?" class='view'":"")+"></body>";if(n.customDomain&&document.domain!=location.hostname)i+="<script>window.parent.UE.instants['ueditorInstant"+t.uid+"']._setup(document);</script></html>",e.appendChild(domUtils.creElm(document,"iframe",{id:"baidu_editor_"+t.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";'+'document.write("'+i+'");document.close();}())'}));else{e.innerHTML='<iframe id="baidu_editor_'+this.uid+'"'+'width="100%" height="100%" scroll="no" frameborder="0" ></iframe>';var s=e.firstChild.contentWindow.document;!browser.webkit&&s.open(),s.write(i+"</html>"),!browser.webkit&&s.close(),t._setup(s)}e.style.overflow="hidden"}},_setup:function(e){var t=this,n=t.options;ie?(e.body.disabled=!0,e.body.contentEditable=!0,e.body.disabled=!1):(e.body.contentEditable=!0,e.body.spellcheck=!1),t.document=e,t.window=e.defaultView||e.parentWindow,t.iframe=t.window.frameElement,t.body=e.body,t.setHeight(n.minFrameHeight),t.selection=new dom.Selection(e);var i;browser.gecko&&(i=this.selection.getNative())&&i.removeAllRanges(),this._initEvents();if(n.initialContent)if(n.autoClearinitialContent){var s=t.execCommand;t.execCommand=function(){t.fireEvent("firstBeforeExecCommand"),s.apply(t,arguments)},this.setDefaultContent(n.initialContent)}else this.setContent(n.initialContent,!0);for(var o=this.iframe.parentNode;!domUtils.isBody(o);o=o.parentNode)if(o.tagName=="FORM"){domUtils.on(o,"submit",function(){r(this,t)});break}domUtils.isEmptyNode(t.body)&&(t.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"),n.focus&&setTimeout(function(){t.focus(),!t.options.autoClearinitialContent&&t._selectionChange()}),t.container||(t.container=this.iframe.parentNode),n.fullscreen&&t.ui&&t.ui.setFullScreen(!0),t.isReady=1,t.fireEvent("ready"),browser.ie||domUtils.on(t.window,["blur","focus"],function(e){if(e.type=="blur"){t._bakRange=t.selection.getRange();try{t.selection.getNative().removeAllRanges()}catch(e){}}else try{t._bakRange&&t._bakRange.select()}catch(e){}}),browser.gecko&&browser.version<=10902&&(t.body.contentEditable=!1,setTimeout(function(){t.body.contentEditable=!0},100),setInterval(function(){t.body.style.height=t.iframe.offsetHeight-20+"px"},100)),!n.isShow&&t.setHide(),n.readonly&&t.setDisabled()},sync:function(e){var t=this,n=e?document.getElementById(e):domUtils.findParent(t.iframe.parentNode,function(e){return e.tagName=="FORM"},!0);n&&r(n,t)},setHeight:function(e){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px"),this.document.body.style.height=e-20+"px"},getContent:function(e,t,n){var r=this;e&&utils.isFunction(e)&&(t=e,e="");if(t?!t():!this.hasContents())return"";r.fireEvent("beforegetcontent",e);var i=new RegExp(domUtils.fillChar,"g"),s=r.body.innerHTML.replace(i,"").replace(/>[\t\r\n]*?</g,"><");r.fireEvent("aftergetcontent",e);if(r.serialize){var o=r.serialize.parseHTML(s);o=r.serialize.transformOutput(o),s=r.serialize.toHTML(o)}return ie&&n?s=s.replace(/<p>\s*?<\/p>/g,"<p>&nbsp;</p>"):s=s.replace(/(&nbsp;)+/g,function(e){for(var t=0,n=[],r=e.split(";").length-1;t<r;t++)n.push(t%2==0?" ":"&nbsp;");return n.join("")}),s},getAllHtml:function(){var e=this,t={html:""},n="";return e.fireEvent("getAllHtml",t),"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+e.document.getElementsByTagName("head")[0].innerHTML+t.html+"</head>"+"<body "+(ie&&browser.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(domUtils.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return dtd.$block[n]?"\n":t?t:""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(e,t){var r=this,i=utils.extend({a:1,A:1},dtd.$inline,!0),s;e=e.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>[\t\r\n]*?</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(e,t,n){return t?s=n:t=s,!i[t]&&!i[n]?e.replace(/>[ \t\r\n]*?</,"><"):e}),r.fireEvent("beforesetcontent");var o=this.serialize;if(o){var u=o.parseHTML(e);u=o.transformInput(u),u=o.filter(u),e=o.toHTML(u)}this.body.innerHTML=e.replace(new RegExp("[\r"+domUtils.fillChar+"]*","g"),""),browser.ie&&browser.version<7&&n(this.document.body);if(r.options.enterTag=="p"){var a=this.body.firstChild,f;if(!a||a.nodeType==1&&(dtd.$cdata[a.tagName]||domUtils.isCustomeNode(a))&&a===this.body.lastChild)this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{var l=r.document.createElement("p");while(a){while(a&&(a.nodeType==3||a.nodeType==1&&dtd.p[a.tagName]&&!dtd.$cdata[a.tagName]))f=a.nextSibling,l.appendChild(a),a=f;if(l.firstChild){if(!a){r.body.appendChild(l);break}r.body.insertBefore(l,a),l=r.document.createElement("p")}a=a.nextSibling}}}r.adjustTable&&r.adjustTable(r.body),r.fireEvent("aftersetcontent"),r.fireEvent("contentchange"),!t&&r._selectionChange(),r._bakRange=r._bakIERange=null;var c;browser.gecko&&(c=this.selection.getNative())&&c.removeAllRanges()},focus:function(e){try{var t=this,n=t.selection.getRange();e?n.setStartAtLast(t.body.lastChild).setCursor(!1,!0):n.select(!0)}catch(r){}},_initEvents:function(){var e=this,t=e.document,n=e.window;e._proxyDomEvent=utils.bind(e._proxyDomEvent,e),domUtils.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent),domUtils.on(n,["focus","blur"],e._proxyDomEvent),domUtils.on(t,["mouseup","keydown"],function(t){if(t.type=="keydown"&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey))return;if(t.button==2)return;e._selectionChange(250,t)});var r=0,i=browser.ie?e.body:e.document,s;domUtils.on(i,"dragstart",function(){r=1}),domUtils.on(i,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(s),s=setTimeout(function(){if(!r){var t=e.selection,n=t.getRange();if(n){var i=n.getCommonAncestor();if(i&&e.serialize){var s=e.serialize,o=s.filter(s.transformInput(s.parseHTML(s.word(i.innerHTML))));i.innerHTML=s.toHTML(o)}}}r=0},200)}:function(e){r||(e.preventDefault?e.preventDefault():e.returnValue=!1),r=0}}())},_proxyDomEvent:function(e){return this.fireEvent(e.type.replace(/^on/,""),e)},_selectionChange:function(e,n){var r=this,i=!1,s,o;if(browser.ie&&browser.version<9&&n&&n.type=="mouseup"){var u=this.selection.getRange();u.collapsed||(i=!0,s=n.clientX,o=n.clientY)}clearTimeout(t),t=setTimeout(function(){if(!r.selection.getNative())return;var e;if(i&&r.selection.getNative().type=="None"){e=r.document.body.createTextRange();try{e.moveToPoint(s,o)}catch(t){e=null}}var u;e&&(u=r.selection.getIERange,r.selection.getIERange=function(){return e}),r.selection.cache(),u&&(r.selection.getIERange=u),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!n),r.fireEvent("afterselectionchange"),r.selection.clear())},e||50)},_callCmdFn:function(e,t){var n=t[0].toLowerCase(),r,i;r=this.commands[n]||UE.commands[n],i=r&&r[e];if((!r||!i)&&e=="queryCommandState")return 0;if(i)return i.apply(this,t)},execCommand:function(e){e=e.toLowerCase();var t=this,n,r=t.commands[e]||UE.commands[e];if(!r||!r.execCommand)return;return!r.notNeedUndo&&!t.__hasEnterExecCommand?(t.__hasEnterExecCommand=!0,t.queryCommandState(e)!=-1&&(t.fireEvent("beforeexeccommand",e),n=this._callCmdFn("execCommand",arguments),t.fireEvent("afterexeccommand",e)),t.__hasEnterExecCommand=!1):n=this._callCmdFn("execCommand",arguments),t._selectionChange(),n},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t=0,n;n=e[t++];)if(this.document.getElementsByTagName(n).length>0)return!0;if(!domUtils.isEmptyBlock(this.body))return!0;e=["div"];for(t=0;n=e[t++];){var r=domUtils.getElementsByTagName(this.document,n);for(var i=0,s;s=r[i++];)if(domUtils.isCustomeNode(s))return!0}return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e=this,t;if(e.body.contentEditable=="false"){e.body.contentEditable=!0,t=e.selection.getRange();try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}t.select(!0),e.bkqueryCommandState&&(e.queryCommandState=e.bkqueryCommandState,delete e.bkqueryCommandState),e.fireEvent("selectionchange")}},setDisabled:function(e){var t=this;e=e?utils.isArray(e)?e:[e]:[],t.body.contentEditable=="true"&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.queryCommandState=function(n){return utils.indexOf(e,n)!=-1?t.bkqueryCommandState.apply(t,arguments):-1},t.fireEvent("selectionchange"))},setDefaultContent:function(){function e(){var t=this;if(t.document.getElementById("initContent")){t.document.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";var n=t.selection.getRange();t.removeListener("firstBeforeExecCommand",e),t.removeListener("focus",e),setTimeout(function(){n.setStart(t.document.body.firstChild,0).collapse(!0).select(!0),t._selectionChange()})}}return function(t){var r=this;r.document.body.innerHTML='<p id="initContent">'+t+"</p>",browser.ie&&browser.version<7&&n(r.document.body),r.addListener("firstBeforeExecCommand",e),r.addListener("focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if(e.container.style.display=="none"){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}t.select(!0),e.container.style.display=""}},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},getLang:function(e){var t=UE.I18N[this.options.lang];e=(e||"").split(".");for(var n=0,r;r=e[n++];){t=t[r];if(!t)break}return t}},utils.inherits(i,EventBase)}(),UE.ajax=function(){function e(e){var t=[];for(var n in e){if(n=="method"||n=="timeout"||n=="async")continue;(typeof e[n]).toLowerCase()!="function"&&(typeof e[n]).toLowerCase()!="object"&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}return t.join("&")}function t(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}return e}return{request:function(n,r){var i=t(),s=!1,o={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};typeof n=="object"&&(r=n,n=r.url);if(!i||!n)return;var u=r?utils.extend(o,r):o,a=e(u);utils.isEmptyObject(u.data)||(a+=(a?"&":"")+e(u.data));var f=setTimeout(function(){i.readyState!=4&&(s=!0,i.abort(),clearTimeout(f))},u.timeout),l=u.method.toUpperCase(),c=n+(n.indexOf("?")==-1?"?":"&")+(l=="POST"?"":a+"&noCache="+ +(new Date));i.open(l,c,u.async),i.onreadystatechange=function(){i.readyState==4&&(!s&&i.status==200?u.onsuccess(i):u.onerror(i))},l=="POST"?(i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(a)):i.send(null)}}}(),UE.commands.inserthtml={execCommand:function(e,t,n){var r=this,i,s,o=r.currentSelectedArr;i=r.selection.getRange(),s=i.document.createElement("div"),s.style.display="inline";var u=r.serialize;if(!n&&u){var a=u.parseHTML(t);a=u.transformInput(a),a=u.filter(a),t=u.toHTML(a)}s.innerHTML=utils.trim(t);try{r.adjustTable&&r.adjustTable(s)}catch(f){}if(o&&o.length){for(var l=0,c;c=o[l++];)c.className="";o[0].innerHTML="",i.setStart(o[0],0).collapse(!0),r.currentSelectedArr=[]}if(!i.collapsed){i.deleteContents();if(i.startContainer.nodeType==1){var h=i.startContainer.childNodes[i.startOffset],p;if(h&&domUtils.isBlockElm(h)&&(p=h.previousSibling)&&domUtils.isBlockElm(p)){i.setEnd(p,p.childNodes.length).collapse();while(h.firstChild)p.appendChild(h.firstChild);domUtils.remove(h)}}}var h,d,p,v,m=0;while(h=s.firstChild){i.insertNode(h);if(!m&&h.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(h)){d=domUtils.findParent(h,function(e){return domUtils.isBlockElm(e)});if(d&&d.tagName.toLowerCase()!="body"&&(!dtd[d.tagName][h.nodeName]||h.parentNode!==d)){if(!dtd[d.tagName][h.nodeName])p=d;else{v=h.parentNode;while(v!==d)p=v,v=v.parentNode}domUtils.breakParent(h,p||v);var p=h.previousSibling;domUtils.trimWhiteTextNode(p),p.childNodes.length||domUtils.remove(p),!browser.ie&&(g=h.nextSibling)&&domUtils.isBlockElm(g)&&g.lastChild&&!domUtils.isBr(g.lastChild)&&g.appendChild(r.document.createElement("br")),m=1}}var g=h.nextSibling;if(!s.firstChild&&g&&domUtils.isBlockElm(g)){i.setStart(g,0).collapse(!0);break}i.setEndAfter(h).collapse()}h=i.startContainer,domUtils.isBlockElm(h)&&domUtils.isEmptyNode(h)&&(h.innerHTML=browser.ie?"":"<br/>"),i.select(!0),setTimeout(function(){i=r.selection.getRange(),i.scrollToView(r.autoHeightEnabled,r.autoHeightEnabled?domUtils.getXY(r.iframe).y:0)},200)}},UE.plugins.autotypeset=function(){function o(e,t){if(e&&e.parentNode&&i[e.tagName.toLowerCase()])return s&&s.contains(e)||e.getAttribute("pagebreak")?0:t?!domUtils.isEmptyBlock(e):domUtils.isEmptyBlock(e)}function u(e){e.style.cssText||(domUtils.removeAttributes(e,["style"]),e.tagName.toLowerCase()=="span"&&domUtils.hasNoAttributes(e)&&domUtils.remove(e,!0))}function a(i,a){var f;if(a){if(!t.pasteFilter)return;f=e.document.createElement("div"),f.innerHTML=a.html}else f=e.document.body;var l=domUtils.getElementsByTagName(f,"*");for(var c=0,h;h=l[c++];){!s&&h.tagName=="DIV"&&h.getAttribute("highlighter")&&(s=h),t.clearFontSize&&h.style.fontSize&&(h.style.fontSize="",u(h)),t.clearFontFamily&&h.style.fontFamily&&(h.style.fontFamily="",u(h));if(o(h)){if(t.mergeEmptyline){var p=h.nextSibling,d;while(o(p))d=p,p=d.nextSibling,domUtils.remove(d)}if(t.removeEmptyline&&domUtils.inDoc(h,f)&&!r[h.parentNode.tagName.toLowerCase()]){domUtils.remove(h);continue}}o(h,!0)&&(t.indent&&(h.style.textIndent=t.indentValue),t.textAlign&&(h.style.textAlign=t.textAlign));if(t.removeClass&&h.className&&!n[h.className.toLowerCase()]){if(s&&s.contains(h))continue;domUtils.removeAttributes(h,["class"])}if(t.imageBlockLine&&h.tagName.toLowerCase()=="img"&&!h.getAttribute("emotion"))if(a){var v=h;switch(t.imageBlockLine){case"left":case"right":case"none":var m=v.parentNode,d,g,p;while(dtd.$inline[m.tagName]||m.tagName=="A")m=m.parentNode;d=m;if(d.tagName=="P"&&domUtils.getStyle(d,"text-align")=="center"&&!domUtils.isBody(d)&&domUtils.getChildCount(d,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1){g=d.previousSibling,p=d.nextSibling;if(g&&p&&g.nodeType==1&&p.nodeType==1&&g.tagName==p.tagName&&domUtils.isBlockElm(g)){g.appendChild(d.firstChild);while(p.firstChild)g.appendChild(p.firstChild);domUtils.remove(d),domUtils.remove(p)}else domUtils.setStyle(d,"text-align","")}domUtils.setStyle(v,"float",t.imageBlockLine);break;case"center":if(e.queryCommandValue("imagefloat")!="center"){m=v.parentNode,domUtils.setStyle(v,"float","none"),d=v;while(m&&domUtils.getChildCount(m,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1&&(dtd.$inline[m.tagName]||m.tagName=="A"))d=m,m=m.parentNode;var y=e.document.createElement("p");domUtils.setAttributes(y,{style:"text-align:center"}),d.parentNode.insertBefore(y,d),y.appendChild(d),domUtils.setStyle(d,"float","")}}}else{var b=e.selection.getRange();b.selectNode(h).select(),e.execCommand("imagefloat",t.imageBlockLine)}t.removeEmptyNode&&t.removeTagNames[h.tagName.toLowerCase()]&&domUtils.hasNoAttributes(h)&&domUtils.isEmptyBlock(h)&&domUtils.remove(h)}a&&(a.html=f.innerHTML)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:utils.extend({div:1},dtd.$removeEmpty),indent:!1,indentValue:"2em"}});var e=this,t=e.options.autotypeset,n={selectTdClass:1,pagebreak:1,anchorclass:1},r={li:1},i={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},s;if(!t)return;t.pasteFilter&&e.addListener("beforepaste",a),e.commands.autotypeset={execCommand:function(){e.removeListener("beforepaste",a),t.pasteFilter&&e.addListener("beforepaste",a),a()}}},UE.commands.autosubmit={execCommand:function(){var e=this,t=domUtils.findParentByTagName(e.iframe,"form",!1);if(t){if(e.fireEvent("beforesubmit")===!1)return;e.sync(),t.submit()}}},function(){UE.plugins.background=function(){var e=this;UE.commands.background={queryCommandState:function(){return this.highlight?-1:0}},e.addListener("getAllHtml",function(t,n){var r=this.body,i=domUtils.getComputedStyle(r,"background-image"),s="";i.indexOf(e.options.imagePath)>0?s=i.substring(i.indexOf(e.options.imagePath),i.length-1).replace(/"|\(|\)/ig,""):s=i!="none"?i.replace(/url\("?|"?\)/ig,""):"",n.html='<style type="text/css">body{';var o={"background-color":domUtils.getComputedStyle(r,"background-color")||"#ffffff","background-image":s?"url("+s+")":"","background-repeat":domUtils.getComputedStyle(r,"background-repeat")||"","background-position":browser.ie?domUtils.getComputedStyle(r,"background-position-x")+" "+domUtils.getComputedStyle(r,"background-position-y"):domUtils.getComputedStyle(r,"background-position"),height:domUtils.getComputedStyle(r,"height")};for(var u in o)o.hasOwnProperty(u)&&(n.html+=u+":"+o[u]+";");n.html+="}</style> "})}}(),UE.commands.imagefloat={execCommand:function(e,t){var n=this,r=n.selection.getRange();if(!r.collapsed){var i=r.getClosedNode();if(i&&i.tagName=="IMG")switch(t){case"left":case"right":case"none":var s=i.parentNode,o,u,a;while(dtd.$inline[s.tagName]||s.tagName=="A")s=s.parentNode;o=s;if(o.tagName=="P"&&domUtils.getStyle(o,"text-align")=="center"){if(!domUtils.isBody(o)&&domUtils.getChildCount(o,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1){u=o.previousSibling,a=o.nextSibling;if(u&&a&&u.nodeType==1&&a.nodeType==1&&u.tagName==a.tagName&&domUtils.isBlockElm(u)){u.appendChild(o.firstChild);while(a.firstChild)u.appendChild(a.firstChild);domUtils.remove(o),domUtils.remove(a)}else domUtils.setStyle(o,"text-align","")}r.selectNode(i).select()}domUtils.setStyle(i,"float",t);break;case"center":if(n.queryCommandValue("imagefloat")!="center"){s=i.parentNode,domUtils.setStyle(i,"float","none"),o=i;while(s&&domUtils.getChildCount(s,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})==1&&(dtd.$inline[s.tagName]||s.tagName=="A"))o=s,s=s.parentNode;r.setStartBefore(o).setCursor(!1),s=n.document.createElement("div"),s.appendChild(o),domUtils.setStyle(o,"float",""),n.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+s.innerHTML+"</p>"),o=n.document.getElementById("_img_parent_tmp"),o.removeAttribute("id"),o=o.firstChild,r.selectNode(o).select(),a=o.parentNode.nextSibling,a&&domUtils.isEmptyNode(a)&&domUtils.remove(a)}}}},queryCommandValue:function(){var e=this.selection.getRange(),t,n;return e.collapsed?"none":(t=e.getClosedNode(),t&&t.nodeType==1&&t.tagName=="IMG"?(n=domUtils.getComputedStyle(t,"float"),n=="none"&&(n=domUtils.getComputedStyle(t.parentNode,"text-align")=="center"?"center":n),{left:1,right:1,center:1}[n]?n:"none"):"none")},queryCommandState:function(){if(this.highlight)return-1;var e=this.selection.getRange(),t;return e.collapsed?-1:(t=e.getClosedNode(),t&&t.nodeType==1&&t.tagName=="IMG"?0:-1)}},UE.commands.insertimage={execCommand:function(e,t){t=utils.isArray(t)?t:[t];if(!t.length)return;var n=this,r=n.selection.getRange(),i=r.getClosedNode();if(i&&/img/i.test(i.tagName)&&i.className!="edui-faked-video"&&!i.getAttribute("word_img")){var s=t.shift(),o=s.floatStyle;delete s.floatStyle,domUtils.setAttributes(i,s),n.execCommand("imagefloat",o),t.length>0&&(r.setStartAfter(i).setCursor(!1,!0),n.execCommand("insertimage",t))}else{var u=[],a="",f;f=t[0];if(t.length==1)a='<img src="'+f.src+'" '+(f.data_ue_src?' data_ue_src="'+f.data_ue_src+'" ':"")+(f.width?'width="'+f.width+'" ':"")+(f.height?' height="'+f.height+'" ':"")+(f["floatStyle"]=="left"||f["floatStyle"]=="right"?' style="float:'+f.floatStyle+';"':"")+(f.title&&f.title!=""?' title="'+f.title+'"':"")+(f.border&&f.border!="0"?' border="'+f.border+'"':"")+(f.alt&&f.alt!=""?' alt="'+f.alt+'"':"")+(f.hspace&&f.hspace!="0"?' hspace = "'+f.hspace+'"':"")+(f.vspace&&f.vspace!="0"?' vspace = "'+f.vspace+'"':"")+"/>",f["floatStyle"]=="center"&&(a='<p style="text-align: center">'+a+"</p>"),u.push(a);else for(var l=0;f=t[l++];)a="<p "+(f["floatStyle"]=="center"?'style="text-align: center" ':"")+'><img src="'+f.src+'" '+(f.width?'width="'+f.width+'" ':"")+(f.data_ue_src?' data_ue_src="'+f.data_ue_src+'" ':"")+(f.height?' height="'+f.height+'" ':"")+' style="'+(f.floatStyle&&f["floatStyle"]!="center"?"float:"+f.floatStyle+";":"")+(f.border||"")+'" '+(f.title?' title="'+f.title+'"':"")+" /></p>",u.push(a);n.execCommand("insertHtml",u.join(""))}},queryCommandState:function(){return this.highlight?-1:0}},function(){var e=domUtils.isBlockElm,t={left:1,right:1,center:1,justify:1},n=function(t,n){var r=t.createBookmark(),i=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)};t.enlarge(!0);var s=t.createBookmark(),o=domUtils.getNextDomNode(s.start,!1,i),u=t.cloneRange(),a;while(o&&!(domUtils.getPosition(o,s.end)&domUtils.POSITION_FOLLOWING))if(o.nodeType==3||!e(o)){u.setStartBefore(o);while(o&&o!==s.end&&!e(o))a=o,o=domUtils.getNextDomNode(o,!1,null,function(t){return!e(t)});u.setEndAfter(a);var f=u.getCommonAncestor();if(!domUtils.isBody(f)&&e(f))domUtils.setStyles(f,utils.isString(n)?{"text-align":n}:n),o=f;else{var l=t.document.createElement("p");domUtils.setStyles(l,utils.isString(n)?{"text-align":n}:n);var c=u.extractContents();l.appendChild(c),u.insertNode(l),o=l}o=domUtils.getNextDomNode(o,!1,i)}else o=domUtils.getNextDomNode(o,!0,i);return t.moveToBookmark(s).moveToBookmark(r)};UE.commands.justify={execCommand:function(e,t){var r=this.selection.getRange(),i;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var s=0,o;o=this.currentSelectedArr[s++];)domUtils.isEmptyNode(o)?(i=this.document.createTextNode("p"),r.setStart(o,0).collapse(!0).insertNode(i).selectNode(i)):r.selectNodeContents(o),n(r,t.toLowerCase()),i&&domUtils.remove(i);r.selectNode(this.currentSelectedArr[0]).select()}else r.collapsed&&(i=this.document.createTextNode("p"),r.insertNode(i)),n(r,t),i&&(r.setStartBefore(i).collapse(!0),domUtils.remove(i)),r.select();return!0},queryCommandValue:function(){var e=this.selection.getStart(),n=domUtils.getComputedStyle(e,"text-align");return t[n]?n:"left"},queryCommandState:function(){return this.highlight?-1:0}}}(),UE.plugins.font=function(){var e=this,t={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};e.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"
},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});for(var n in t)(function(e,t){UE.commands[e]={execCommand:function(n,r){r=r||(this.queryCommandState(n)?"none":n=="underline"?"underline":"line-through");var i=this,s=this.selection.getRange(),o;if(r=="default")s.collapsed&&(o=i.document.createTextNode("font"),s.insertNode(o).select()),i.execCommand("removeFormat","span,a",t),o&&(s.setStartBefore(o).setCursor(),domUtils.remove(o));else if(i.currentSelectedArr&&i.currentSelectedArr.length>0){for(var u=0,a;a=i.currentSelectedArr[u++];)s.selectNodeContents(a),s.applyInlineStyle("span",{style:t+":"+r});s.selectNodeContents(this.currentSelectedArr[0]).select()}else if(!s.collapsed)(e=="underline"||e=="strikethrough")&&i.queryCommandValue(e)&&i.execCommand("removeFormat","span,a",t),s=i.selection.getRange(),s.applyInlineStyle("span",{style:t+":"+r}).select();else{var f=domUtils.findParentByTagName(s.startContainer,"span",!0);o=i.document.createTextNode("font");if(f&&!f.children.length&&!f[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){s.insertNode(o);if(e=="underline"||e=="strikethrough")s.selectNode(o).select(),i.execCommand("removeFormat","span,a",t,null),f=domUtils.findParentByTagName(o,"span",!0),s.setStartBefore(o);f.style.cssText+=";"+t+":"+r,s.collapse(!0).select()}else{s.insertNode(o),s.selectNode(o).select(),f=s.document.createElement("span");if(e=="underline"||e=="strikethrough"){if(domUtils.findParentByTagName(o,"a",!0)){s.setStartBefore(o).setCursor(),domUtils.remove(o);return}i.execCommand("removeFormat","span,a",t)}f.style.cssText=t+":"+r,o.parentNode.insertBefore(f,o);if(!browser.ie||browser.ie&&browser.version==9){var l=f.parentNode;while(!domUtils.isBlockElm(l))l.tagName=="SPAN"&&(f.style.cssText=l.style.cssText+";"+f.style.cssText),l=l.parentNode}opera?setTimeout(function(){s.setStart(f,0).setCursor()}):s.setStart(f,0).setCursor()}domUtils.remove(o)}return!0},queryCommandValue:function(e){var n=this.selection.getStart();if(e=="underline"||e=="strikethrough"){var r=n,i;while(r&&!domUtils.isBlockElm(r)&&!domUtils.isBody(r)){if(r.nodeType==1){i=domUtils.getComputedStyle(r,t);if(i!="none")return i}r=r.parentNode}return"none"}return domUtils.getComputedStyle(n,t)},queryCommandState:function(e){return this.highlight?-1:e!="underline"&&e!="strikethrough"?0:this.queryCommandValue(e)==(e=="underline"?"underline":"line-through")}}})(n,t[n])},function(){function e(e){var t=e.startContainer,n=e.endContainer;(t=domUtils.findParentByTagName(t,"a",!0))&&e.setStartBefore(t),(n=domUtils.findParentByTagName(n,"a",!0))&&e.setEndAfter(n)}function t(t,n){e(t=t.adjustmentBoundary());var r=t.startContainer;r.nodeType==1&&(r=r.childNodes[t.startOffset],r&&r.nodeType==1&&r.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(r[browser.ie?"innerText":"textContent"])&&(r[browser.ie?"innerText":"textContent"]=utils.html(n.textValue||n.href))),t.removeInlineStyle("a");if(t.collapsed){var i=t.document.createElement("a"),s="";n.textValue?(s=utils.html(n.textValue),delete n.textValue):s=utils.html(n.href),domUtils.setAttributes(i,n),t.insertNode(i),i[browser.ie?"innerText":"textContent"]=s,t.selectNode(i)}else t.applyInlineStyle("a",n)}UE.commands.unlink={execCommand:function(){var t,n=new dom.Range(this.document),r=this.currentSelectedArr,i;if(r&&r.length>0){for(var s=0,o;o=r[s++];){t=domUtils.getElementsByTagName(o,"a");for(var u=0,a;a=t[u++];)domUtils.remove(a,!0)}domUtils.isEmptyNode(r[0])?n.setStart(r[0],0).setCursor():n.selectNodeContents(r[0]).select()}else{n=this.selection.getRange();if(n.collapsed&&!domUtils.findParentByTagName(n.startContainer,"a",!0))return;i=n.createBookmark(),e(n),n.removeInlineStyle("a").moveToBookmark(i).select()}},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={queryCommandState:function(){return this.highlight?-1:0},execCommand:function(e,n){var r=new dom.Range(this.document),i=this.currentSelectedArr;n.data_ue_src&&(n.data_ue_src=utils.unhtml(n.data_ue_src,/[<">]/g)),n.href&&(n.href=utils.unhtml(n.href,/[<">]/g)),n.textValue&&(n.textValue=utils.unhtml(n.textValue,/[<">]/g));if(i&&i.length){for(var s=0,o;o=i[s++];)domUtils.isEmptyNode(o)&&(o[browser.ie?"innerText":"textContent"]=utils.html(n.textValue||n.href)),t(r.selectNodeContents(o),n);r.selectNodeContents(i[0]).select()}else t(r=this.selection.getRange(),n),r.collapse().select(!0)},queryCommandValue:function(){var e=new dom.Range(this.document),t=this.currentSelectedArr,n,r;if(t&&t.length)for(var i=0,s;s=t[i++];){n=s.getElementsByTagName("a");if(n[0])return n[0]}else{e=this.selection.getRange();if(!e.collapsed){e.shrinkBoundary();var o=e.startContainer.nodeType==3||!e.startContainer.childNodes[e.startOffset]?e.startContainer:e.startContainer.childNodes[e.startOffset],u=e.endContainer.nodeType==3||e.endOffset==0?e.endContainer:e.endContainer.childNodes[e.endOffset-1],a=e.getCommonAncestor();r=domUtils.findParentByTagName(a,"a",!0);if(!r&&a.nodeType==1){var n=a.getElementsByTagName("a"),f,l;for(var i=0,c;c=n[i++];){f=domUtils.getPosition(c,o),l=domUtils.getPosition(c,u);if((f&domUtils.POSITION_FOLLOWING||f&domUtils.POSITION_CONTAINS)&&(l&domUtils.POSITION_PRECEDING||l&domUtils.POSITION_CONTAINS)){r=c;break}}}return r}r=this.selection.getStart();if(r&&(r=domUtils.findParentByTagName(r,"a",!0)))return r}}}}(),UE.commands.gmap=UE.commands.map={queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.insertframe=function(){function t(){e._iframe&&delete e._iframe}var e=this;e.addListener("selectionchange",function(){t()}),e.commands.insertframe={queryCommandState:function(){return this.highlight?-1:0}}},UE.commands.scrawl={queryCommandState:function(){return this.highlight||browser.ie&&browser.version<=8?-1:0}},UE.plugins.removeformat=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),e.commands.removeformat={execCommand:function(e,t,n,r,i){function h(e){if(e.nodeType==3||e.tagName.toLowerCase()!="span")return 0;if(browser.ie){var t=e.attributes;if(t.length){for(var n=0,r=t.length;n<r;n++)if(t[n].specified)return 0;return 1}}return!e.attributes.length}function p(e){var t=e.createBookmark();e.collapsed&&e.enlarge(!0);if(!i){var r=domUtils.findParentByTagName(e.startContainer,"a",!0);r&&e.setStartBefore(r),r=domUtils.findParentByTagName(e.endContainer,"a",!0),r&&e.setEndAfter(r)}a=e.createBookmark(),d=a.start;while((l=d.parentNode)&&!domUtils.isBlockElm(l))domUtils.breakParent(d,l),domUtils.clearEmptySibling(d);if(a.end){d=a.end;while((l=d.parentNode)&&!domUtils.isBlockElm(l))domUtils.breakParent(d,l),domUtils.clearEmptySibling(d);var u=domUtils.getNextDomNode(a.start,!1,c),f;while(u){if(u==a.end)break;f=domUtils.getNextDomNode(u,!0,c),!dtd.$empty[u.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(u)&&(s.test(u.tagName)?n?(domUtils.removeStyle(u,n),h(u)&&n!="text-decoration"&&domUtils.remove(u,!0)):domUtils.remove(u,!0):!dtd.$tableContent[u.tagName]&&!dtd.$list[u.tagName]&&(domUtils.removeAttributes(u,o),h(u)&&domUtils.remove(u,!0))),u=f}}var p=a.start.parentNode;domUtils.isBlockElm(p)&&!dtd.$tableContent[p.tagName]&&!dtd.$list[p.tagName]&&domUtils.removeAttributes(p,o),p=a.end.parentNode,a.end&&domUtils.isBlockElm(p)&&!dtd.$tableContent[p.tagName]&&!dtd.$list[p.tagName]&&domUtils.removeAttributes(p,o),e.moveToBookmark(a).moveToBookmark(t);var d=e.startContainer,v,m=e.collapsed;while(d.nodeType==1&&domUtils.isEmptyNode(d)&&dtd.$removeEmpty[d.tagName])v=d.parentNode,e.setStartBefore(d),e.startContainer===e.endContainer&&e.endOffset--,domUtils.remove(d),d=v;if(!m){d=e.endContainer;while(d.nodeType==1&&domUtils.isEmptyNode(d)&&dtd.$removeEmpty[d.tagName])v=d.parentNode,e.setEndBefore(d),domUtils.remove(d),d=v}}var s=new RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),o=n?[]:(r||this.options.removeFormatAttributes).split(","),u=new dom.Range(this.document),a,f,l,c=function(e){return e.nodeType==1};if(this.currentSelectedArr&&this.currentSelectedArr.length){for(var d=0,v;v=this.currentSelectedArr[d++];)u.selectNodeContents(v),p(u);u.selectNodeContents(this.currentSelectedArr[0]).select()}else u=this.selection.getRange(),p(u),u.select()},queryCommandState:function(){return this.highlight?-1:0}}},function(){var e=function(e){return utils.findNode(e.selection.getStartElementPath(),["blockquote"])};UE.commands.blockquote={execCommand:function(t,n){var r=this.selection.getRange(),i=e(this),s=dtd.blockquote,o=r.createBookmark(),u=this.currentSelectedArr;if(i)if(u&&u.length)domUtils.remove(i,!0);else{var a=r.startContainer,f=domUtils.isBlockElm(a)?a:domUtils.findParent(a,function(e){return domUtils.isBlockElm(e)}),l=r.endContainer,c=domUtils.isBlockElm(l)?l:domUtils.findParent(l,function(e){return domUtils.isBlockElm(e)});f=domUtils.findParentByTagName(f,"li",!0)||f,c=domUtils.findParentByTagName(c,"li",!0)||c,f.tagName=="LI"||f.tagName=="TD"||f===i?domUtils.remove(i,!0):domUtils.breakParent(f,i),f!==c&&(i=domUtils.findParentByTagName(c,"blockquote"),i&&(c.tagName=="LI"||c.tagName=="TD"?domUtils.remove(i,!0):domUtils.breakParent(c,i)));var h=domUtils.getElementsByTagName(this.document,"blockquote");for(var p=0,d;d=h[p++];)d.childNodes.length?domUtils.getPosition(d,f)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(d,c)&domUtils.POSITION_PRECEDING&&domUtils.remove(d,!0):domUtils.remove(d)}else{var v=r.cloneRange(),m=v.startContainer.nodeType==1?v.startContainer:v.startContainer.parentNode,g=m,y=1;for(;;){if(domUtils.isBody(m)){g!==m?r.collapsed?(v.selectNode(g),y=0):v.setStartBefore(g):v.setStart(m,0);break}if(!s[m.tagName]){r.collapsed?v.selectNode(g):v.setStartBefore(g);break}g=m,m=m.parentNode}if(y){g=m=m=v.endContainer.nodeType==1?v.endContainer:v.endContainer.parentNode;for(;;){if(domUtils.isBody(m)){g!==m?v.setEndAfter(g):v.setEnd(m,m.childNodes.length);break}if(!s[m.tagName]){v.setEndAfter(g);break}g=m,m=m.parentNode}}m=r.document.createElement("blockquote"),domUtils.setAttributes(m,n),m.appendChild(v.extractContents()),v.insertNode(m);var b=domUtils.getElementsByTagName(m,"blockquote");for(var p=0,w;w=b[p++];)w.parentNode&&domUtils.remove(w,!0)}r.moveToBookmark(o).select()},queryCommandState:function(){return this.highlight?-1:e(this)?1:0}}}(),UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(e){var t=this,n=new dom.Range(t.document),r=function(){var n=t.selection.getRange();if(n.collapsed)return n;var r=n.createBookmark(),i=r.end,s=function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)},o=domUtils.getNextDomNode(r.start,!1,s);while(o&&domUtils.getPosition(o,i)&domUtils.POSITION_PRECEDING){o.nodeType==3&&(o.nodeValue=o.nodeValue[e=="touppercase"?"toUpperCase":"toLowerCase"]()),o=domUtils.getNextDomNode(o,!0,s);if(o===i)break}return n.moveToBookmark(r)};if(t.currentSelectedArr&&t.currentSelectedArr.length>0){for(var i=0,s;s=t.currentSelectedArr[i++];)s.style.display!="none"&&!domUtils.isEmptyBlock(s)&&(n.selectNodeContents(s).select(),r());n.selectNodeContents(t.currentSelectedArr[0]).select()}else r().select()},queryCommandState:function(){return this.highlight?-1:0}},UE.commands.indent={execCommand:function(){var e=this,t=e.queryCommandState("indent")?"0em":e.options.indentValue||"2em";e.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){if(this.highlight)return-1;var e=utils.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]);return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}},UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands.preview={execCommand:function(){var e=window.open("","_blank",""),t=e.document;t.open(),t.write(this.getAllHtml()),t.close()},notNeedUndo:1},UE.commands.spechars={queryCommandState:function(){return this.highlight?-1:0}},UE.commands.emotion={queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.selectall=function(){var e=this;e.commands.selectall={execCommand:function(){var e=this,t=e.body,n=e.selection.getRange();n.selectNodeContents(t),domUtils.isEmptyBlock(t)&&(browser.opera&&t.firstChild&&t.firstChild.nodeType==1&&n.setStartAtFirst(t.firstChild),n.collapse(!0)),n.select(!0),this.selectAll=!0},notNeedUndo:1},e.addListener("ready",function(){domUtils.on(e.document,"click",function(t){e.selectAll=!1})})},UE.plugins.paragraph=function(){var e=this,t=domUtils.isBlockElm,n=["TD","LI","PRE"],r=function(e,r,i,s){var o=e.createBookmark(),u=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)},a;e.enlarge(!0);var f=e.createBookmark(),l=domUtils.getNextDomNode(f.start,!1,u),c=e.cloneRange(),h;while(l&&!(domUtils.getPosition(l,f.end)&domUtils.POSITION_FOLLOWING))if(l.nodeType==3||!t(l)){c.setStartBefore(l);while(l&&l!==f.end&&!t(l))h=l,l=domUtils.getNextDomNode(l,!1,null,function(e){return!t(e)});c.setEndAfter(h),a=e.document.createElement(r),i&&(domUtils.setAttributes(a,i),s&&s=="customstyle"&&i.style&&(a.style.cssText=i.style)),a.appendChild(c.extractContents()),domUtils.isEmptyNode(a)&&domUtils.fillChar(e.document,a),c.insertNode(a);var p=a.parentNode;if(t(p)&&!domUtils.isBody(a.parentNode)&&utils.indexOf(n,p.tagName)==-1){if(!s||s!="customstyle")p.getAttribute("dir")&&a.setAttribute("dir",p.getAttribute("dir")),p.style.cssText&&(a.style.cssText=p.style.cssText+";"+a.style.cssText),p.style.textAlign&&!a.style.textAlign&&(a.style.textAlign=p.style.textAlign),p.style.textIndent&&!a.style.textIndent&&(a.style.textIndent=p.style.textIndent),p.style.padding&&!a.style.padding&&(a.style.padding=p.style.padding);i&&/h\d/i.test(p.tagName)&&!/h\d/i.test(a.tagName)?(domUtils.setAttributes(p,i),s&&s=="customstyle"&&i.style&&(p.style.cssText=i.style),domUtils.remove(a,!0),a=p):domUtils.remove(a.parentNode,!0)}utils.indexOf(n,p.tagName)!=-1?l=p:l=a,l=domUtils.getNextDomNode(l,!1,u)}else l=domUtils.getNextDomNode(l,!0,u);return e.moveToBookmark(f).moveToBookmark(o)};e.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),e.commands.paragraph={execCommand:function(e,t,n,i){var s=new dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var o=0,u;u=this.currentSelectedArr[o++];){if(u.style.display=="none")continue;if(domUtils.isEmptyNode(u)){var a=this.document.createTextNode("paragraph");u.innerHTML="",u.appendChild(a)}r(s.selectNodeContents(u),t,n,i);if(a){var f=a.parentNode;domUtils.remove(a),domUtils.isEmptyNode(f)&&domUtils.fillNode(this.document,f)}}var l=this.currentSelectedArr[0];domUtils.isEmptyBlock(l)?s.setStart(l,0).setCursor(!1,!0):s.selectNode(l).select()}else{s=this.selection.getRange();if(s.collapsed){var c=this.document.createTextNode("p");s.insertNode(c);if(browser.ie){var h=c.previousSibling;h&&domUtils.isWhitespace(h)&&domUtils.remove(h),h=c.nextSibling,h&&domUtils.isWhitespace(h)&&domUtils.remove(h)}}s=r(s,t,n,i),c&&(s.setStartBefore(c).collapse(!0),f=c.parentNode,domUtils.remove(c),domUtils.isBlockElm(f)&&domUtils.isEmptyNode(f)&&domUtils.fillNode(this.document,f));if(browser.gecko&&s.collapsed&&s.startContainer.nodeType==1){var p=s.startContainer.childNodes[s.startOffset];p&&p.nodeType==1&&p.tagName.toLowerCase()==t&&s.setStart(p,0).collapse(!0)}s.select()}return!0},queryCommandValue:function(){var e=utils.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]);return e?e.tagName.toLowerCase():""},queryCommandState:function(){return this.highlight?-1:0}}},function(){var e=domUtils.isBlockElm,t=function(e){return utils.findNode(e.selection.getStartElementPath(),null,function(e){return e.getAttribute("dir")})},n=function(n,r,i){var s,o=function(e){return e.nodeType==1?!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)},u=t(r);if(u&&n.collapsed)return u.setAttribute("dir",i),n;s=n.createBookmark(),n.enlarge(!0);var a=n.createBookmark(),f=domUtils.getNextDomNode(a.start,!1,o),l=n.cloneRange(),c;while(f&&!(domUtils.getPosition(f,a.end)&domUtils.POSITION_FOLLOWING))if(f.nodeType==3||!e(f)){l.setStartBefore(f);while(f&&f!==a.end&&!e(f))c=f,f=domUtils.getNextDomNode(f,!1,null,function(t){return!e(t)});l.setEndAfter(c);var h=l.getCommonAncestor();if(!domUtils.isBody(h)&&e(h))h.setAttribute("dir",i),f=h;else{var p=n.document.createElement("p");p.setAttribute("dir",i);var d=l.extractContents();p.appendChild(d),l.insertNode(p),f=p}f=domUtils.getNextDomNode(f,!1,o)}else f=domUtils.getNextDomNode(f,!0,o);return n.moveToBookmark(a).moveToBookmark(s)};UE.commands.directionality={execCommand:function(e,t){var r=new dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var i=0,s;s=this.currentSelectedArr[i++];)s.style.display!="none"&&n(r.selectNode(s),this,t);r.selectNode(this.currentSelectedArr[0]).select()}else{r=this.selection.getRange();if(r.collapsed){var o=this.document.createTextNode("d");r.insertNode(o)}n(r,this,t),o&&(r.setStartBefore(o).collapse(!0),domUtils.remove(o)),r.select()}return!0},queryCommandValue:function(){var e=t(this);return e?e.getAttribute("dir"):"ltr"},queryCommandState:function(){return this.highlight?-1:0}}}(),UE.commands.horizontal={execCommand:function(e){var t=this;if(t.queryCommandState(e)!==-1){t.execCommand("insertHtml","<hr>");var n=t.selection.getRange(),r=n.startContainer;if(r.nodeType==1&&!r.childNodes[n.startOffset]){var i;(i=r.childNodes[n.startOffset-1])&&i.nodeType==1&&i.tagName=="HR"&&(t.options.enterTag=="p"?(i=t.document.createElement("p"),n.insertNode(i),n.setStart(i,0).setCursor()):(i=t.document.createElement("br"),n.insertNode(i),n.setStartBefore(i).setCursor()))}return!0}},queryCommandState:function(){return this.highlight||utils.findNode(this.selection.getStartElementPath(),["table"])?-1:0}},UE.commands.time=UE.commands.date={execCommand:function(e){var t=new Date;this.execCommand("insertHtml",e=="time"?t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds()):t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate()))},queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.rowspacing=function(){var e=this;e.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]}),e.commands.rowspacing={execCommand:function(e,t,n){return this.execCommand("paragraph","p",{style:"margin-"+n+":"+t+"px"}),!0},queryCommandValue:function(e,t){var n=utils.findNode(this.selection.getStartElementPath(),null,function(e){return domUtils.isBlockElm(e)}),r;return n?(r=domUtils.getComputedStyle(n,"margin-"+t).replace(/[^\d]/g,""),r?r:0):0},queryCommandState:function(){return this.highlight?-1:0}}},UE.plugins.lineheight=function(){var e=this;e.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]}),e.commands.lineheight={execCommand:function(e,t){return this.execCommand("paragraph","p",{style:"line-height:"+(t=="1"?"normal":t+"em")}),!0},queryCommandValue:function(){var e=utils.findNode(this.selection.getStartElementPath(),null,function(e){return domUtils.isBlockElm(e)});if(e){var t=domUtils.getComputedStyle(e,"line-height");return t=="normal"?1:t.replace(/[^\d.]*/ig,"")}},queryCommandState:function(){return this.highlight?-1:0}}},UE.commands.cleardoc={execCommand:function(e){var t=this,n=t.options.enterTag,r=t.selection.getRange();n=="br"?(t.body.innerHTML="<br/>",r.setStart(t.body,0).setCursor()):(t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",r.setStart(t.body.firstChild,0).setCursor(!1,!0))}},UE.commands.anchor={execCommand:function(e,t){var n=this.selection.getRange(),r=n.getClosedNode();if(r&&r.getAttribute("anchorname"))t?r.setAttribute("anchorname",t):(n.setStartBefore(r).setCursor(),domUtils.remove(r));else if(t){var i=this.document.createElement("img");n.collapse(!0),domUtils.setAttributes(i,{anchorname:t,"class":"anchorclass"}),n.insertNode(i).setStartAfter(i).setCursor(!1,!0)}},queryCommandState:function(){return this.highlight?-1:0}},UE.commands["delete"]={execCommand:function(){var e=this.selection.getRange(),t=0,n=0,r=this;if(this.selectAll){r.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>",e.setStart(r.body.firstChild,0).setCursor(!1,!0),r.selectAll=!1;return}if(r.currentSelectedArr&&r.currentSelectedArr.length>0){for(var i=0,s;s=r.currentSelectedArr[i++];)s.style.display!="none"&&(s.innerHTML=browser.ie?domUtils.fillChar:"<br/>");e.setStart(r.currentSelectedArr[0],0).setCursor();return}if(e.collapsed)return;e.txtToElmBoundary();while(!e.startOffset&&!domUtils.isBody(e.startContainer)&&!dtd.$tableContent[e.startContainer.tagName])t=1,e.setStartBefore(e.startContainer);while(e.endContainer.nodeType!=3&&!domUtils.isBody(e.endContainer)&&!dtd.$tableContent[e.endContainer.tagName]){var o,u=e.endContainer,a=e.endOffset;o=u.childNodes[a];if(!o||domUtils.isBr(o)&&u.lastChild===o){e.setEndAfter(u);continue}break}if(t){var f=r.document.createElement("span");f.innerHTML="start",f.id="_baidu_cut_start",e.insertNode(f).setStartBefore(f)}if(n){var l=r.document.createElement("span");l.innerHTML="end",l.id="_baidu_cut_end",e.cloneRange().collapse(!1).insertNode(l),e.setEndAfter(l)}e.deleteContents(),domUtils.isBody(e.startContainer)&&domUtils.isEmptyBlock(r.body)?(r.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",e.setStart(r.body.firstChild,0).collapse(!0)):!browser.ie&&domUtils.isEmptyBlock(e.startContainer)&&(e.startContainer.innerHTML="<br/>"),e.select(!0)},queryCommandState:function(){return this.currentSelectedArr&&this.currentSelectedArr.length>0?0:this.highlight||this.selection.getRange().collapsed?-1:0}},UE.plugins.wordcount=function(){var e=this;e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var t=e.options,n=t.maximumWords,r=t.wordCountMsg,i=t.wordOverFlowMsg;if(!t.wordCount)return;e.commands.wordcount={queryCommandValue:function(t,s){var o,u,a;return s?(a=new RegExp("[\r	\n]","g"),u=this.getContentTxt().replace(a,""),u.length):(a=new RegExp("[\r	\n]","g"),u=this.getContentTxt().replace(a,""),o=u.length,n-o<0?(e.fireEvent("wordcountoverflow"),i):r.replace("{#leave}",n-o>=0?n-o:0).replace("{#count}",o))}}},UE.plugins.pagebreak=function(){function n(t){if(domUtils.isEmptyBlock(t)){var n=t.firstChild,r;while(n&&n.nodeType==1&&domUtils.isEmptyBlock(n))r=n,n=n.firstChild;!r&&(r=t),domUtils.fillNode(e.document,r)}}function r(e){return e&&e.nodeType==1&&e.tagName=="HR"&&e.className=="pagebreak"}var e=this,t=["td"];e.commands.pagebreak={execCommand:function(){var i=e.selection.getRange(),s=e.document.createElement("hr");domUtils.setAttributes(s,{"class":"pagebreak",noshade:"noshade",size:"5"}),domUtils.unselectable(s);var o=domUtils.findParentByTagName(i.startContainer,t,!0),u=[],a;if(o)switch(o.tagName){case"TD":a=o.parentNode;if(!a.previousSibling){var f=domUtils.findParentByTagName(a,"table");f.parentNode.insertBefore(s,f),u=domUtils.findParents(s,!0)}else a.parentNode.insertBefore(s,a),u=domUtils.findParents(s);a=u[1],s!==a&&domUtils.breakParent(s,a),domUtils.clearSelectedArr(e.currentSelectedArr),e.fireEvent("afteradjusttable",e.document)}else{if(!i.collapsed){i.deleteContents();var l=i.startContainer;while(!domUtils.isBody(l)&&domUtils.isBlockElm(l)&&domUtils.isEmptyNode(l))i.setStartBefore(l).collapse(!0),domUtils.remove(l),l=i.startContainer}i.insertNode(s);var a=s.parentNode,c;while(!domUtils.isBody(a))domUtils.breakParent(s,a),c=s.nextSibling,c&&domUtils.isEmptyBlock(c)&&domUtils.remove(c),a=s.parentNode;c=s.nextSibling;var h=s.previousSibling;r(h)?domUtils.remove(h):h&&n(h);if(!c){var p=e.document.createElement("p");s.parentNode.appendChild(p),domUtils.fillNode(e.document,p),i.setStart(p,0).collapse(!0)}else r(c)?domUtils.remove(c):n(c),i.setEndAfter(s).collapse(!1);i.select(!0)}},queryCommandState:function(){return this.highlight?-1:0}}},UE.plugins.wordimage=function(){var e=this,t;e.commands.wordimage={execCommand:function(){t=domUtils.getElementsByTagName(e.document.body,"img");var n=[];for(var r=0,i;i=t[r++];){var s=i.getAttribute("word_img");s&&n.push(s)}t.length&&(this.word_img=n)},queryCommandState:function(){t=domUtils.getElementsByTagName(e.document.body,"img");for(var n=0,r;r=t[n++];)if(r.getAttribute("word_img"))return 1;return-1}}},UE.plugins.undo=function(){function s(e){var t=this;t.collapsed=e.collapsed,t.startAddr=o(e.startContainer,e.startOffset),t.endAddr=e.collapsed?t.startAddr:o(e.endContainer,e.endOffset)}function o(e,t){for(var n=0,r=[t],i,s=domUtils.findParents(e,!0,function(e){return!domUtils.isBody(e)},!0);i=s[n++];){if(n==1&&i.nodeType==3){var o=i;while(o=o.previousSibling){if(o.nodeType!=3)break;t+=o.nodeValue.replace(fillCharReg,"").length}r[0]=t}r.push(domUtils.getNodeIndex(i,!0))}return r.reverse()}function u(e,t){if(e.length!=t.length)return 0;for(var n=0,r=e.length;n<r;n++)if(e[n]!=t[n])return 0;return 1}function a(e,t,n){i=e.document.body;for(var r=0,i,s=n.length-1;r<s;r++)i=i.childNodes[n[r]];e[t+"Container"]=i,e[t+"Offset"]=n[n.length-1]}function f(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){var e=this.getScene(),t=this.list[this.index];t.content.replace(i,"")!=e.content.replace(i,"")&&this.save();if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}},this.restore=function(){var t=this.list[this.index];e.document.body.innerHTML=t.bookcontent.replace(r,"");if(browser.ie)for(var n=0,i,s=e.document.getElementsByTagName("p");i=s[n++];)i.innerHTML==""&&domUtils.fillNode(e.document,i);var o=new dom.Range(e.document);try{browser.opera||browser.safari?t.senceRange.transformRange(o):o.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:!0}),browser.ie&&browser.version==9&&o.collapsed&&domUtils.isBlockElm(o.startContainer)&&domUtils.isEmptyNode(o.startContainer)&&domUtils.fillNode(o.document,o.startContainer),o.select(!browser.gecko),!browser.opera&&!browser.safari&&setTimeout(function(){o.scrollToView(e.autoHeightEnabled,e.autoHeightEnabled?domUtils.getXY(e.iframe).y:0)},200)}catch(u){}this.update();if(e.currentSelectedArr){e.currentSelectedArr=[];var a=e.document.getElementsByTagName("td");for(var n=0,f;f=a[n++];)f.className==e.options.selectedTdClass&&e.currentSelectedArr.push(f)}this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var t=e.selection.getRange(),n=e.body.innerHTML.replace(r,"");t.shrinkBoundary(),browser.ie&&(n=n.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));if(browser.opera||browser.safari)return{senceRange:new s(t),content:n,bookcontent:n};var i=t.createBookmark(!0,!0),o=e.body.innerHTML.replace(r,"");return i&&t.moveToBookmark(i).select(!0),{bookcontent:o,content:n}},this.save=function(){var e=this.getScene(),n=this.list[this.index];if(n&&n.content==e.content&&(browser.opera||browser.safari?n.senceRange.compare(e.senceRange):n.bookcontent==e.bookcontent))return;this.list=this.list.slice(0,this.index+1),this.list.push(e),this.list.length>t&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update()},this.update=function(){this.hasRedo=this.list[this.index+1]?!0:!1,this.hasUndo=this.list[this.index-1]||this.list.length==1?!0:!1},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){h=0,p=null,e.fireEvent("contentchange")}}function l(){this.undoManger.save()}var e=this,t=e.options.maxUndoCount||20,n=e.options.maxInputCount||20,r=new RegExp(domUtils.fillChar+"|</hr>","gi"),i=/\b(?:href|src|name)="[^"]*?"/gi;s.prototype={compare:function(t){return e.collapsed!==t.collapsed?0:!u(e.startAddr,t.startAddr)||!u(e.endAddr,t.endAddr)?0:1},transformRange:function(e){var t=this;e.collapsed=t.collapsed,a(e,"start",t.startAddr),e.collapsed?e.collapse(!0):a(e,"end",t.endAddr)}},e.undoManger=new f,e.addListener("beforeexeccommand",l),e.addListener("afterexeccommand",l),e.addListener("reset",function(t,n){n||e.undoManger.reset()}),e.commands.redo=e.commands.undo={execCommand:function(t){e.undoManger[t]()},queryCommandState:function(t){return e.undoManger["has"+(t.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var c={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},h=0,p;e.addListener("keydown",function(t,r){var i=r.keyCode||r.which;if(!c[i]&&!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&!r.altKey){if(e.undoManger.list.length==0||(i==8||i==46)&&p!=i){e.undoManger.save(!0),p=i;return}e.undoManger.list.length==2&&e.undoManger.index==0&&h==0&&(e.undoManger.list.splice(1,1),e.undoManger.update()),p=i,h++,h>=n&&e.selection.getRange().collapsed&&e.undoManger.save()}})},function(){function e(e){var t=this.document;if(t.getElementById("baidu_pastebin"))return;var n=this.selection.getRange(),r=n.createBookmark(),i=t.createElement("div");i.id="baidu_pastebin",browser.webkit&&i.appendChild(t.createTextNode(domUtils.fillChar+domUtils.fillChar)),t.body.appendChild(i),r.start.style.display="",i.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(r.start).y+"px",n.selectNodeContents(i).select(!0),setTimeout(function(){if(browser.webkit)for(var s=0,o=t.querySelectorAll("#baidu_pastebin"),u;u=o[s++];){if(!domUtils.isEmptyNode(u)){i=u;break}domUtils.remove(u)}try{i.parentNode.removeChild(i)}catch(a){}n.moveToBookmark(r).select(!0),e(i)},0)}UE.plugins.paste=function(){function s(e){var s;if(e.firstChild){var o=domUtils.getElementsByTagName(e,"span");for(var u=0,a;a=o[u++];)(a.id=="_baidu_cut_start"||a.id=="_baidu_cut_end")&&domUtils.remove(a);if(browser.webkit){var f=e.querySelectorAll("div br");for(var u=0,l;l=f[u++];){var c=l.parentNode;c.tagName=="DIV"&&c.childNodes.length==1&&(c.innerHTML="<p><br/></p>",domUtils.remove(c))}var h=e.querySelectorAll("#baidu_pastebin");for(var u=0,p;p=h[u++];){var d=t.document.createElement("p");p.parentNode.insertBefore(d,p);while(p.firstChild)d.appendChild(p.firstChild);domUtils.remove(p)}var v=e.querySelectorAll("meta");for(var u=0,m;m=v[u++];)domUtils.remove(m);var f=e.querySelectorAll("br");for(u=0;m=f[u++];)/^apple-/.test(m)&&domUtils.remove(m)}if(browser.gecko){var g=e.querySelectorAll("[_moz_dirty]");for(u=0;m=g[u++];)m.removeAttribute("_moz_dirty")}if(!browser.ie){var y=e.querySelectorAll("span.apple-style-span");for(var u=0,m;m=y[u++];)domUtils.remove(m,!0)}s=e.innerHTML;var b=t.serialize;if(b)try{var w=b.transformInput(b.parseHTML(b.word(s)),n);w=b.filter(w,r?{whiteList:{p:{br:1,BR:1,$:{}},br:{$:{}},div:{br:1,BR:1,$:{}},li:{$:{}},tr:{td:1,$:{}},td:{$:{}}},blackList:{style:1,script:1,object:1}}:null,r?null:i);if(browser.webkit){var E=w.children.length,S;while((S=w.children[E-1])&&S.tag=="br")w.children.splice(E-1,1),E=w.children.length}s=b.toHTML(w,r)}catch(x){}s={html:s},t.fireEvent("beforepaste",s),t.execCommand("insertHtml",s.html,!0),t.fireEvent("afterpaste")}}var t=this,n={flag:""},r=t.options.pasteplain===!0,i={flag:""};t.commands.pasteplain={queryCommandState:function(){return r},execCommand:function(){r=!r|0},notNeedUndo:1},t.addListener("ready",function(){domUtils.on(t.body,"cut",function(){var e=t.selection.getRange();!e.collapsed&&t.undoManger&&t.undoManger.save()}),domUtils.on(t.body,browser.ie||browser.opera?"keydown":"paste",function(n){if(!(!browser.ie&&!browser.opera||!!n.ctrlKey&&n.keyCode=="86"))return;e.call(t,function(e){s(e)})})})}}(),UE.plugins.list=function(){function n(e,t,n){var r=e.nextSibling;r&&r.nodeType==1&&r.tagName.toLowerCase()==t&&(domUtils.getStyle(r,"list-style-type")||(t=="ol"?"decimal":"disc"))==n&&(domUtils.moveChild(r,e),r.childNodes.length==0&&domUtils.remove(r));var i=e.previousSibling;i&&i.nodeType==1&&i.tagName.toLowerCase()==t&&(domUtils.getStyle(i,"list-style-type")||(t=="ol"?"decimal":"disc"))==n&&domUtils.moveChild(e,i),e.childNodes.length==0&&domUtils.remove(e)}var e=this,t={TD:1,PRE:1,BLOCKQUOTE:1};e.setOpt({insertorderedlist:{decimal:"","lower-alpha"
:"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:""}}),e.addListener("keydown",function(t,n){function r(){n.preventDefault?n.preventDefault():n.returnValue=!1,e.undoManger&&e.undoManger.save()}var i=n.keyCode||n.which;if(i==13){var s=e.selection.getRange(),o=domUtils.findParentByTagName(s.startContainer,["ol","ul"],!0,function(e){return e.tagName=="TABLE"}),u=domUtils.findParentByTagName(s.endContainer,["ol","ul"],!0,function(e){return e.tagName=="TABLE"});if(o&&u&&o===u){if(!s.collapsed){o=domUtils.findParentByTagName(s.startContainer,"li",!0),u=domUtils.findParentByTagName(s.endContainer,"li",!0);if(!o||!u||o!==u){var a=s.cloneRange(),f=a.collapse(!1).createBookmark();s.deleteContents(),a.moveToBookmark(f);var l=domUtils.findParentByTagName(a.startContainer,"li",!0),c=l.previousSibling,h=l.nextSibling;c&&(l=c,c.firstChild&&domUtils.isBlockElm(c.firstChild)&&(c=c.firstChild),domUtils.isEmptyNode(c)&&domUtils.remove(l)),h&&(l=h,h.firstChild&&domUtils.isBlockElm(h.firstChild)&&(h=h.firstChild),domUtils.isEmptyNode(h)&&domUtils.remove(l)),a.select(),r();return}s.deleteContents(),l=domUtils.findParentByTagName(s.startContainer,"li",!0);if(l&&domUtils.isEmptyBlock(l)){c=l.previousSibling,h=l.nextSibling,v=e.document.createElement("p"),domUtils.fillNode(e.document,v),p=l.parentNode,c&&h?(s.setStart(h,0).collapse(!0).select(!0),domUtils.remove(l)):(!c&&!h||!c?p.parentNode.insertBefore(v,p):l.parentNode.parentNode.insertBefore(v,p.nextSibling),domUtils.remove(l),p.firstChild||domUtils.remove(p),s.setStart(v,0).setCursor()),r();return}}l=domUtils.findParentByTagName(s.startContainer,"li",!0);if(l){if(domUtils.isEmptyBlock(l)){f=s.createBookmark();var p=l.parentNode;l!==p.lastChild?domUtils.breakParent(l,p):(p.parentNode.insertBefore(l,p.nextSibling),domUtils.isEmptyNode(p)&&domUtils.remove(p));if(!dtd.$list[l.parentNode.tagName])if(!domUtils.isBlockElm(l.firstChild)){v=e.document.createElement("p"),l.parentNode.insertBefore(v,l);while(l.firstChild)v.appendChild(l.firstChild);domUtils.remove(l)}else domUtils.remove(l,!0);s.moveToBookmark(f).select()}else{var d=l.firstChild;if(!d||!domUtils.isBlockElm(d)){var v=e.document.createElement("p");!l.firstChild&&domUtils.fillNode(e.document,v);while(l.firstChild)v.appendChild(l.firstChild);l.appendChild(v),d=v}var m=e.document.createElement("span");s.insertNode(m),domUtils.breakParent(m,l);var g=m.nextSibling;d=g.firstChild,d||(v=e.document.createElement("p"),domUtils.fillNode(e.document,v),g.appendChild(v),d=v),domUtils.isEmptyNode(d)&&(d.innerHTML="",domUtils.fillNode(e.document,d)),s.setStart(d,0).collapse(!0).shrinkBoundary().select(),domUtils.remove(m),c=g.previousSibling,c&&domUtils.isEmptyBlock(c)&&(c.innerHTML="<p></p>",domUtils.fillNode(e.document,c.firstChild))}r()}}}if(i==8){s=e.selection.getRange();if(s.collapsed&&domUtils.isStartInblock(s)){a=s.cloneRange().trimBoundary(),l=domUtils.findParentByTagName(s.startContainer,"li",!0);if(l&&domUtils.isStartInblock(a)){if(l&&(c=l.previousSibling)){if(i==46&&l.childNodes.length)return;dtd.$list[c.tagName]&&(c=c.lastChild),e.undoManger&&e.undoManger.save(),d=l.firstChild;if(domUtils.isBlockElm(d))if(domUtils.isEmptyNode(d)){c.appendChild(d),s.setStart(d,0).setCursor(!1,!0);while(l.firstChild)c.appendChild(l.firstChild)}else{o=domUtils.findParentByTagName(s.startContainer,"p",!0);if(o&&o!==d)return;m=e.document.createElement("span"),s.insertNode(m),domUtils.isEmptyBlock(c)&&(c.innerHTML=""),domUtils.moveChild(l,c),s.setStartBefore(m).collapse(!0).select(!0),domUtils.remove(m)}else if(domUtils.isEmptyNode(l)){var v=e.document.createElement("p");c.appendChild(v),s.setStart(v,0).setCursor()}else{s.setEnd(c,c.childNodes.length).collapse().select(!0);while(l.firstChild)c.appendChild(l.firstChild)}domUtils.remove(l),e.undoManger&&e.undoManger.save(),domUtils.preventDefault(n);return}if(l&&!l.previousSibling){d=l.firstChild;if(!d||l.lastChild===d&&domUtils.isEmptyNode(domUtils.isBlockElm(d)?d:l)){var v=e.document.createElement("p");l.parentNode.parentNode.insertBefore(v,l.parentNode),domUtils.fillNode(e.document,v),s.setStart(v,0).setCursor(),domUtils.remove(l.nextSibling?l:l.parentNode),e.undoManger&&e.undoManger.save(),domUtils.preventDefault(n);return}}}}}}),e.commands.insertorderedlist=e.commands.insertunorderedlist={execCommand:function(e,r){r||(r=e.toLowerCase()=="insertorderedlist"?"decimal":"disc");var i=this,s=this.selection.getRange(),o=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br":!domUtils.isWhitespace(e)},u=e.toLowerCase()=="insertorderedlist"?"ol":"ul",a=i.document.createDocumentFragment();s.adjustmentBoundary().shrinkBoundary();var f=s.createBookmark(!0),l=domUtils.findParentByTagName(i.document.getElementById(f.start),"li"),c=0,h=domUtils.findParentByTagName(i.document.getElementById(f.end),"li"),p=0,d,v,m,g;if(l||h){l&&(d=l.parentNode),f.end||(h=l),h&&(v=h.parentNode);if(d===v){while(l!==h){g=l,l=l.nextSibling;if(!domUtils.isBlockElm(g.firstChild)){var y=i.document.createElement("p");while(g.firstChild)y.appendChild(g.firstChild);g.appendChild(y)}a.appendChild(g)}g=i.document.createElement("span"),d.insertBefore(g,h);if(!domUtils.isBlockElm(h.firstChild)){y=i.document.createElement("p");while(h.firstChild)y.appendChild(h.firstChild);h.appendChild(y)}a.appendChild(h),domUtils.breakParent(g,d),domUtils.isEmptyNode(g.previousSibling)&&domUtils.remove(g.previousSibling),domUtils.isEmptyNode(g.nextSibling)&&domUtils.remove(g.nextSibling);var b=domUtils.getComputedStyle(d,"list-style-type")||(e.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(d.tagName.toLowerCase()==u&&b==r){for(var w=0,E,S=i.document.createDocumentFragment();E=a.childNodes[w++];)while(E.firstChild)S.appendChild(E.firstChild);g.parentNode.insertBefore(S,g)}else m=i.document.createElement(u),domUtils.setStyle(m,"list-style-type",r),m.appendChild(a),g.parentNode.insertBefore(m,g);domUtils.remove(g),m&&n(m,u,r),s.moveToBookmark(f).select();return}if(l){while(l){g=l.nextSibling;var x=i.document.createDocumentFragment(),T=0;while(l.firstChild)domUtils.isBlockElm(l.firstChild)&&(T=1),x.appendChild(l.firstChild);if(!T){var N=i.document.createElement("p");N.appendChild(x),a.appendChild(N)}else a.appendChild(x);domUtils.remove(l),l=g}d.parentNode.insertBefore(a,d.nextSibling),domUtils.isEmptyNode(d)?(s.setStartBefore(d),domUtils.remove(d)):s.setStartAfter(d),c=1}if(h){l=v.firstChild;while(l!==h){g=l.nextSibling,x=i.document.createDocumentFragment(),T=0;while(l.firstChild)domUtils.isBlockElm(l.firstChild)&&(T=1),x.appendChild(l.firstChild);T?a.appendChild(x):(N=i.document.createElement("p"),N.appendChild(x),a.appendChild(N)),domUtils.remove(l),l=g}a.appendChild(h.firstChild),domUtils.remove(h),v.parentNode.insertBefore(a,v),s.setEndBefore(v),domUtils.isEmptyNode(v)&&domUtils.remove(v),p=1}}c||s.setStartBefore(i.document.getElementById(f.start)),f.end&&!p&&s.setEndAfter(i.document.getElementById(f.end)),s.enlarge(!0,function(e){return t[e.tagName]}),a=i.document.createDocumentFragment();var C=s.createBookmark(),k=domUtils.getNextDomNode(C.start,!1,o),L=s.cloneRange(),A,O=domUtils.isBlockElm;while(k&&k!==C.end&&domUtils.getPosition(k,C.end)&domUtils.POSITION_PRECEDING)if(k.nodeType==3||dtd.li[k.tagName]){if(k.nodeType==1&&dtd.$list[k.tagName]){while(k.firstChild)a.appendChild(k.firstChild);A=domUtils.getNextDomNode(k,!1,o),domUtils.remove(k),k=A;continue}A=k,L.setStartBefore(k);while(k&&k!==C.end&&(!O(k)||domUtils.isBookmarkNode(k)))A=k,k=domUtils.getNextDomNode(k,!1,null,function(e){return!t[e.tagName]});k&&O(k)&&(g=domUtils.getNextDomNode(A,!1,o),g&&domUtils.isBookmarkNode(g)&&(k=domUtils.getNextDomNode(g,!1,o),A=g)),L.setEndAfter(A),k=domUtils.getNextDomNode(A,!1,o);var M=s.document.createElement("li");M.appendChild(L.extractContents()),a.appendChild(M)}else k=domUtils.getNextDomNode(k,!0,o);s.moveToBookmark(C).collapse(!0),m=i.document.createElement(u),domUtils.setStyle(m,"list-style-type",r),m.appendChild(a),s.insertNode(m),n(m,u,r),s.moveToBookmark(f).select()},queryCommandState:function(e){return this.highlight?-1:utils.findNode(this.selection.getStartElementPath(),[e.toLowerCase()=="insertorderedlist"?"ol":"ul"])?1:0},queryCommandValue:function(e){var t=utils.findNode(this.selection.getStartElementPath(),[e.toLowerCase()=="insertorderedlist"?"ol":"ul"]);return t?domUtils.getComputedStyle(t,"list-style-type"):null}}},function(){function e(e){e=e||{},this.indentChar=e.indentChar||"    ",this.breakChar=e.breakChar||"\n",this.selfClosingEnd=e.selfClosingEnd||" />"}function r(e){var n=[];for(var r in e)n.push(r+'="'+t(e[r])+'"');return n.join(" ")}var t=function(){function t(t){return e[t]}var e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(e){return e+="",e?e.replace(/[<>"']/g,t):""}}(),n=utils.extend({a:1,A:1},dtd.$inline,!0);e.prototype={format:function(e){var t=UE.serialize.parseHTML(e);return this.buff=[],this.indents="",this.indenting=1,this.visitNode(t),this.buff.join("")},visitNode:function(e){if(e.type=="fragment")this.visitChildren(e.children);else if(e.type=="element"){var t=dtd.$empty[e.tag];this.visitTag(e.tag,e.attributes,t),this.visitChildren(e.children),t||this.visitEndTag(e.tag)}else e.type=="comment"?this.visitComment(e.data):this.visitText(e.data,dtd.$notTransContent[e.parent.tag])},visitChildren:function(e){for(var t=0;t<e.length;t++)this.visitNode(e[t])},visitTag:function(e,t,i){this.indenting?this.indent():n[e]||(this.newline(),this.indent()),this.buff.push("<",e);var s=r(t);s&&this.buff.push(" ",s),i?(this.buff.push(this.selfClosingEnd),e=="br"&&this.newline()):(this.buff.push(">"),this.indents+=this.indentChar),n[e]||this.newline()},indent:function(){this.buff.push(this.indents),this.indenting=0},newline:function(){this.buff.push(this.breakChar),this.indenting=1},visitEndTag:function(e){this.indents=this.indents.slice(0,-this.indentChar.length),this.indenting?this.indent():n[e]||(this.newline(),this.indent()),this.buff.push("</",e,">")},visitText:function(e,t){this.indenting&&this.indent(),e=e.replace(/&nbsp;/g," "),this.buff.push(e)},visitComment:function(e){this.indenting&&this.indent(),this.buff.push("<!--",e,"-->")}};var i={textarea:function(e,t){var n=t.ownerDocument.createElement("textarea");return n.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",browser.ie&&browser.version<8&&(n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px",t.onresize=function(){n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px"}),t.appendChild(n),{setContent:function(e){n.value=e},getContent:function(){return n.value},select:function(){var e;browser.ie?(e=n.createTextRange(),e.collapse(!0),e.select()):(n.setSelectionRange(0,0),n.focus())},dispose:function(){t.removeChild(n),t.onresize=null,n=null,t=null}}},codemirror:function(e,t){var n={mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0},r=window.CodeMirror(t,n),i=r.getWrapperElement();return i.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',r.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",r.refresh(),{setContent:function(e){r.setValue(e)},getContent:function(){return r.getValue()},select:function(){r.focus()},dispose:function(){t.removeChild(i),i=null,r=null}}}};UE.plugins.source=function(){function u(e){return i[n.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](t,e)}var t=this,n=this.options,r=new e(n.source),s=!1,o;n.sourceEditor=n.sourceEditor||"codemirror",t.setOpt({sourceEditorFirst:!1});var a;t.commands.source={execCommand:function(){s=!s;if(s){t.undoManger&&t.undoManger.save(),this.currentSelectedArr&&domUtils.clearSelectedArr(this.currentSelectedArr),browser.gecko&&(t.body.contentEditable=!1),a=t.iframe.style.cssText,t.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var e=r.format(t.hasContents()?t.getContent():"");o=u(t.iframe.parentNode),o.setContent(e),setTimeout(function(){o.select()})}else{t.iframe.style.cssText=a;var n=o.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";n=n.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),t.setContent(n),o.dispose(),o=null,setTimeout(function(){var e=t.body.firstChild;e||(t.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",e=t.body.firstChild),t.undoManger&&t.undoManger.save();while(e&&e.firstChild)e=e.firstChild;var n=t.selection.getRange();e.nodeType==3||dtd.$empty[e.tagName]?n.setStartBefore(e):n.setStart(e,0);if(browser.gecko){var r=document.createElement("input");r.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(r),t.body.contentEditable=!1,setTimeout(function(){domUtils.setViewportOffset(r,{left:-32768,top:0}),r.focus(),setTimeout(function(){t.body.contentEditable=!0,n.setCursor(!1,!0),domUtils.remove(r)})})}else n.setCursor(!1,!0)})}this.fireEvent("sourcemodechanged",s)},queryCommandState:function(){return s|0},notNeedUndo:1};var f=t.queryCommandState;t.queryCommandState=function(e){return e=e.toLowerCase(),s?e=="source"?1:-1:f.apply(this,arguments)};var l=t.getContent;t.getContent=function(){if(s&&o){var e=o.getContent();if(this.serialize){var t=this.serialize.parseHTML(e);t=this.serialize.filter(t),e=this.serialize.toHTML(t)}return e}return l.apply(this,arguments)},n.sourceEditor=="codemirror"&&t.addListener("ready",function(){utils.loadFile(document,{src:n.codeMirrorJsUrl||n.UEDITOR_HOME_URL+"third-party/codemirror2.15/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){n.sourceEditorFirst&&setTimeout(function(){t.execCommand("source")},0)}),utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:n.codeMirrorCssUrl||n.UEDITOR_HOME_URL+"third-party/codemirror2.15/codemirror.css"})})}}(),UE.plugins.shortcutkeys=function(){var e=this,t={"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll","ctrl+13":"autosubmit"};e.addListener("keydown",function(n,r){var i=r.keyCode||r.which,s;for(var o in t)if(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o))if((RegExp.$1=="ctrl"?r.ctrlKey||r.metaKey||browser.opera&&i==17:0)&&(RegExp.$2!=""?r[RegExp.$2.slice(1)+"Key"]:1)&&i==RegExp.$3||i==RegExp.$1)s=t[o].split(":"),e.execCommand(s[0],s[1]),domUtils.preventDefault(r)})},UE.plugins.enterkey=function(){var e,t=this,n=t.options.enterTag;t.addListener("keyup",function(n,r){var i=r.keyCode||r.which;if(i==13){var s=t.selection.getRange(),o=s.startContainer,u;if(!browser.ie){if(/h\d/i.test(e)){if(browser.gecko){var a=domUtils.findParentByTagName(o,["h1","h2","h3","h4","h5","h6","blockquote"],!0);a||(t.document.execCommand("formatBlock",!1,"<p>"),u=1)}else if(o.nodeType==1){var f=t.document.createTextNode(""),l;s.insertNode(f),l=domUtils.findParentByTagName(f,"div",!0);if(l){var c=t.document.createElement("p");while(l.firstChild)c.appendChild(l.firstChild);l.parentNode.insertBefore(c,l),domUtils.remove(l),s.setStartBefore(f).setCursor(),u=1}domUtils.remove(f)}t.undoManger&&u&&t.undoManger.save()}browser.opera&&s.select()}setTimeout(function(){t.selection.getRange().scrollToView(t.autoHeightEnabled,t.autoHeightEnabled?domUtils.getXY(t.iframe).y:0)},50)}}),t.addListener("keydown",function(r,i){var s=i.keyCode||i.which;if(s==13){t.undoManger&&t.undoManger.save(),e="";var o=t.selection.getRange();if(!o.collapsed){var u=o.startContainer,a=o.endContainer,f=domUtils.findParentByTagName(u,"td",!0),l=domUtils.findParentByTagName(a,"td",!0);if(f&&l&&f!==l||!f&&l||f&&!l){i.preventDefault?i.preventDefault():i.returnValue=!1;return}}t.currentSelectedArr&&domUtils.clearSelectedArr(t.currentSelectedArr);if(n=="p")browser.ie||(u=domUtils.findParentByTagName(o.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote"],!0),!u&&!browser.opera?(t.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(o=t.selection.getRange(),u=domUtils.findParentByTagName(o.startContainer,"p",!0),u&&domUtils.removeDirtyAttr(u))):(e=u.tagName,u.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(u)));else{i.preventDefault?i.preventDefault():i.returnValue=!1;if(!o.collapsed){o.deleteContents(),u=o.startContainer;if(u.nodeType==1&&(u=u.childNodes[o.startOffset])){while(u.nodeType==1){if(dtd.$empty[u.tagName])return o.setStartBefore(u).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!u.firstChild){var c=o.document.createElement("br");return u.appendChild(c),o.setStart(u,0).setCursor(),t.undoManger&&t.undoManger.save(),!1}u=u.firstChild}u===o.startContainer.childNodes[o.startOffset]?(c=o.document.createElement("br"),o.insertNode(c).setCursor()):o.setStart(u,0).setCursor()}else c=o.document.createElement("br"),o.insertNode(c).setStartAfter(c).setCursor()}else{c=o.document.createElement("br"),o.insertNode(c);var h=c.parentNode;h.lastChild===c?(c.parentNode.insertBefore(c.cloneNode(!0),c),o.setStartBefore(c)):o.setStartAfter(c),o.setCursor()}}}})},UE.plugins.keystrokes=function(){var e=this,t=0,n=domUtils.keys,r={B:"strong",I:"em",FONT:"span"},i=[0,10,12,16,18,24,32,48],s={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};e.addListener("keydown",function(n,r){var i=r.keyCode||r.which;if(this.selectAll){this.selectAll=!1;if(i==8||i==46){e.undoManger&&e.undoManger.save(),e.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",(new dom.Range(e.document)).setStart(e.body.firstChild,0).setCursor(!1,!0),e.undoManger&&e.undoManger.save(),browser.ie&&e._selectionChange(),domUtils.preventDefault(r);return}}if(i==8){var o=e.selection.getRange(),u,a,f;if(o.collapsed){a=o.startContainer,domUtils.isWhitespace(a)&&(a=a.parentNode);if(domUtils.isEmptyNode(a)&&a===e.body.firstChild){a.tagName!="P"&&(p=e.document.createElement("p"),e.body.insertBefore(p,a),domUtils.fillNode(e.document,p),o.setStart(p,0).setCursor(!1,!0),domUtils.remove(a)),domUtils.preventDefault(r);return}}o.collapsed&&o.startContainer.nodeType==3&&o.startContainer.nodeValue.replace(new RegExp(domUtils.fillChar,"g"),"").length==0&&o.setStartBefore(o.startContainer).collapse(!0);if(a=o.getClosedNode()){e.undoManger&&e.undoManger.save(),o.setStartBefore(a),domUtils.remove(a),o.setCursor(),e.undoManger&&e.undoManger.save(),domUtils.preventDefault(r);return}if(!browser.ie){a=domUtils.findParentByTagName(o.startContainer,"table",!0),f=domUtils.findParentByTagName(o.endContainer,"table",!0);if(a&&!f||!a&&f||a!==f){r.preventDefault();return}}e.undoManger&&(o.collapsed||(e.undoManger.save(),t=1))}if(i==9){o=e.selection.getRange(),e.undoManger&&e.undoManger.save();for(var l=0,c="",h=e.options.tabSize||4,d=e.options.tabNode||"&nbsp;";l<h;l++)c+=d;var v=e.document.createElement("span");v.innerHTML=c;if(o.collapsed){var m=domUtils.findParentByTagName(o.startContainer,"li",!0);if(m&&domUtils.isStartInblock(o)){w=o.createBookmark();var g=m.parentNode,y=e.document.createElement(g.tagName),b=utils.indexOf(s[y.tagName],domUtils.getComputedStyle(g,"list-style-type"));b=b+1==s[y.tagName].length?0:b+1,domUtils.setStyle(y,"list-style-type",s[y.tagName][b]),g.insertBefore(y,m),y.appendChild(m),o.moveToBookmark(w).select()}else o.insertNode(v.cloneNode(!0).firstChild).setCursor(!0)}else{a=domUtils.findParentByTagName(o.startContainer,"table",!0),f=domUtils.findParentByTagName(o.endContainer,"table",!0);if(a||f){r.preventDefault?r.preventDefault():r.returnValue=!1;return}a=domUtils.findParentByTagName(o.startContainer,["ol","ul"],!0),f=domUtils.findParentByTagName(o.endContainer,["ol","ul"],!0);if(a&&f&&a===f){var w=o.createBookmark();a=domUtils.findParentByTagName(o.startContainer,"li",!0),f=domUtils.findParentByTagName(o.endContainer,"li",!0);if(a===a.parentNode.firstChild){var E=e.document.createElement(a.parentNode.tagName);a.parentNode.parentNode.insertBefore(E,a.parentNode),E.appendChild(a.parentNode)}else{g=a.parentNode,y=e.document.createElement(g.tagName),b=utils.indexOf(s[y.tagName],domUtils.getComputedStyle(g,"list-style-type")),b=b+1==s[y.tagName].length?0:b+1,domUtils.setStyle(y,"list-style-type",s[y.tagName][b]),a.parentNode.insertBefore(y,a);var S;while(a!==f)S=a.nextSibling,y.appendChild(a),a=S;y.appendChild(f)}o.moveToBookmark(w).select()}else{if(a||f){r.preventDefault?r.preventDefault():r.returnValue=!1;return}a=domUtils.findParent(o.startContainer,T),f=domUtils.findParent(o.endContainer,T);if(a&&f&&a===f)o.deleteContents(),o.insertNode(v.cloneNode(!0).firstChild).setCursor(!0);else{var x=o.createBookmark(),T=function(e){return domUtils.isBlockElm(e)};o.enlarge(!0);var N=o.createBookmark(),C=domUtils.getNextDomNode(N.start,!1,T);while(C&&!(domUtils.getPosition(C,N.end)&domUtils.POSITION_FOLLOWING))C.insertBefore(v.cloneNode(!0).firstChild,C.firstChild),C=domUtils.getNextDomNode(C,!1,T);o.moveToBookmark(N).moveToBookmark(x).select()}}}e.undoManger&&e.undoManger.save(),r.preventDefault?r.preventDefault():r.returnValue=!1}if(browser.gecko&&i==46){o=e.selection.getRange();if(o.collapsed){a=o.startContainer;if(domUtils.isEmptyBlock(a)){var k=a.parentNode;while(domUtils.getChildCount(k)==1&&!domUtils.isBody(k))a=k,k=k.parentNode;a===k.lastChild&&r.preventDefault();return}}}}),e.addListener("keyup",function(s,o){var u=o.keyCode||o.which;if(!browser.gecko&&!n[u]&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey){v=e.selection.getRange();if(v.collapsed){var a=v.startContainer,f=0;while(!domUtils.isBlockElm(a)){if(a.nodeType==1&&utils.indexOf(["FONT","B","I"],a.tagName)!=-1){var l=e.document.createElement(r[a.tagName]);a.tagName=="FONT"&&(l.style.cssText=(a.getAttribute("size")?"font-size:"+(i[a.getAttribute("size")]||12)+"px":"")+";"+(a.getAttribute("color")?"color:"+a.getAttribute("color"):"")+";"+(a.getAttribute("face")?"font-family:"+a.getAttribute("face"):"")+";"+a.style.cssText);while(a.firstChild)l.appendChild(a.firstChild);a.parentNode.insertBefore(l,a),domUtils.remove(a),f||v.setEnd(l,l.childNodes.length).collapse(!0),a=l,f=1}a=a.parentNode}f&&v.select()}}if(u==8){if(browser.gecko)for(var c=0,h,p=domUtils.getElementsByTagName(this.body,"li");h=p[c++];)if(domUtils.isEmptyNode(h)&&!h.previousSibling){var d=h.parentNode;domUtils.remove(h),domUtils.isEmptyNode(d)&&domUtils.remove(d)}var v,a,m,g=this.currentSelectedArr;if(g&&g.length>0){for(var c=0,y;y=g[c++];)y.innerHTML=browser.ie?browser.version<9?"&#65279":"":"<br/>";v=new dom.Range(this.document),v.setStart(g[0],0).setCursor(),t&&(e.undoManger.save(),t=0),browser.webkit&&o.preventDefault();return}v=e.selection.getRange(),a=v.startContainer,domUtils.isWhitespace(a)&&(a=a.parentNode);var b=0;while(a.nodeType==1&&domUtils.isEmptyNode(a)&&dtd.$removeEmpty[a.tagName])b=1,m=a.parentNode,domUtils.remove(a),a=m;if(b&&a.nodeType==1&&domUtils.isEmptyNode(a)){if(browser.ie){var w=v.document.createElement("span");a.appendChild(w),v.setStart(a,0).setCursor(),h=domUtils.findParentByTagName(a,"li",!0);if(h){var E=h.nextSibling;while(E){if(domUtils.isEmptyBlock(E)){h=E,E=E.nextSibling,domUtils.remove(h);continue}break}}}else a.innerHTML="<br/>",v.setStart(a,0).setCursor(!1,!0);setTimeout(function(){browser.ie&&domUtils.remove(w),t&&(e.undoManger.save(),t=0)},0)}else t&&(e.undoManger.save(),t=0)}})},UE.plugins.fiximgclick=function(){var e=this;browser.webkit&&e.addListener("click",function(t,n){if(n.target.tagName=="IMG"){var r=new dom.Range(e.document);r.selectNode(n.target).select()}})},UE.plugins.autolink=function(){var e=0;if(browser.ie)return;var t=this;t.addListener("reset",function(){e=0}),t.addListener("keydown",function(e,n){var r=n.keyCode||n.which;if(r==32||r==13){var i=t.selection.getNative(),s=i.getRangeAt(0).cloneRange(),o,u,a=s.startContainer;while(a.nodeType==1&&s.startOffset>0){a=s.startContainer.childNodes[s.startOffset-1];if(!a)break;s.setStart(a,a.nodeType==1?a.childNodes.length:a.nodeValue.length),s.collapse(!0),a=s.startContainer}do{if(s.startOffset==0){a=s.startContainer.previousSibling;while(a&&a.nodeType==1)a=a.lastChild;if(!a||domUtils.isFillChar(a))break;o=a.nodeValue.length}else a=s.startContainer,o=s.startOffset;s.setStart(a,o-1),u=s.toString().charCodeAt(0)}while(u!=160&&u!=32);if(s.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(s.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(s.toString()))break;try{s.setStart(s.startContainer,s.startOffset+1)}catch(f){var a=s.startContainer;while(!(next=a.nextSibling)){if(domUtils.isBody(a))return;a=a.parentNode}s.setStart(next,0)}}var l=t.document.createElement("a"),c=t.document.createTextNode(" "),h;t.undoManger&&t.undoManger.save(),l.appendChild(s.extractContents()),l.href=l.innerHTML=l.innerHTML.replace(/<[^>]+>/g,""),h=l.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),""),h=/^(?:https?:\/\/)/ig.test(h)?h:"http://"+h,l.setAttribute("data_ue_src",h),l.href=h,s.insertNode(l),l.parentNode.insertBefore(c,l.nextSibling),s.setStart(c,0),s.collapse(!0),i.removeAllRanges(),i.addRange(s),t.undoManger&&t.undoManger.save()}}})},UE.plugins.autoheight=function(){function u(){clearTimeout(o),o=setTimeout(function(){e.queryCommandState("source")!=1&&(n||(n=e.document.createElement("span"),n.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",n.innerHTML="."),r=n.cloneNode(!0),e.body.appendChild(r),s=Math.max(domUtils.getXY(r).y+r.offsetHeight,e.options.minFrameHeight),s!=i&&(e.setHeight(s),i=s),domUtils.remove(r))},50)}var e=this;e.autoHeightEnabled=e.options.autoHeightEnabled!==!1;if(!e.autoHeightEnabled)return;var t,n,r,i=0,s,o;e.addListener("destroy",function(){e.removeListener("contentchange",u),e.removeListener("keyup",u),e.removeListener("mouseup",u)}),e.enableAutoHeight=function(){if(!e.autoHeightEnabled)return;var n=e.document;e.autoHeightEnabled=!0,t=n.body.style.overflowY,n.body.style.overflowY="hidden",e.addListener("contentchange",u),e.addListener("keyup",u),e.addListener("mouseup",u),setTimeout(function(){u()},browser.gecko?100:0),e.fireEvent("autoheightchanged",e.autoHeightEnabled)},e.disableAutoHeight=function(){e.body.style.overflowY=t||"",e.removeListener("contentchange",u),e.removeListener("keyup",u),e.removeListener("mouseup",u),e.autoHeightEnabled=!1,e.fireEvent("autoheightchanged",e.autoHeightEnabled)},e.addListener("ready",function(){e.enableAutoHeight();var t;domUtils.on(browser.ie?e.body:e.document,browser.webkit?"dragover":"drop",function(){clearTimeout(t),t=setTimeout(function(){u()},100)})})},UE.plugins.autofloat=function(){function u(e){return e.ui?1:(alert(t.autofloatMsg),0)}function a(){var e=document.body.style;e.backgroundImage='url("about:blank")',e.backgroundAttachment="fixed"}function v(){var t=domUtils.getXY(c),n=domUtils.getComputedStyle(c,"position"),i=domUtils.getComputedStyle(c,"left");c.style.width=c.offsetWidth+"px",c.style.zIndex=e.options.zIndex*1+1,c.parentNode.insertBefore(l,c),s||o&&browser.ie?(c.style.position!="absolute"&&(c.style.position="absolute"),c.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-h+r+"px"):(browser.ie7Compat&&d&&(d=!1,c.style.left=domUtils.getXY(c).x-document.documentElement.getBoundingClientRect().left+2+"px"),c.style.position!="fixed"&&(c.style.position="fixed",c.style.top=r+"px",(n=="absolute"||n=="relative")&&parseFloat(i)&&(c.style.left=t.x+"px")))}function m(){d=!0,l.parentNode&&l.parentNode.removeChild(l),c.style.cssText=f}function g(){var t=p(e.container);t.top<0&&t.bottom-c.offsetHeight>0?v():m()}var e=this,t=e.getLang();e.setOpt({topOffset:0});var n=e.options.autoFloatEnabled!==!1,r=e.options.topOffset;if(!n)return;var i=UE.ui.uiUtils,s=browser.ie&&browser.version<=6,o=browser.quirks,f,l=document.createElement("div"),c,h,p,d=!0,y=utils.defer(function(){g()},browser.ie?200:100,!0);e.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],g),e.removeListener("keydown",y)}),e.addListener("ready",function(){u(e)&&(p=i.getClientRect,c=e.ui.getDom("toolbarbox"),h=p(c).top,f=c.style.cssText,l.style.height=c.offsetHeight+"px",s&&a(),e.addListener("autoheightchanged",function(t,n){n?(domUtils.on(window,["scroll","resize"],g),e.addListener("keydown",y)):(domUtils.un(window,["scroll","resize"],g),e.removeListener("keydown",y))}),e.addListener("beforefullscreenchange",function(e,t){t&&m()}),e.addListener("fullscreenchanged",function(e,t){t||g()}),e.addListener("sourcemodechanged",function(e,t){setTimeout(function(){g()},0)}))})},UE.plugins.highlightcode=function(){function t(){setTimeout(function(){var t=e.document.getElementById(SyntaxHighlighter.getHighlighterDivId());if(t){var n=t.getElementsByTagName("td");for(var r=0,i,s;i=n[0].childNodes[r];r++)s=n[1].firstChild.childNodes[r],s&&(s.style.height=i.style.height=s.offsetHeight+"px")}})}function n(){for(var n=0,r,i=domUtils.getElementsByTagName(e.document,"pre");r=i[n++];)if(r.className.indexOf("brush")>-1){var s=document.createElement("pre"),o,u;s.className=r.className,s.style.display="none",s.appendChild(document.createTextNode(r[browser.ie?"innerText":"textContent"])),document.body.appendChild(s);try{o=SyntaxHighlighter.highlight(s,null,!0)}catch(a){domUtils.remove(s);return}u=e.document.createElement("div"),u.innerHTML=o,u.firstChild.setAttribute("highlighter",s.className),r.parentNode.insertBefore(u.firstChild,r),domUtils.remove(s),domUtils.remove(r),t()}}var e=this;if(!/highlightcode/i.test(e.options.toolbars.join("")))return;e.commands.highlightcode={execCommand:function(n,r,i){if(r&&i){var s=document.createElement("pre");s.className="brush: "+i+";toolbar:false;",s.style.display="",s.appendChild(document.createTextNode(r)),document.body.appendChild(s),e.queryCommandState("highlightcode")&&e.execCommand("highlightcode"),e.execCommand("inserthtml",SyntaxHighlighter.highlight(s,null,!0),!0);var o=e.document.getElementById(SyntaxHighlighter.getHighlighterDivId());o.setAttribute("highlighter",s.className),domUtils.remove(s),t()}else{var u=this.selection.getRange(),a=domUtils.findParentByTagName(u.startContainer,"table",!0),f=domUtils.findParentByTagName(u.endContainer,"table",!0),l;if(a&&f&&a===f&&a.parentNode.className.indexOf("syntaxhighlighter")>-1){l=a.parentNode;if(domUtils.isBody(l.parentNode)){var c=e.document.createElement("p");c.innerHTML=browser.ie?"":"<br/>",e.body.insertBefore(c,l),u.setStart(c,0)}else u.setStartBefore(l);u.setCursor(),domUtils.remove(l)}}},queryCommandState:function(){var e=this.selection.getRange(),t,n;return e.adjustmentBoundary(),t=domUtils.findParent(e.startContainer,function(e){return e.nodeType==1&&e.tagName=="DIV"&&domUtils.hasClass(e,"syntaxhighlighter")},!0),n=domUtils.findParent(e.endContainer,function(e){return e.nodeType==1&&e.tagName=="DIV"&&domUtils.hasClass(e,"syntaxhighlighter")},!0),t&&n&&t==n?1:0}},e.addListener("beforeselectionchange afterselectionchange",function(t){e.highlight=/^b/.test(t)?e.queryCommandState("highlightcode"):0}),e.addListener("ready",function(){typeof XRegExp=="undefined"&&utils.loadFile(document,{id:"syntaxhighlighter_js",src:e.options.highlightJsUrl||e.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js",tag:"script",type:"text/javascript",defer:"defer"},function(){n()}),e.document.getElementById("syntaxhighlighter_css")||utils.loadFile(e.document,{id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:e.options.highlightCssUrl||e.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css"})}),e.addListener("beforegetcontent",function(){for(var t=0,n,r=domUtils.getElementsByTagName(e.body,"div");n=r[t++];)if(n.className=="container"){var i=n.parentNode;while(i){if(i.tagName=="DIV"&&/highlighter/.test(i.id))break;i=i.parentNode}if(!i)return;var s=e.document.createElement("pre");for(var o=[],u=0,a;a=n.childNodes[u++];)o.push(a[browser.ie?"innerText":"textContent"]);s.appendChild(e.document.createTextNode(o.join("\n"))),s.className=i.getAttribute("highlighter"),i.parentNode.insertBefore(s,i),domUtils.remove(i)}}),e.addListener("aftergetcontent aftersetcontent",n),e.addListener("getAllHtml",function(t,n){var r="";for(var i=0,s,o=domUtils.getElementsByTagName(e.document,"div");s=o[i++];)if(domUtils.hasClass(s,"syntaxhighlighter")){e.document.getElementById("syntaxhighlighter_css")||(r='<link id="syntaxhighlighter_css" rel="stylesheet" type="text/css" href="'+(e.options.highlightCssUrl||e.options.UEDITOR_HOME_URL+'third-party/SyntaxHighlighter/shCoreDefault.css"')+" ></link>"),e.window.XRegExp||(r+='<script id="syntaxhighlighter_js"  type="text/javascript" src="'+(e.options.highlightJsUrl||e.options.UEDITOR_HOME_URL+'third-party/SyntaxHighlighter/shCore.js"'
)+" ></script>"+'<script type="text/javascript">window.onload = function(){SyntaxHighlighter.highlight();'+"setTimeout(function(){"+"for(var i=0,di;di=SyntaxHighlighter.highlightContainers[i++];){"+'var tds = di.getElementsByTagName("td");'+"for(var j=0,li,ri;li=tds[0].childNodes[j];j++){"+"ri = tds[1].firstChild.childNodes[j];"+'ri.style.height = li.style.height = ri.offsetHeight + "px";'+"}"+"}},100)}</script>");break}if(!r){var u;(u=e.document.getElementById("syntaxhighlighter_css"))&&domUtils.remove(u),(u=e.document.getElementById("syntaxhighlighter_js"))&&domUtils.remove(u)}n.html=r}),e.addListener("fullscreenchanged",function(){var t=domUtils.getElementsByTagName(e.document,"div");for(var n=0,r;r=t[n++];)if(/^highlighter/.test(r.id)){var i=r.getElementsByTagName("td");for(var s=0,o,u;o=i[0].childNodes[s];s++)u=i[1].firstChild.childNodes[s],u.style.height=o.style.height=u.offsetHeight+"px"}})},UE.plugins.serialize=function(){function n(e){return/pt/.test(e)?e.replace(/([\d.]+)pt/g,function(e){return Math.round(parseFloat(e)*96/72)+"px"}):e}function v(e,t){var n=[0,10,12,16,18,24,32,48],s,o=utils.indexOf;switch(e.tag){case"script":e.tag="div",e.attributes._ue_div_script=1,e.attributes._ue_script_data=e.children[0]?encodeURIComponent(e.children[0].data):"",e.attributes._ue_custom_node_=1,e.children=[];break;case"style":e.tag="div",e.attributes._ue_div_style=1,e.attributes._ue_style_data=e.children[0]?encodeURIComponent(e.children[0].data):"",e.attributes._ue_custom_node_=1,e.children=[];break;case"img":if(e.attributes.src&&/^data:/.test(e.attributes.src))return{type:"fragment",children:[]};if(e.attributes.src&&/^(?:file)/.test(e.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(e.attributes.src))return{type:"fragment",children:[]};e.attributes.word_img=e.attributes.src,e.attributes.src=r.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";var u=parseInt(e.attributes.width)<128||parseInt(e.attributes.height)<43;e.attributes.style="background:url("+(u?r.options.UEDITOR_HOME_URL+"themes/default/images/word.gif":r.options.langPath+r.options.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd",t&&(t.flag=1)}browser.ie&&browser.version<7&&(e.attributes.orgSrc=e.attributes.src),e.attributes.data_ue_src=e.attributes.data_ue_src||e.attributes.src;break;case"li":var a=e.children[0];if(!a||a.type!="element"||a.tag!="p"&&dtd.p[a.tag]){var f={type:"element",tag:"p",attributes:{},parent:e};f.children=a?e.children:[browser.ie?{type:"text",data:domUtils.fillChar,parent:f}:{type:"element",tag:"br",attributes:{},closed:!0,children:[],parent:f}],e.children=[f]}break;case"table":case"td":m(e);break;case"a":e.attributes.anchorname&&(e.tag="img",e.attributes={"class":"anchorclass",anchorname:e.attributes.name},e.closed=1),e.attributes.href&&(e.attributes.data_ue_src=e.attributes.href);break;case"b":e.tag=e.name="strong";break;case"i":e.tag=e.name="em";break;case"u":e.tag=e.name="span",e.attributes.style=(e.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":e.tag=e.name="span",e.attributes.style=(e.attributes.style||"")+";text-decoration:line-through;",e.children.length==1&&(a=e.children[0],a.tag==e.tag&&(e.attributes.style+=";"+a.attributes.style,e.children=a.children));break;case"span":var l=e.attributes.style;l&&(!e.attributes.style||browser.webkit&&l=="white-space:nowrap;")&&delete e.attributes.style;if(browser.gecko&&browser.version<=10902&&e.parent){var c=e.parent;c.tag=="span"&&c.attributes&&c.attributes.style&&(e.attributes.style=c.attributes.style+";"+e.attributes.style)}utils.isEmptyObject(e.attributes)&&i&&(e.type="fragment");break;case"font":e.tag=e.name="span",s=e.attributes,e.attributes={style:(s.size?"font-size:"+(n[s.size]||12)+"px":"")+";"+(s.color?"color:"+s.color:"")+";"+(s.face?"font-family:"+s.face:"")+";"+(s.style||"")};while(e.parent.tag==e.tag&&e.parent.children.length==1)e.attributes.style&&(e.parent.attributes.style?e.parent.attributes.style+=";"+e.attributes.style:e.parent.attributes.style=e.attributes.style),e.parent.children=e.children,e=e.parent;break;case"p":e.attributes.align&&(e.attributes.style=(e.attributes.style||"")+";text-align:"+e.attributes.align+";",delete e.attributes.align)}return e}function m(t){if(e&&t.attributes.style){var n=t.attributes.style;t.attributes.style=n.replace(/;\s*/g,";"),t.attributes.style=t.attributes.style.replace(/^\s*|\s*$/,"")}}function g(t){switch(t.tag){case"div":t.attributes._ue_div_script&&(t.tag="script",t.children=[{type:"cdata",data:t.attributes._ue_script_data?decodeURIComponent(t.attributes._ue_script_data):"",parent:t}],delete t.attributes._ue_div_script,delete t.attributes._ue_script_data,delete t.attributes._ue_custom_node_),t.attributes._ue_div_style&&(t.tag="style",t.children=[{type:"cdata",data:t.attributes._ue_style_data?decodeURIComponent(t.attributes._ue_style_data):"",parent:t}],delete t.attributes._ue_div_style,delete t.attributes._ue_style_data,delete t.attributes._ue_custom_node_);break;case"table":!t.attributes.style&&delete t.attributes.style,e&&t.attributes.style&&m(t),t.attributes["class"]=="noBorderTable"&&delete t.attributes["class"];break;case"td":case"th":if(/display\s*:\s*none/i.test(t.attributes.style))return{type:"fragment",children:[]};if(e&&!t.children.length){var n={type:"text",data:domUtils.fillChar,parent:t};t.children[0]=n}e&&t.attributes.style&&m(t),t.attributes["class"]=="selectTdClass"&&delete t.attributes["class"];break;case"img":t.attributes.anchorname?(t.tag="a",t.attributes={name:t.attributes.anchorname,anchorname:1},t.closed=null):t.attributes.data_ue_src&&(t.attributes.src=t.attributes.data_ue_src,delete t.attributes.data_ue_src);break;case"a":t.attributes.data_ue_src&&(t.attributes.href=t.attributes.data_ue_src,delete t.attributes.data_ue_src)}return t}function y(e,t,n){if(!e.children||!e.children.length)return e;var r=e.children;for(var i=0;i<r.length;i++){var s=t(r[i],n);if(s.type=="fragment"){var o=[i,1];o.push.apply(o,s.children),r.splice.apply(r,o),r.length||(e={type:"fragment",children:[]}),i--}else r[i]=s}return e}function b(e){this.rules=e}var e=browser.ie,t=browser.version,r=this,i=r.options.autoClearEmptyNode,s=dtd.$empty,o=function(){function f(s,u){var a,f=0,l,c;n.exec("");while(a=n.exec(s)){var h=a.index;if(h>f){var p=s.slice(f,h);c?c.push(p):u.onText(p)}f=n.lastIndex;if(l=a[1]){l=l.toLowerCase(),c&&l==c._tag_name&&(u.onCDATA(c.join("")),c=null);if(!c){u.onTagClose(l);continue}}if(c){c.push(a[0]);continue}if(l=a[3]){if(/="/.test(l))continue;l=l.toLowerCase();var d=a[4],v,m={},g=d&&d.slice(-1)=="/";if(d){r.exec("");while(v=r.exec(d)){var y=v[1].toLowerCase(),b=v[2]||v[3]||v[4]||"";!b&&i[y]&&(b=y),y=="style"&&e&&t<=6&&(b=b.replace(/(?!;)\s*([\w-]+):/g,function(e,t){return t.toLowerCase()+":"})),b&&(m[y]=b.replace(/:\s*/g,":"))}}u.onTagOpen(l,m,g),!c&&o[l]&&(c=[],c._tag_name=l);continue}(l=a[2])&&u.onComment(l)}s.length>f&&u.onText(s.slice(f,s.length))}var n=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,r=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,i={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},o={script:1,style:1},u={li:{$:"ul",ul:1,ol:1},dd:{$:"dl",dl:1},dt:{$:"dl",dl:1},option:{$:"select",select:1},td:{$:"tr",tr:1},th:{$:"tr",tr:1},tr:{$:"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{$:"table",table:1,colgroup:1},thead:{$:"table",table:1},tfoot:{$:"table",table:1},col:{$:"colgroup",colgroup:1}},a={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};return function(e,t){function i(e){e.parent=r,r.children.push(e)}function o(e,n){var i=e;if(u[i.tag]){while(u[r.tag]&&u[r.tag][i.tag])r=r.parent;r.tag==i.tag&&(r=r.parent);while(u[i.tag]){if(u[i.tag][r.tag])break;i=i.parent={type:"element",tag:u[i.tag].$,attributes:{},children:[i]}}}if(t)while(dtd[i.tag]&&!(r.tag=="span"?utils.extend(dtd.strong,{a:1,A:1}):dtd[r.tag]||dtd.div)[i.tag]){if(l(r))continue;if(!r.parent)break;r=r.parent}return i.parent=r,r.children.push(i),n&&(r=e),e.attributes.style&&(e.attributes.style=e.attributes.style.toLowerCase()),e}function l(e){var t;return!e.children.length&&(t=a[e.tag])?(o({type:"element",tag:t,attributes:{},children:[]},!0),!0):!1}var n={type:"fragment",parent:null,children:[]},r=n;f(e,{onText:function(e){while(!(dtd[r.tag]||dtd.div)["#"]){if(l(r))continue;r=r.parent}i({type:"text",data:e})},onComment:function(e){i({type:"comment",data:e})},onCDATA:function(e){while(!(dtd[r.tag]||dtd.div)["#"]){if(l(r))continue;r=r.parent}i({type:"cdata",data:e})},onTagOpen:function(e,t,n){n=n||s[e],o({type:"element",tag:e,attributes:t,closed:n,children:[]},!n)},onTagClose:function(e){var t=r;while(t&&e!=t.tag)t=t.parent;if(t){for(var n=r;n!==t.parent;n=n.parent)l(n);r=t.parent}else!dtd.$removeEmpty[e]&&!dtd.$removeEmptyBlock[e]&&e!="embed"&&(t={type:"element",tag:e,attributes:{},children:[]},o(t,!0),l(t),r=t.parent)}});while(r!==n)l(r),r=r.parent;return n}}(),u=function(){function t(t){return e[t]}var e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(e){return e+="",e?e.replace(/[<>"']/g,t):""}}(),a=function(){function e(e,t){var n=e.children,r=[];for(var i=0,s;s=n[i];i++)r.push(a(s,t));return r.join("")}function t(e){var t=[];for(var r in e){var i=e[r];r=="style"&&(i=n(i),/rgba?\s*\([^)]*\)/.test(i)&&(i=i.replace(/rgba?\s*\(([^)]*)\)/g,function(e){return utils.fixColor("color",e)})),e[r]=utils.optCss(i.replace(/windowtext/g,"#000")).replace(/white-space[^;]+;/g,"")),t.push(r+'="'+u(e[r])+'"')}return t.join(" ")}function r(e,t){return t?e.data.replace(/&nbsp;/g," "):u(e.data).replace(/ /g,"&nbsp;")}function f(n,r){if(n.type=="element"&&!n.children.length&&dtd.$removeEmpty[n.tag]&&n.tag!="a"&&utils.isEmptyObject(n.attributes)&&i)return f;var u=n.tag;if(r&&u=="td")f||(f=""),f+=e(n,r)+"&nbsp;&nbsp;&nbsp;";else{var a=t(n.attributes),f="<"+(r&&o[u]?o[u]:u)+(a?" "+a:"")+(s[u]?" />":">");s[u]||(u=="p"&&!n.children.length&&(f+=browser.ie?"&nbsp;":"<br/>"),f+=e(n,r),f+="</"+(r&&o[u]?o[u]:u)+">")}return f}var o={div:"p",li:"p",tr:"p",br:"br",p:"p"};return function(t,n){return t.type=="fragment"?e(t,n):t.type=="element"?f(t,n):t.type=="text"||t.type=="cdata"?r(t,dtd.$notTransContent[t.parent.tag]):t.type=="comment"?"<!--"+t.data+"-->":""}}(),f=function(){function e(e){var t=new RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig);return t.test(e)}function t(e){return e=e.replace(/([\d.]+)([\w]+)?/g,function(e,t,n){return(Math.round(parseFloat(t))||1)+(n||"px")}),e}function r(e){return e=e.replace(/<!--\s*EndFragment\s*-->[\s\S]*$/,"").replace(/^(\r\n|\n|\r)|(\r\n|\n|\r)$/ig,"").replace(/^\s*(&nbsp;)+/ig,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(browser.opera)return"";try{var t=e.match(/width:([ \d.]*p[tx])/i)[1],r=e.match(/height:([ \d.]*p[tx])/i)[1],i=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+n(t)+'" height="'+n(r)+'" src="'+i+'" />'}catch(s){return""}}).replace(/v:\w+=["']?[^'"]+["']?/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"").replace(/<font[^>]*>\s*<\/font>/gi,"").replace(/class\s*=\s*["']?(?:(?:MsoTableGrid)|(?:MsoListParagraph)|(?:MsoNormal(Table)?))\s*["']?/gi,""),e=e.replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,r,i){var s=[],o=0,u=i.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(var o=0;o<u.length;o++){var a=u[o],f,l,c=a.split(":");if(c.length==2){f=c[0].toLowerCase(),l=c[1].toLowerCase();switch(f){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(s[o]=f.replace(/^mso-|-alt$/g,"")+":"+t(l));continue;case"horiz-align":s[o]="text-align:"+l;continue;case"vert-align":s[o]="vertical-align:"+l;continue;case"font-color":case"mso-foreground":s[o]="color:"+l;continue;case"mso-background":case"mso-highlight":s[o]="background:"+l;continue;case"mso-default-height":s[o]="min-height:"+t(l);continue;case"mso-default-width":s[o]="min-width:"+t(l);continue;case"mso-padding-between-alt":s[o]="border-collapse:separate;border-spacing:"+t(l);continue;case"text-line-through":if(l=="single"||l=="double")s[o]="text-decoration:line-through";continue;case"mso-zero-height":l=="yes"&&(s[o]="display:none");continue;case"margin":if(!/[1-9]/.test(c[1]))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(f))continue;if(/text\-indent|padding|margin/.test(f)&&/\-[\d.]+/.test(l))continue;s[o]=f+":"+c[1]}}return o>0?n+' style="'+s.join(";")+'"':n}),e=e.replace(/([ ]+)<\/span>/ig,function(e,t){return(new Array(t.length+1)).join("&nbsp;")+"</span>"}),e}return function(t){return c=null,h="",p="",d="",e(t)&&(t=r(t)),t.replace(/>[ \t\r\n]*</g,"><")}}(),l={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"},c,h="",p="",d;b.prototype={rules:null,filter:function(e,t,n){function s(e,t){e.name=e.type=="element"?e.tag:l[e.type];if(t==null)return y(e,s,e);if(i&&i[e.name])return n&&(n.flag=1),{type:"fragment",children:[]};if(r&&e.type=="element")if(t.type=="fragment"?r[e.name]:r[e.name]&&r[t.name][e.name]){var o;if(o=r[e.name].$){var u=e.attributes,a={};for(var f in o)u[f]&&(a[f]=u[f]);e.attributes=a}}else n&&(n.flag=1),e.type="fragment",e.name=t.name;return(i||r)&&y(e,s,e),e}t=t||this.rules;var r=t&&t.whiteList,i=t&&t.blackList;return s(e,null)},transformInput:function(e,t){function n(e){return e=v(e,t),e=y(e,n,e),r.options.pageBreakTag&&e.type=="text"&&e.data.replace(/\s/g,"")==r.options.pageBreakTag&&(e.type="element",e.name=e.tag="hr",delete e.data,e.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"},e.children=[]),e.type=="text"&&!dtd.$notTransContent[e.parent.tag]&&(e.data=e.data.replace(/[\r\t\n]*/g,"")),e}return n(e)},transformOutput:function(e){function t(e){e.tag=="hr"&&e.attributes["class"]=="pagebreak"&&(delete e.tag,e.type="text",e.data=r.options.pageBreakTag,delete e.children),e=g(e);if(e.tag=="ol"||e.tag=="ul")c=1;e=y(e,t,e);if(e.tag=="ol"||e.tag=="ul")c=0;return e}return t(e)},toHTML:a,parseHTML:o,word:f},r.serialize=new b(r.options.serialize||{}),UE.serialize=new b({})},UE.plugins.video=function(){function n(t,n,r,i,s,o){return s?'<embed type="application/x-shockwave-flash" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+t+'" width="'+n+'" height="'+r+'" align="'+i+'"'+(i!="none"?' style= "'+(i=="center"?"display:block;":" float: "+i)+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':(o?"<p "+(i!="none"?i=="center"?' style="text-align:center;" ':' style="float:"'+i:"")+">":"")+'<img align="'+i+'" width="'+n+'" height="'+r+'" _url="'+t+'" class="edui-faked-video"'+' src="'+e.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+e.options.UEDITOR_HOME_URL+'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;" />'+(o?"</p>":"")}function r(t){var r,i=domUtils.getElementsByTagName(e.document,t?"img":"embed");for(var s=0,o;o=i[s++];){if(o.className!="edui-faked-video")continue;r=e.document.createElement("div");var u=o.style.cssFloat;r.innerHTML=n(t?o.getAttribute("_url"):o.getAttribute("src"),o.width,o.height,u||o.getAttribute("align"),t),o.parentNode.replaceChild(r.firstChild,o)}}var e=this,t;e.addListener("beforegetcontent",function(){r(!0)}),e.addListener("aftersetcontent",function(){r(!1)}),e.addListener("aftergetcontent",function(t){if(t=="aftergetcontent"&&e.queryCommandState("source"))return;r(!1)}),e.commands.insertvideo={execCommand:function(t,r){r=utils.isArray(r)?r:[r];var i=[];for(var s=0,o,u=r.length;s<u;s++)o=r[s],i.push(n(o.url,o.width||420,o.height||280,o.align||"none",!1,!0));e.execCommand("inserthtml",i.join(""))},queryCommandState:function(){var t=e.selection.getRange().getClosedNode(),n=t&&t.className=="edui-faked-video";return this.highlight?-1:n?1:0}}},UE.plugins.table=function(){function o(e){var t=e.parentNode.cells;for(var n=0,r;r=t[n];n++)if(r===e)return n}function u(t,n){var r=t.ownerDocument.createElement("p");domUtils.fillNode(e.document,r);var i=t.parentNode;i&&i.getAttribute("dropdrag")&&(t=i),t.parentNode.insertBefore(r,t),domUtils.remove(t),n.setStart(r,0).setCursor()}function a(e){return e.style.display=="none"}function f(e){var t=0;for(var n=0,r;r=e[n++];)a(r)||t++;return t}function l(){e.currentSelectedArr=[],r=null}function c(e,t){if(s(t))return;if(s(e)){e.innerHTML=t.innerHTML;return}var n=e.lastChild;(n.nodeType!=1||n.tagName!="BR")&&e.appendChild(e.ownerDocument.createElement("br"));while(n=t.firstChild)e.appendChild(n)}function h(e,t){var n=e.parentNode,r=t.parentNode,i=n.rowIndex,s=r.rowIndex,u=n.parentNode.parentNode.rows,f=u.length,l=u[0].cells.length,c=o(e),h=o(t);if(e==t)return{beginRowIndex:i,beginCellIndex:c,endRowIndex:i+e.rowSpan-1,endCellIndex:h+e.colSpan-1};var p=Math.min(i,s),d=Math.min(c,h),v=Math.max(i+e.rowSpan-1,s+t.rowSpan-1),m=Math.max(c+e.colSpan-1,h+t.colSpan-1);for(;;){var g=p,y=d,b=v,w=m;if(p>0)for(T=d;T<=m;){var E=u[p].cells[T];a(E)&&(p=E.getAttribute("rootRowIndex"),E=u[E.getAttribute("rootRowIndex")].cells[E.getAttribute("rootCellIndex")]),T=o(E)+(E.colSpan||1)}if(d>0)for(var S=p;S<=v;){var x=u[S].cells[d];a(x)&&(d=x.getAttribute("rootCellIndex"),x=u[x.getAttribute("rootRowIndex")].cells[x.getAttribute("rootCellIndex")]),S=x.parentNode.rowIndex+(x.rowSpan||1)}if(v<f)for(var T=d;T<=m;){var N=u[v].cells[T];a(N)&&(N=u[N.getAttribute("rootRowIndex")].cells[N.getAttribute("rootCellIndex")]),v=N.parentNode.rowIndex+N.rowSpan-1,T=o(N)+(N.colSpan||1)}if(m<l)for(S=p;S<=v;){var C=u[S].cells[m];a(C)&&(C=u[C.getAttribute("rootRowIndex")].cells[C.getAttribute("rootCellIndex")]),m=o(C)+C.colSpan-1,S=C.parentNode.rowIndex+(C.rowSpan||1)}if(y==d&&w==m&&b==v&&g==p)break}return{beginRowIndex:p,beginCellIndex:d,endRowIndex:v,endCellIndex:m}}function p(t,i){r=i.target||i.srcElement;if(e.queryCommandState("highlightcode")||domUtils.findParent(r,function(e){return e.tagName=="DIV"&&/highlighter/.test(e.id)}))return;if(i.button==2)return;e.document.body.style.webkitUserSelect="",n(e.currentSelectedArr),domUtils.clearSelectedArr(e.currentSelectedArr),r.tagName!=="TD"&&(r=domUtils.findParentByTagName(r,"td")||r),r.tagName=="TD"?e.addListener("mouseover",function(t,n){var r=n.target||n.srcElement;d.call(e,r),n.preventDefault?n.preventDefault():n.returnValue=!1}):l()}function d(t){if(r&&t.tagName=="TD"&&domUtils.findParentByTagName(r,"table")==domUtils.findParentByTagName(t,"table")){e.document.body.style.webkitUserSelect="none";var n=t.parentNode.parentNode.parentNode;e.selection.getNative()[browser.ie?"empty":"removeAllRanges"]();var i=h(r,t);v(n,i)}}function v(t,r){var i=t.rows;n(e.currentSelectedArr);for(var s=r.beginRowIndex;s<=r.endRowIndex;s++)for(var o=r.beginCellIndex;o<=r.endCellIndex;o++){var u=i[s].cells[o];u.className="selectTdClass",e.currentSelectedArr.push(u)}}function m(e){var t=e.getElementsByTagName("td"),n,r,i=e.rows;for(var s=0,u;u=t[s++];){if(!a(u)){n=u.parentNode.rowIndex,r=o(u);for(var f=0;f<u.rowSpan;f++){var l=f==0?1:0;for(;l<u.colSpan;l++){var c=i[n+f].children[r+l];c.setAttribute("rootRowIndex",n),c.setAttribute("rootCellIndex",r)}}}a(u)||domUtils.removeAttributes(u,["rootRowIndex","rootCellIndex"]),u.colSpan&&u.colSpan==1&&u.removeAttribute("colSpan"),u.rowSpan&&u.rowSpan==1&&u.removeAttribute("rowSpan");var h;!a(u)&&(h=u.style.width)&&/%/.test(h)&&(u.style.width=Math.floor(100/u.parentNode.cells.length)+"%")}}var e=this,t=domUtils.keys,n=domUtils.clearSelectedArr,r,i,s=domUtils.isEmptyNode;e.currentSelectedArr=[],e.addListener("mousedown",p),e.addListener("keydown",function(r,i){var s=i.keyCode||i.which;!t[s]&&!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey&&n(e.currentSelectedArr)}),e.addListener("mouseup",function(){r=null,e.removeListener("mouseover",p);var t=e.currentSelectedArr[0];if(t){e.document.body.style.webkitUserSelect="";var n=new dom.Range(e.document);s(t)?n.setStart(e.currentSelectedArr[0],0).setCursor():n.selectNodeContents(e.currentSelectedArr[0]).select()}else{var n=e.selection.getRange().shrinkBoundary();if(!n.collapsed){var i=domUtils.findParentByTagName(n.startContainer,"td",!0),o=domUtils.findParentByTagName(n.endContainer,"td",!0);(i&&!o||!i&&o||i&&o&&i!==o)&&n.collapse(!0).select(!0)}}}),e.commands.inserttable={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange();return domUtils.findParentByTagName(t.startContainer,"table",!0)||domUtils.findParentByTagName(t.endContainer,"table",!0)||e.currentSelectedArr.length>0?-1:0},execCommand:function(t,n){n=n||{numRows:5,numCols:5,border:1};var r=["<table "+(n.border=="0"?' class="noBorderTable"':"")+' _innerCreateTable = "true" '];(n.cellSpacing&&n.cellSpacing!="0"||n.cellPadding&&n.cellPadding!="0")&&r.push(' style="border-collapse:separate;" '),n.cellSpacing&&n.cellSpacing!="0"&&r.push(' cellSpacing="'+n.cellSpacing+'" '),n.cellPadding&&n.cellPadding!="0"&&r.push(' cellPadding="'+n.cellPadding+'" '),r.push(' width="'+(n.width||100)+(typeof n.widthUnit=="undefined"?"%":n.widthUnit)+'" '),n.height&&r.push(' height="'+n.height+(typeof n.heightUnit=="undefined"?"%":n.heightUnit)+'" '),n.align&&r.push(' align="'+n.align+'" '),r.push(' border="'+(n.border||0)+'" borderColor="'+(n.borderColor||"#000000")+'"'),n.borderType=="1"&&r.push(' borderType="1" '),n.bgColor&&r.push(' bgColor="'+n.bgColor+'"'),r.push(" ><tbody>"),n.width=Math.floor((n.width||"100")/n.numCols);for(var i=0;i<n.numRows;i++){r.push("<tr>");for(var s=0;s<n.numCols;s++)r.push('<td style="width:'+n.width+(typeof n.widthUnit=="undefined"?"%":n.widthUnit)+";"+(n.borderType=="1"?"border:"+n.border+"px solid "+(n.borderColor||"#000000"):"")+'">'+(browser.ie?domUtils.fillChar:"<br/>")+"</td>");r.push("</tr>")}e.execCommand("insertHtml",r.join("")+"</tbody></table>"),l();if(n.align){var o=e.selection.getRange(),u=o.createBookmark(),a=o.startContainer;while(a&&!domUtils.isBody(a)){if(domUtils.isBlockElm(a)){a.style.clear="both",o.moveToBookmark(u).select();break}a=a.parentNode}}}},e.commands.edittable={queryCommandState:function(){var t=this.selection.getRange();return this.highlight?-1:domUtils.findParentByTagName(t.startContainer,"table",!0)||e.currentSelectedArr.length>0?0:-1},execCommand:function(t,n){var r=e.selection.getStart(),i=domUtils.findParentByTagName(r,"table",!0);if(i){i.style.cssText=i.style.cssText.replace(/border[^;]+/gi,""),i.style.borderCollapse=n.cellSpacing&&n.cellSpacing!="0"||n.cellPadding&&n.cellPadding!="0"?"separate":"collapse",n.cellSpacing&&n.cellSpacing!="0"?i.setAttribute("cellSpacing",n.cellSpacing):i.removeAttribute("cellSpacing"),n.cellPadding&&n.cellPadding!="0"?i.setAttribute("cellPadding",n.cellPadding):i.removeAttribute("cellPadding"),n.height&&i.setAttribute("height",n.height+n.heightUnit),n.align&&i.setAttribute("align",n.align),n.width&&i.setAttribute("width",n.width+n.widthUnit),n.bgColor?i.setAttribute("bgColor",n.bgColor):domUtils.removeAttributes(i,["bgColor"]),n.borderColor&&i.setAttribute("borderColor",n.borderColor),i.setAttribute("border",n.border),domUtils.hasClass(i,"noBorderTable")&&domUtils.removeClasses(i,["noBorderTable"]),domUtils.addClass(i,n.border=="0"?" noBorderTable":"");if(n.borderType=="1"){for(var s=0,o,u=i.getElementsByTagName("td");o=u[s++];)o.style.border=n.border+"px solid "+(n.borderColor||"#000000");i.setAttribute("borderType","1")}else{for(var s=0,o,u=i.getElementsByTagName("td");o=u[s++];)browser.ie?o.style.cssText=o.style.cssText.replace(/border[^;]+/gi,""):(domUtils.removeStyle(o,"border"),domUtils.removeStyle(o,"border-image"));i.removeAttribute("borderType")}}}},e.commands.edittd={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange();return domUtils.findParentByTagName(t.startContainer,"table",!0)&&domUtils.findParentByTagName(t.endContainer,"table",!0)||e.currentSelectedArr.length>0?0:-1},execCommand:function(t,n){var r=this.selection.getRange(),i=e.currentSelectedArr.length?e.currentSelectedArr:[domUtils.findParentByTagName(r.startContainer,["td","th"],!0)];for(var s=0,o;o=i[s++];)domUtils.setAttributes(o,{bgColor:n.bgColor,align:n.align,vAlign:n.vAlign})}},e.commands.deletetable={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange();return domUtils.findParentByTagName(t.startContainer,"table",!0)&&domUtils.findParentByTagName(t.endContainer,"table",!0)||e.currentSelectedArr.length>0?0:-1},execCommand:function(){var t=this.selection.getRange(),n=domUtils.findParentByTagName(e.currentSelectedArr.length>0?e.currentSelectedArr[0]:t.startContainer,"table",!0);u(n,t),l()}},e.commands.mergeright={queryCommandState:function(){if(this.highlight)return-1;var e=this.selection.getRange(),t=e.startContainer,n=domUtils.findParentByTagName(t,["td","th"],!0);if(!n||this.currentSelectedArr.length>1)return-1;var r=n.parentNode,i=o(n)+n.colSpan;if(i>=r.cells.length)return-1;var s=r.cells[i];return a(s)?-1:n.rowSpan==s.rowSpan?0:-1},execCommand:function(){var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0)||e.currentSelectedArr[0],i=r.parentNode,s=i.parentNode.parentNode.rows,u=i.rowIndex,a=o(r)+r.colSpan,f=s[u].cells[a];for(var l=u;l<u+f.rowSpan;l++)for(var h=a;h<a+f.colSpan;h++){var p=s[l].cells[h];p.setAttribute("rootRowIndex",i.rowIndex),p.setAttribute("rootCellIndex",o(r))}r.colSpan+=f.colSpan||1,c(r,f),f.style.display="none",domUtils.isEmptyBlock(r)?t.setStart(r,0).setCursor():t.selectNodeContents(r).setCursor(!0,!0),browser.ie&&domUtils.removeAttributes(r,["width","height"])}},e.commands.mergedown={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,"td",!0);if(!r||f(e.currentSelectedArr)>1)return-1;var i=r.parentNode,s=i.parentNode.parentNode,u=s.rows,l=i.rowIndex+r.rowSpan;if(l>=u.length)return-1;var c=u[l].cells[o(r)];return a(c)?-1:r.colSpan==c.colSpan?0:-1},execCommand:function(){var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0)||e.currentSelectedArr[0],i=r.parentNode,s=i.parentNode.parentNode.rows,u=i.rowIndex+r.rowSpan,a=o(r),f=s[u].cells[a];for(var l=u;l<u+f.rowSpan;l++)for(var h=a;h<a+f.colSpan;h++){var p=s[l].cells[h];p.setAttribute("rootRowIndex",i.rowIndex),p.setAttribute("rootCellIndex",o(r))}r.rowSpan+=f.rowSpan||1,c(r,f),f.style.display="none",domUtils.isEmptyBlock(r)?t.setStart(r,0).setCursor():t.selectNodeContents(r).setCursor(!0,!0),browser.ie&&domUtils.removeAttributes(r,["width","height"])}},e.commands.deleterow={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0);return!r&&e.currentSelectedArr.length==0?-1:0},execCommand:function(){var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0),i,s,f,l,c,h;if(r&&e.currentSelectedArr.length==0){var p=(r.rowSpan||1)-1;e.currentSelectedArr.push(r),i=r.parentNode,s=i.parentNode.parentNode,l=s.rows,c=i.rowIndex+1,h=o(r);while(p)e.currentSelectedArr.push(l[c].cells[h]),p--,c++}while(r=e.currentSelectedArr.pop()){if(!domUtils.findParentByTagName(r,"table"))continue;i=r.parentNode,s=i.parentNode.parentNode,f=i.cells,l=s.rows,c=i.rowIndex,h=o(r);for(var d=0;d<f.length;){var v=f[d];if(a(v)){var g=l[v.getAttribute("rootRowIndex")].cells[v.getAttribute("rootCellIndex")];g.rowSpan--,d+=g.colSpan}else if(v.rowSpan==1)d+=v.colSpan;else{var y=l[c+1].cells[d];y.style.display="",y.rowSpan=v.rowSpan-1,y.colSpan=v.colSpan,d+=v.colSpan}}domUtils.remove(i);var b,w,E;if(c==l.length){if(c==0){u(s,t);return}var S=c-1;b=l[S].cells[h],w=a(b)?l[b.getAttribute("rootRowIndex")].cells[b.getAttribute("rootCellIndex")]:b}else E=l[c].cells[h],w=a(E)?l[E.getAttribute("rootRowIndex")].cells[E.getAttribute("rootCellIndex")]:E}t.setStart(w,0).setCursor(),m(s)}},e.commands.deletecol={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0);return!r&&e.currentSelectedArr.length==0?-1:0},execCommand:function(){var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0);if(r&&e.currentSelectedArr.length==0){var i=(r.colSpan||1)-1;e.currentSelectedArr.push(r);while(i){do r=r.nextSibling;while(r.nodeType==3);e.currentSelectedArr.push(r),i--}}while(r=e.currentSelectedArr.pop()){if(!domUtils.findParentByTagName(r,"table"))continue;var s=r.parentNode,f=s.parentNode.parentNode,l=o(r),c=f.rows,h=s.cells,p=s.rowIndex,d;for(var v=0;v<c.length;){var g=c[v].cells[l];if(a(g)){var y=c[g.getAttribute("rootRowIndex")].cells[g.getAttribute("rootCellIndex")];d=y.rowSpan;for(var b=0;b<y.rowSpan;b++){var w=c[v+b].cells[l];domUtils.remove(w)}y.colSpan--,v+=d}else if(g.colSpan==1){d=g.rowSpan;for(var b=v,E=v+g.rowSpan;b<E;b++)domUtils.remove(c[b].cells[l]);v+=d}else{var S=c[v].cells[l+1];S.style.display="",S.rowSpan=g.rowSpan,S.colSpan=g.colSpan-1,v+=g.rowSpan,domUtils.remove(g)}}var x,T,N;if(l==h.length){if(l==0){u(f,t);return}var C=l-1;x=c[p].cells[C],T=a(x)?c[x.getAttribute("rootRowIndex")].cells[x.getAttribute("rootCellIndex")]:x}else N=c[p].cells[l],T=a(N)?c[N.getAttribute("rootRowIndex")].cells[N.getAttribute("rootCellIndex")]:N}t.setStart(T,0).setCursor(),m(f)}},e.commands.splittocells={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0);return r&&(r.rowSpan>1||r.colSpan>1)&&(!e.currentSelectedArr.length||f(e.currentSelectedArr)==1)?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.startContainer,n=domUtils.findParentByTagName(t,["td","th"],!0),r=n.parentNode,i=r.parentNode.parentNode,s=r.rowIndex,u=o(n),f=n.rowSpan,l=n.colSpan;for(var c=0;c<f;c++)for(var h=0;h<l;h++){var p=i.rows[s+c].cells[u+h];p.rowSpan=1,p.colSpan=1,a(p)&&(p.style.display="",p.innerHTML=browser.ie?"":"<br/>")}}},e.commands.splittorows={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,"td",!0)||e.currentSelectedArr[0];return r&&r.rowSpan>1&&(!e.currentSelectedArr.length||f(e.currentSelectedArr)==1)?0:-1},execCommand:function(){var t=this.selection.getRange(),r=t.startContainer,i=domUtils.findParentByTagName(r,"td",!0)||e.currentSelectedArr[0],s=i.parentNode,u=s.parentNode.parentNode.rows,f=s.rowIndex,l=o(i),c=i.rowSpan,h=i.colSpan;for(var p=0;p<c;p++){var d=u[f+p],v=d.cells[l];v.rowSpan=1,v.colSpan=h,a(v)&&(v.style.display="",v.innerHTML=browser.ie?"":"<br/>");for(var m=l+1;m<l+h;m++)v=d.cells[m],v.setAttribute("rootRowIndex",f+p)}n(e.currentSelectedArr),this.selection.getRange().setStart(i,0).setCursor()}},e.commands.insertparagraphbeforetable={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,"td",!0)||e.currentSelectedArr[0];return r&&domUtils.findParentByTagName(r,"table")?0:-1},execCommand:function(){var t=this.selection.getRange(),r=t.startContainer,i=domUtils.findParentByTagName(r,"table",!0);r=e.document.createElement(e.options.enterTag),i.parentNode.insertBefore(r,i),n(e.currentSelectedArr),r.tagName=="P"?(r.innerHTML=browser.ie?"":"<br/>",t.setStart(r,0)):t.setStartBefore(r),t.setCursor()}},e.commands.splittocols={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n=t.startContainer,r=domUtils.findParentByTagName(n,["td","th"],!0)||e.currentSelectedArr[0];return r&&r.colSpan>1&&(!e.currentSelectedArr.length||f(e.currentSelectedArr)==1)?0:-1},execCommand:function(){var t=this.selection.getRange(),r=t.startContainer,i=domUtils.findParentByTagName(r,["td","th"],!0)||e.currentSelectedArr[0],s=i.parentNode,u=s.parentNode.parentNode.rows,f=s.rowIndex,l=o(i),c=i.rowSpan,h=i.colSpan;for(var p=0;p<h;
p++){var d=u[f].cells[l+p];d.rowSpan=c,d.colSpan=1,a(d)&&(d.style.display="",d.innerHTML=browser.ie?"":"<br/>");for(var v=f+1;v<f+c;v++){var m=u[v].cells[l+p];m.setAttribute("rootCellIndex",l+p)}}n(e.currentSelectedArr),this.selection.getRange().setStart(i,0).setCursor()}},e.commands.insertrow={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange();return domUtils.findParentByTagName(t.startContainer,"table",!0)||domUtils.findParentByTagName(t.endContainer,"table",!0)||e.currentSelectedArr.length!=0?0:-1},execCommand:function(){var t=this.selection.getRange(),r=t.startContainer,i=domUtils.findParentByTagName(r,"tr",!0)||e.currentSelectedArr[0].parentNode,s=i.parentNode.parentNode,o=s.rows,u=i.rowIndex,f=o[u].cells,l=s.insertRow(u),c;for(var h=0;h<f.length;){var p=f[h];if(a(p)){var d=o[p.getAttribute("rootRowIndex")].cells[p.getAttribute("rootCellIndex")];d.rowSpan++;for(var v=0;v<d.colSpan;v++)c=p.cloneNode(!1),domUtils.removeAttributes(c,["bgColor","valign","align"]),c.rowSpan=c.colSpan=1,c.innerHTML=browser.ie?"":"<br/>",c.className="",l.children[h+v]?l.insertBefore(c,l.children[h+v]):l.appendChild(c),c.style.display="none";h+=d.colSpan}else{for(var g=0;g<p.colSpan;g++)c=p.cloneNode(!1),domUtils.removeAttributes(c,["bgColor","valign","align"]),c.rowSpan=c.colSpan=1,c.innerHTML=browser.ie?"":"<br/>",c.className="",l.children[h+g]?l.insertBefore(c,l.children[h+g]):l.appendChild(c);h+=p.colSpan}}m(s),t.setStart(l.cells[0],0).setCursor(),n(e.currentSelectedArr)}},e.commands.insertcol={queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange();return domUtils.findParentByTagName(t.startContainer,"table",!0)||domUtils.findParentByTagName(t.endContainer,"table",!0)||e.currentSelectedArr.length!=0?0:-1},execCommand:function(){var t=this.selection.getRange(),r=t.startContainer,i=domUtils.findParentByTagName(r,["td","th"],!0)||e.currentSelectedArr[0],s=domUtils.findParentByTagName(i,"table"),u=s.rows,f=o(i),l;for(var c=0;c<u.length;){var h=u[c].cells[f],p;if(a(h)){var d=u[h.getAttribute("rootRowIndex")].cells[h.getAttribute("rootCellIndex")];d.colSpan++;for(var v=0;v<d.rowSpan;v++)l=i.cloneNode(!1),domUtils.removeAttributes(l,["bgColor","valign","align"]),l.rowSpan=l.colSpan=1,l.innerHTML=browser.ie?"":"<br/>",l.className="",p=u[c+v],p.children[f]?p.insertBefore(l,p.children[f]):p.appendChild(l),l.style.display="none";c+=d.rowSpan}else{for(var g=0;g<h.rowSpan;g++)l=i.cloneNode(!1),domUtils.removeAttributes(l,["bgColor","valign","align"]),l.rowSpan=l.colSpan=1,l.innerHTML=browser.ie?"":"<br/>",l.className="",p=u[c+g],p.children[f]?p.insertBefore(l,p.children[f]):p.appendChild(l),l.innerHTML=browser.ie?"":"<br/>";c+=h.rowSpan}}m(s),t.setStart(u[0].cells[f],0).setCursor(),n(e.currentSelectedArr)}},e.commands.mergecells={queryCommandState:function(){if(this.highlight)return-1;var e=0;for(var t=0,n;n=this.currentSelectedArr[t++];)a(n)||e++;return e>1?0:-1},execCommand:function(){var t=e.currentSelectedArr[0],r=e.currentSelectedArr[e.currentSelectedArr.length-1],i=domUtils.findParentByTagName(t,"table"),s=i.rows,u={beginRowIndex:t.parentNode.rowIndex,beginCellIndex:o(t),endRowIndex:r.parentNode.rowIndex,endCellIndex:o(r)},a=u.beginRowIndex,f=u.beginCellIndex,l=u.endRowIndex-u.beginRowIndex+1,h=u.endCellIndex-u.beginCellIndex+1,p=s[a].cells[f];for(var d=0,v;(v=s[a+d++])&&d<=l;)for(var m=0,g;(g=v.cells[f+m++])&&m<=h;)d==1&&m==1?(g.style.display="",g.rowSpan=l,g.colSpan=h):(g.style.display="none",g.rowSpan=1,g.colSpan=1,g.setAttribute("rootRowIndex",a),g.setAttribute("rootCellIndex",f),c(p,g));this.selection.getRange().setStart(p,0).setCursor(),browser.ie&&domUtils.removeAttributes(p,["width","height"]),n(e.currentSelectedArr)}},e.adjustTable=function(t){var n=t.getElementsByTagName("table");for(var r=0,i;i=n[r++];){if(i.getAttribute("align")){var s=i.nextSibling;while(s){if(domUtils.isBlockElm(s))break;s=s.nextSibling}s&&(s.style.clear="both")}i.removeAttribute("_innerCreateTable");var u=domUtils.getElementsByTagName(i,"td"),a,f;for(var l=0,c;c=u[l++];){domUtils.isEmptyNode(c)&&(c.innerHTML=browser.ie?domUtils.fillChar:"<br/>");var h=o(c),p=c.parentNode.rowIndex,d=domUtils.findParentByTagName(c,"table").rows;for(var v=0;v<c.rowSpan;v++){var m=v==0?1:0;for(;m<c.colSpan;m++)a?a=a.cloneNode(!0):(a=c.cloneNode(!1),a.rowSpan=a.colSpan=1,a.style.display="none",a.innerHTML=browser.ie?"":"<br/>"),a.setAttribute("rootRowIndex",c.parentNode.rowIndex),a.setAttribute("rootCellIndex",h),v==0?c.nextSibling?c.parentNode.insertBefore(a,c.nextSibling):c.parentNode.appendChild(a):(f=d[p+v].children[h],f?f.parentNode.insertBefore(a,f):d[p+v].appendChild(a))}}var g=domUtils.getComputedStyle(i,"border-width");(g=="0px"&&i.style.border!="none"||(g==""||g=="medium")&&i.getAttribute("border")==="0")&&domUtils.addClass(i,"noBorderTable")}e.fireEvent("afteradjusttable",t)}},UE.plugins.contextmenu=function(){var e=this,t=e.getLang("contextMenu"),n,r=e.options.contextMenu||[{label:t["delete"],cmdName:"delete"},{label:t.selectall,cmdName:"selectall"},{label:t.deletecode,cmdName:"highlightcode",icon:"deletehighlightcode"},{label:t.cleardoc,cmdName:"cleardoc",exec:function(){confirm(t.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:t.unlink,cmdName:"unlink"},"-",{group:t.paragraph,icon:"justifyjustify",subMenu:[{label:e.getLang("justifyleft"),cmdName:"justify",value:"left"},{label:e.getLang("justifyright"),cmdName:"justify",value:"right"},{label:e.getLang("justifyrenter"),cmdName:"justify",value:"center"},{label:e.getLang("justify"),cmdName:"justify",value:"justify"}]},"-",{label:t.edittable,cmdName:"edittable",exec:function(){this.ui._dialogs.inserttableDialog.open()}},{label:t.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this),this.ui._dialogs.edittdDialog.open()}},{group:t.table,icon:"table",subMenu:[{label:t.deletetable,cmdName:"deletetable"},{label:t.insertparagraphbeforetable,cmdName:"insertparagraphbeforetable"},"-",{label:t.deleterow,cmdName:"deleterow"},{label:t.deletecol,cmdName:"deletecol"},"-",{label:t.insertrow,cmdName:"insertrow"},{label:t.insertcol,cmdName:"insertcol"},"-",{label:t.mergeright,cmdName:"mergeright"},{label:t.mergedown,cmdName:"mergedown"},"-",{label:t.splittorows,cmdName:"splittorows"},{label:t.splittocols,cmdName:"splittocols"},{label:t.mergecells,cmdName:"mergecells"},{label:t.splittocells,cmdName:"splittocells"}]},{label:t.copy,cmdName:"copy",exec:function(){alert(t.copymsg)},query:function(){return 0}},{label:t.paste,cmdName:"paste",exec:function(){alert(t.pastemsg)},query:function(){return 0}}];if(!r.length)return;var i=UE.ui.uiUtils;e.addListener("contextmenu",function(t,s){var o=i.getViewportOffsetByEvent(s);e.fireEvent("beforeselectionchange"),n&&n.destroy();for(var u=0,a,f=[];a=r[u];u++){var l;(function(t){if(t=="-")(l=f[f.length-1])&&l!=="-"&&f.push("-");else if(t.hasOwnProperty("group")){for(var n=0,r,i=[];r=t.subMenu[n];n++)(function(t){t=="-"?(l=i[i.length-1])&&l!=="-"&&i.push("-"):(e.commands[t.cmdName]||UE.commands[t.cmdName]||t.query)&&(t.query?t.query():e.queryCommandState(t.cmdName))>-1&&i.push({label:t.label||e.getLang("contextMenu."+t.cmdName+(t.value||"")),className:"edui-for-"+t.cmdName+(t.value||""),onclick:t.exec?function(){t.exec.call(e)}:function(){e.execCommand(t.cmdName,t.value)}})})(r);i.length&&f.push({label:t.icon=="table"?e.getLang("contextMenu.table"):e.getLang("contextMenu.paragraph"),className:"edui-for-"+t.icon,subMenu:{items:i,editor:e}})}else if((e.commands[t.cmdName]||UE.commands[t.cmdName]||t.query)&&(t.query?t.query():e.queryCommandState(t.cmdName))>-1){if(t.cmdName=="highlightcode"&&e.queryCommandState(t.cmdName)==0)return;f.push({label:t.label||e.getLang("contextMenu."+t.cmdName),className:"edui-for-"+(t.icon?t.icon:t.cmdName+(t.value||"")),onclick:t.exec?function(){t.exec.call(e)}:function(){e.execCommand(t.cmdName,t.value)}})}})(a)}f[f.length-1]=="-"&&f.pop(),n=new UE.ui.Menu({items:f,editor:e}),n.render(),n.showAt(o),domUtils.preventDefault(s);if(browser.ie){var c;try{c=e.selection.getNative().createRange()}catch(h){return}if(c.item){var p=new dom.Range(e.document);p.selectNode(c.item(0)).select(!0,!0)}}})},UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=function(e,t){var n=e.selection.getStartElementPath();return utils.findNode(n,t)},n=this;for(var r in e)(function(e,r){n.commands[e]={execCommand:function(e){var i=new dom.Range(n.document),s="";if(n.currentSelectedArr&&n.currentSelectedArr.length>0){for(var o=0,u;u=n.currentSelectedArr[o++];)u.style.display!="none"&&(i.selectNodeContents(u).select(),!s&&(s=t(this,r)),(e=="superscript"||e=="subscript")&&(!s||s.tagName.toLowerCase()!=e)&&i.removeInlineStyle(["sub","sup"]),s?i.removeInlineStyle(r):i.applyInlineStyle(r[0]));i.selectNodeContents(n.currentSelectedArr[0]).select()}else{i=n.selection.getRange(),s=t(this,r);if(i.collapsed){if(s){var a=n.document.createTextNode("");i.insertNode(a).removeInlineStyle(r),i.setStartBefore(a),domUtils.remove(a)}else{var f=i.document.createElement(r[0]);if(e=="superscript"||e=="subscript")a=n.document.createTextNode(""),i.insertNode(a).removeInlineStyle(["sub","sup"]).setStartBefore(a).collapse(!0);i.insertNode(f).setStart(f,0)}i.collapse(!0)}else(e=="superscript"||e=="subscript")&&(!s||s.tagName.toLowerCase()!=e)&&i.removeInlineStyle(["sub","sup"]),s?i.removeInlineStyle(r):i.applyInlineStyle(r[0]);i.select()}return!0},queryCommandState:function(){return this.highlight?-1:t(this,r)?1:0}}})(r,e[r])},UE.plugins.elementpath=function(){var e,t,n=this;n.setOpt("elementPathEnabled",!0);if(!n.options.elementPathEnabled)return;n.commands.elementpath={execCommand:function(r,i){var s=t[i],o=n.selection.getRange();n.currentSelectedArr&&domUtils.clearSelectedArr(n.currentSelectedArr),e=i*1;if(dtd.$tableContent[s.tagName]){switch(s.tagName){case"TD":n.currentSelectedArr=[s],s.className=n.options.selectedTdClass;break;case"TR":var u=s.cells;for(var a=0,f;f=u[a++];)n.currentSelectedArr.push(f),f.className=n.options.selectedTdClass;break;case"TABLE":case"TBODY":var l=s.rows;for(var a=0,c;c=l[a++];){u=c.cells;for(var h=0,p;p=u[h++];)n.currentSelectedArr.push(p),p.className=n.options.selectedTdClass}}s=n.currentSelectedArr[0],domUtils.isEmptyNode(s)?o.setStart(s,0).setCursor():o.selectNodeContents(s).select()}else o.selectNode(s).select()},queryCommandValue:function(){var n=[].concat(this.selection.getStartElementPath()).reverse(),r=[];t=n;for(var i=0,s;s=n[i];i++){if(s.nodeType==3)continue;var o=s.tagName.toLowerCase();o=="img"&&s.getAttribute("anchorname")&&(o="anchor"),r[i]=o;if(e==i){e=-1;break}}return r}}},UE.plugins.formatmatch=function(){function i(s,o){function a(n){return h&&(!e.currentSelectedArr||!e.currentSelectedArr.length)&&n.selectNode(h),n.applyInlineStyle(t[t.length-1].tagName,null,t)}if(browser.webkit)var u=o.target.tagName=="IMG"?o.target:null;e.undoManger&&e.undoManger.save();var f=e.selection.getRange(),l=u||f.getClosedNode();if(n&&l&&l.tagName=="IMG")l.style.cssText+=";float:"+(n.style.cssFloat||n.style.styleFloat||"none")+";display:"+(n.style.display||"inline"),n=null;else if(!n){var c=f.collapsed;if(c){var h=e.document.createTextNode("match");f.insertNode(h).select()}e.__hasEnterExecCommand=!0;var p=e.options.removeFormatAttributes;e.options.removeFormatAttributes="",e.execCommand("removeformat"),e.options.removeFormatAttributes=p,e.__hasEnterExecCommand=!1,f=e.selection.getRange();if(t.length==0)e.currentSelectedArr&&e.currentSelectedArr.length>0&&f.selectNodeContents(e.currentSelectedArr[0]).select();else if(e.currentSelectedArr&&e.currentSelectedArr.length>0){for(var d=0,v;v=e.currentSelectedArr[d++];)f.selectNodeContents(v),a(f);f.selectNodeContents(e.currentSelectedArr[0]).select()}else a(f);if(!e.currentSelectedArr||!e.currentSelectedArr.length)h&&f.setStartBefore(h).collapse(!0),f.select();h&&domUtils.remove(h)}e.undoManger&&e.undoManger.save(),e.removeListener("mouseup",i),r=0}var e=this,t=[],n,r=0;e.addListener("reset",function(){t=[],r=0}),e.commands.formatmatch={execCommand:function(s){if(r){r=0,t=[],e.removeListener("mouseup",i);return}var o=e.selection.getRange();n=o.getClosedNode();if(!n||n.tagName!="IMG"){o.collapse(!0).shrinkBoundary();var u=o.startContainer;t=domUtils.findParents(u,!0,function(e){return!domUtils.isBlockElm(e)&&e.nodeType==1});for(var a=0,f;f=t[a];a++)if(f.tagName=="A"){t.splice(a,1);break}}e.addListener("mouseup",i),r=1},queryCommandState:function(){return this.highlight?-1:r},notNeedUndo:1}},UE.plugins.searchreplace=function(){var e,t,n=this;n.addListener("reset",function(){e=null,t=null}),n.commands.searchreplace={execCommand:function(n,r){var i=this,s=i.selection,o,u,a=0,r=utils.extend(r,{all:!1,casesensitive:!1,dir:1},!0);if(browser.ie)for(;;){var f;u=i.document.selection.createRange(),f=u.duplicate(),f.moveToElementText(i.document.body),r.all?(t=0,r.dir=1,e&&f.setEndPoint(r.dir==-1?"EndToStart":"StartToEnd",e)):(f.setEndPoint(r.dir==-1?"EndToStart":"StartToEnd",u),r.hasOwnProperty("replaceStr")&&f.setEndPoint(r.dir==-1?"StartToEnd":"EndToStart",u)),u=f.duplicate();if(!f.findText(r.searchStr,r.dir,r.casesensitive?4:0))return e=null,f=i.document.selection.createRange(),f.scrollIntoView(),a;f.select(),r.hasOwnProperty("replaceStr")&&(o=s.getRange(),o.deleteContents().insertNode(o.document.createTextNode(r.replaceStr)).select(),e=s.getNative().createRange()),a++;if(!r.all)break}else{var l=i.window,c=s.getNative(),f;for(;;){r.all?(e?(e.collapse(!1),u=e):(u=i.document.createRange(),u.setStart(i.document.body,0)),c.removeAllRanges(),c.addRange(u),t=0,r.dir=1):(u=l.getSelection().getRangeAt(0),r.hasOwnProperty("replaceStr")&&u.collapse(r.dir==1?!0:!1)),t?c.removeAllRanges():(u.collapse(r.dir<0?!0:!1),c.removeAllRanges(),c.addRange(u));if(!l.find(r.searchStr,r.casesensitive,r.dir<0?!0:!1))return e=null,c.removeAllRanges(),a;t=0,o=l.getSelection().getRangeAt(0);if(!o.collapsed&&r.hasOwnProperty("replaceStr")){o.deleteContents();var h=l.document.createTextNode(r.replaceStr);o.insertNode(h),o.selectNode(h),c.addRange(o),e=o.cloneRange()}a++;if(!r.all)break}}return!0}}},UE.plugins.customstyle=function(){var e=this;e.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;color:#000;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]}),e.commands.customstyle={execCommand:function(e,t){var n=this,r=t.tag,i=domUtils.findParent(n.selection.getStart(),function(e){return e.getAttribute("label")},!0),s,o,u={};for(var a in t)u[a]=t[a];delete u.tag;if(i&&i.getAttribute("label")==t.label){s=this.selection.getRange(),o=s.createBookmark();if(s.collapsed)if(dtd.$block[i.tagName]){var f=n.document.createElement("p");domUtils.moveChild(i,f),i.parentNode.insertBefore(f,i),domUtils.remove(i)}else domUtils.remove(i,!0);else{var l=domUtils.getCommonAncestor(o.start,o.end),c=domUtils.getElementsByTagName(l,r);(new RegExp(r,"i")).test(l.tagName)&&c.push(l);for(var h=0,p;p=c[h++];)if(p.getAttribute("label")==t.label){var d=domUtils.getPosition(p,o.start),v=domUtils.getPosition(p,o.end);if((d&domUtils.POSITION_FOLLOWING||d&domUtils.POSITION_CONTAINS)&&(v&domUtils.POSITION_PRECEDING||v&domUtils.POSITION_CONTAINS)&&dtd.$block[r]){var f=n.document.createElement("p");domUtils.moveChild(p,f),p.parentNode.insertBefore(f,p)}domUtils.remove(p,!0)}i=domUtils.findParent(l,function(e){return e.getAttribute("label")==t.label},!0),i&&domUtils.remove(i,!0)}s.moveToBookmark(o).select()}else if(dtd.$block[r]){this.execCommand("paragraph",r,u,"customstyle"),s=n.selection.getRange();if(!s.collapsed){s.collapse(),i=domUtils.findParent(n.selection.getStart(),function(e){return e.getAttribute("label")==t.label},!0);var m=n.document.createElement("p");domUtils.insertAfter(i,m),domUtils.fillNode(n.document,m),s.setStart(m,0).setCursor()}}else{s=n.selection.getRange();if(s.collapsed){i=n.document.createElement(r),domUtils.setAttributes(i,u),s.insertNode(i).setStart(i,0).setCursor();return}o=s.createBookmark(),s.applyInlineStyle(r,u).moveToBookmark(o).select()}},queryCommandValue:function(){var e=utils.findNode(this.selection.getStartElementPath(),null,function(e){return e.getAttribute("label")});return e?e.getAttribute("label"):""},queryCommandState:function(){return this.highlight?-1:0}},e.addListener("keyup",function(t,n){var r=n.keyCode||n.which;if(r==32||r==13){var i=e.selection.getRange();if(i.collapsed){var s=domUtils.findParent(e.selection.getStart(),function(e){return e.getAttribute("label")},!0);if(s&&dtd.$block[s.tagName]&&domUtils.isEmptyNode(s)){var o=e.document.createElement("p");domUtils.insertAfter(s,o),domUtils.fillNode(e.document,o),domUtils.remove(s),i.setStart(o,0).setCursor()}}}})},UE.plugins.catchremoteimage=function(){function catchremoteimage(e,t){var n=e.join(separater),r={timeout:6e4,onsuccess:t.success,onerror:t.error};r[me.options.catchFieldName]=n,ajax.request(catcherUrl,r)}if(this.options.catchRemoteImageEnable===!1)return;var me=this;this.setOpt({localDomain:["127.0.0.1","localhost","img.baidu.com"],separater:"ue_separate_ue",catchFieldName:"upfile",catchRemoteImageEnable:!0});var ajax=UE.ajax,localDomain=me.options.localDomain,catcherUrl=me.options.catcherUrl,separater=me.options.separater;me.addListener("afterpaste",function(){me.fireEvent("catchRemoteImage")}),me.addListener("catchRemoteImage",function(){var remoteImages=[],imgs=domUtils.getElementsByTagName(me.document,"img"),test=function(e,t){for(var n=0,r;r=t[n++];)if(e.indexOf(r)!==-1)return!0;return!1};for(var i=0,ci;ci=imgs[i++];){if(ci.getAttribute("word_img"))continue;var src=ci.getAttribute("data_ue_src")||ci.src||"";/^(https?|ftp):/i.test(src)&&!test(src,localDomain)&&remoteImages.push(src)}remoteImages.length&&catchremoteimage(remoteImages,{success:function(xhr){try{var info=eval("("+xhr.responseText+")")}catch(e){return}var srcUrls=info.srcUrl.split(separater),urls=info.url.split(separater);for(var i=0,ci;ci=imgs[i++];){var src=ci.getAttribute("data_ue_src")||ci.src||"";for(var j=0,cj;cj=srcUrls[j++];){var url=urls[j-1];if(src==cj&&url!="error"){var newSrc=me.options.catcherPath+url;domUtils.setAttributes(ci,{src:newSrc,data_ue_src:newSrc});break}}}},error:function(){me.fireEvent("catchremoteerror")}})})},UE.commands.snapscreen={execCommand:function(){var me=this,lang=me.getLang("snapScreen_plugin");me.setOpt({snapscreenServerPort:80,snapscreenImgAlign:"center"});var editorOptions=me.options;if(!browser.ie){alert(lang.browserMsg);return}var onSuccess=function(rs){try{rs=eval("("+rs+")")}catch(e){alert(lang.callBackErrorMsg);return}if(rs.state!="SUCCESS"){alert(rs.state);return}me.execCommand("insertimage",{src:editorOptions.snapscreenPath+rs.url,floatStyle:editorOptions.snapscreenImgAlign,data_ue_src:editorOptions.snapscreenPath+rs.url})},onStartUpload=function(){},onError=function(){alert(lang.uploadErrorMsg)};try{var nativeObj=new ActiveXObject("Snapsie.CoSnapsie");nativeObj.saveSnapshot(editorOptions.snapscreenHost,editorOptions.snapscreenServerUrl,editorOptions.snapscreenServerPort,onStartUpload,onSuccess,onError)}catch(e){me.ui._dialogs.snapscreenDialog.open()}},queryCommandState:function(){return this.highlight||!browser.ie?-1:0}},UE.commands.attachment={queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.webapp=function(){function t(t,n,r){return n?'<iframe class="edui-faked-webapp" title="'+t.title+'" width="'+t.width+'" height="'+t.height+'"  scrolling="no" frameborder="0" src="'+t.url+'" logo_url = '+t.logo+"></iframe>":(r?"<p>":"")+'<img title="'+t.title+'" width="'+t.width+'" height="'+t.height+'"'+' src="'+e.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+t.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+t.url+'" />'+(r?"</p>":"")}function n(n){var r,i=domUtils.getElementsByTagName(e.document,n?"img":"iframe");for(var s=0,o;o=i[s++];){if(o.className!="edui-faked-webapp")continue;r=e.document.createElement("div"),r.innerHTML=t(n?{url:o.getAttribute("_url"),width:o.width,height:o.height,title:o.title,logo:o.style.backgroundImage.replace("url(","").replace(")","")}:{url:o.getAttribute("src",2),title:o.title,width:o.width,height:o.height,logo:o.getAttribute("logo_url")},n?!0:!1,!1),o.parentNode.replaceChild(r.firstChild,o)}}var e=this;e.addListener("beforegetcontent",function(){n(!0)}),e.addListener("aftersetcontent",function(){n(!1)}),e.addListener("aftergetcontent",function(t){if(t=="aftergetcontent"&&e.queryCommandState("source"))return;n(!1)}),UE.commands.webapp={execCommand:function(n,r){e.execCommand("inserthtml",t(r,!1,!0))},queryCommandState:function(){return e.highlight?-1:0}}},function(){UE.plugins.template=function(){var e=this;UE.commands.template={execCommand:function(t,n){n.html&&e.execCommand("inserthtml",n.html)},queryCommandState:function(){return this.highlight?-1:0}},e.addListener("click",function(t,n){var r=n.target||n.srcElement,i=e.selection.getRange(),s=domUtils.findParent(r,function(e){if(e.className&&domUtils.hasClass(e,"ue_t"))return e},!0);s&&i.selectNode(s).shrinkBoundary().select()}),e.addListener("keydown",function(t,n){var r=e.selection.getRange();if(!r.collapsed&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey&&!n.altKey){var i=domUtils.findParent(r.startContainer,function(e){if(e.className&&domUtils.hasClass(e,"ue_t"))return e},!0);i&&domUtils.removeClasses(i,["ue_t"])}})}}();var baidu=baidu||{};baidu.editor=baidu.editor||{},baidu.editor.ui={},function(){function u(){var e=document.getElementById("edui_fixedlayer");o.setViewportOffset(e,{left:0,top:0})}function a(e){t.on(window,"scroll",u),t.on(window,"resize",baidu.editor.utils.defer(u,0,!0))}var e=baidu.editor.browser,t=baidu.editor.dom.domUtils,n="$EDITORUI",r=window[n]={},i="ID"+n,s=0,o=baidu.editor.ui.uiUtils={uid:function(e){return e?e[i]||(e[i]=++s):++s},hook:function(e,t){var n;return e&&e._callbacks?n=e:(n=function(){var t;e&&(t=e.apply(this,arguments));var r=n._callbacks,i=r.length;while(i--){var s=r[i].apply(this,arguments);t===undefined&&(t=s)}return t},n._callbacks=[]),n._callbacks.push(t),n},createElementByHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return e.ie&&e.quirks?document.body:document.documentElement},getClientRect:function(e){var n;try{n=e.getBoundingClientRect()}catch(r){n={left:0,top:0,height:0,width:0}}var i={left:Math.round(n.left),top:Math.round(n.top),height:Math.round(n.bottom-n.top),width:Math.round(n.right-n.left)},s;while((s=e.ownerDocument)!==document&&(e=t.getWindow(s).frameElement))n=e.getBoundingClientRect(),i.left+=n.left,i.top+=n.top;return i.bottom=i.top+i.height,i.right=i.left+i.width,i},getViewportRect:function(){var e=o.getViewportElement(),t=(window.innerWidth||e.clientWidth)|0,n=(window.innerHeight||e.clientHeight)|0;return{left:0,top:0,height:n,width:t,bottom:n,right:t}},setViewportOffset:function(e,n){var r,i=o.getFixedLayer();e.parentNode===i?(e.style.left=n.left+"px",e.style.top=n.top+"px"):t.setViewportOffset(e,n)},getEventOffset:function(e){var t=e.target||e.srcElement,n=o.getClientRect(t),r=o.getViewportOffsetByEvent(e);return{left:r.left-n.left,top:r.top-n.top}},getViewportOffsetByEvent:function(e){var n=e.target||e.srcElement,r=t.getWindow(n).frameElement,i={left:e.clientX,top:e.clientY};if(r&&n.ownerDocument!==document){var s=o.getClientRect(r);i.left+=s.left,i.top+=s.top}return i},setGlobal:function(e,t){return r[e]=t,n+'["'+e+'"]'},unsetGlobal:function(e){delete r[e]},copyAttributes:function(t,n){var r=n.attributes,i=r.length;while(i--){var s=r[i];s.nodeName!="style"&&s.nodeName!="class"&&(!e.ie||s.specified)&&t.setAttribute(s.nodeName,s.nodeValue)}n.className&&(t.className+=" "+n.className),n.style.cssText&&(t.style.cssText+=";"+n.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&(e===t?!1:e.contains?e.contains(t):e.compareDocumentPosition(t)&16)},startDrag:function(e,t,n){function s(e){var n=e.clientX-r,s=e.clientY-i;t.ondragmove(n,s),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}var n=n||document,r=e.clientX,i=e.clientY;if(n.addEventListener){function o(e){n.removeEventListener("mousemove",s,!0),n.removeEventListener("mouseup",s,!0),window.removeEventListener("mouseup",o,!0),t.ondragstop()}n.addEventListener("mousemove",s,!0),n.addEventListener("mouseup",o,!0),window.addEventListener("mouseup",o,!0),e.preventDefault()}else{var u=e.srcElement;u.setCapture();function a(){u.releaseCapture(),u.detachEvent("onmousemove",s),u.detachEvent("onmouseup",a),u.detachEvent("onlosecaptrue",a),t.ondragstop()}u.attachEvent("onmousemove",s),u.attachEvent("onmouseup",a),u.attachEvent("onlosecaptrue",a),e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var t=document.getElementById("edui_fixedlayer");return t==null&&(t=document.createElement("div"),t.id="edui_fixedlayer",document.body.appendChild(t),e.ie&&e.version<=8?(t.style.position="absolute",a(),setTimeout(u)):t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.width="0",t.style.height="0"),t},makeUnselectable:function(t){if(e.opera||e.ie&&e.version<9){t.unselectable="on";if(t.hasChildNodes())for(var n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType==1&&o.makeUnselectable(t.childNodes[n])}else t.style.MozUserSelect!==undefined?t.style.MozUserSelect="none":t.style.WebkitUserSelect!==undefined?t.style.WebkitUserSelect="none":t.style.KhtmlUserSelect!==undefined&&(t.style.KhtmlUserSelect="none")}}}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.EventBase,r=baidu.editor.ui.UIBase=function(){};r.prototype={className:"",uiName:"",initOptions:function(e){var n=this;for(var r in e)n[r]=e[r];this.id=this.id||"edui"+t.uid()},initUIBase:function(){this._globalKey=e.unhtml(t.setGlobal(this.id,this))},render:function(e){var n=this.renderHtml(),r=t.createElementByHtml(n),i=this.getDom();i!=null?(i.parentNode.replaceChild(r,i),t.copyAttributes(r,i)):(typeof e=="string"&&(e=document.getElementById(e)),e=e||t.getFixedLayer(),e.appendChild(r)),this.postRender()},getDom:function(e){return e?document.getElementById(this.id+"_"+e):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();e&&baidu.editor.dom.domUtils.remove(e),t.unsetGlobal(this.id)}},e.inherits(r,n)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Separator=function(e){this.initOptions(e),this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},e.inherits(n,t)}(),function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.ui.uiUtils,i=baidu.editor.ui.Mask=function(e){this.initOptions(e),this.initUIBase()};i.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;t.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return!1},_fill:function(){var e=this.getDom(),t=r.getViewportRect();e.style.width=t.width+"px",e.style.height=t.height+"px"}},e.inherits(i,n)}(),function(){function o(e){var t=[];for(var n=0;n<s.length;n++){var r=s[n];r.isHidden()||r.queryAutoHide(e)!==!1&&r.hide()}}var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.dom.domUtils,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup=function(e){this.initOptions(e),this.initPopup()},s=[];i.postHide=o;var u=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];i.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),s.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: white;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div>"+" </div>"+"</div>"},getContentHtmlTpl:function(){return this.content?typeof this.content=="string"?this.content:this.content.renderHtml():""},_UIBase_postRender:r.prototype.postRender,postRender:function(){this.content instanceof r&&this.content.postRender(),this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return t.getClientRect(e)},fitSize:function(){var e=this.getDom("body");e.style.width="",e.style.height="";var t=this.mesureSize();return e.style.width=t.width+"px",e.style.height=t.height+"px",t},showAnchor:function(e,n){this.showAnchorRect(t.getClientRect(e),n)},showAnchorRect:function(e,r,i){this._doAutoRender();var s=t.getViewportRect();this._show();var o=this.fitSize(),a,f,l,c;r?(a=this.canSideLeft&&e.right+o.width>s.right&&e.left>o.width,f=this.canSideUp&&e.top+o.height>s.bottom&&e.bottom>o.height,l=a?e.left-o.width:e.right,c=f?e.bottom-o.height:e.top):(a=this.canSideLeft&&e.right+o.width>s.right&&e.left>o.width,f=this.canSideUp&&e.top+o.height>s.bottom&&e.bottom>o.height,l=a?e.right-o.width:e.left,c=f?e.top-o.height:e.bottom);var h=this.getDom();t.setViewportOffset(h,{left:l,top:c}),n.removeClasses(h,u),h.className+=" "+u[(f?1:0)*2+(a?1:0)],this.editor&&(h.style.zIndex=this.editor.container.style.zIndex*1+10,baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=h.style.zIndex-1)},showAt:function(e){var t=e.left,n=e.top,r={left:t,top:n,right:t,bottom:n,height:0,width:0};this.showAnchorRect(r,!1,!0)},_show:function(){if(this._hidden){var e=this.getDom();e.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(e){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,e||this.fireEvent("hide"))},queryAutoHide:function(e){return!e||!t.contains(this.getDom(),e)}},e.inherits(i,r),n.on(document,"mousedown",function(e){var t=e.target||e.srcElement;o(t)}),n.on(window,"scroll",function(){o()})}(),function(){function i(e,t){var n='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+e+"</div>"+"</div>"+'<table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0">'+'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;padding-top: 2px"><td colspan="10">'+t.getLang("themeColor")+"</td> </tr>"+'<tr class="edui-colorpicker-tablefirstrow" >';for(var i=0;i<r.length;i++)i&&i%10===0&&(n+="</tr>"+(i==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;"><td colspan="10">'+t.getLang("standardColor")+"</td></tr>":"")+"<tr"+(i==60?' class="edui-colorpicker-tablefirstrow"':"")+">"),n+=i<70?'<td style="padding: 0 2px;"><a hidefocus title="'+r[i]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell"'+' data-color="#'+r[i]+'"'+' style="background-color:#'+r[i]+";border:solid #ccc;"+(i<10||i>=60?"border-width:1px;":i>=10&&i<20?"border-width:1px 1px 0 1px;"
:"border-width:0 1px 0 1px;")+'"'+"></a></td>":"";return n+="</tr></table></div>",n}var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.ColorPicker=function(e){this.initOptions(e),this.noColorText=this.noColorText||this.editor.getLang("clearColor"),this.initUIBase()};n.prototype={getHtmlTpl:function(){return i(this.noColorText,this.editor)},_onTableClick:function(e){var t=e.target||e.srcElement,n=t.getAttribute("data-color");n&&this.fireEvent("pickcolor",n)},_onTableOver:function(e){var t=e.target||e.srcElement,n=t.getAttribute("data-color");n&&(this.getDom("preview").style.backgroundColor=n)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},e.inherits(n,t);var r="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.ui.TablePicker=function(e){this.initOptions(e),this.initTablePicker()};r.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span><span class="edui-clickable" onclick="$$._onMore();">'+e.editor.getLang("more")+"</span>"+"</div>"+'<div class="edui-pickarea"'+' onmousemove="$$._onMouseMove(event, this);"'+' onmouseover="$$._onMouseOver(event, this);"'+' onmouseout="$$._onMouseOut(event, this);"'+' onclick="$$._onClick(event, this);"'+">"+'<div id="##_overlay" class="edui-overlay"></div>'+"</div>"+"</div>"+"</div>"},_UIBase_render:n.prototype.render,render:function(e){this._UIBase_render(e),this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(e,t){var n=this.getDom("overlay").style,r=this.lengthOfCellSide;n.width=e*r+"px",n.height=t*r+"px";var i=this.getDom("label");i.innerHTML=e+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row"),this.numCols=e,this.numRows=t},_onMouseOver:function(e,n){var r=e.relatedTarget||e.fromElement;!t.contains(n,r)&&n!==r&&(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="")},_onMouseOut:function(e,n){var r=e.relatedTarget||e.toElement;!t.contains(n,r)&&n!==r&&(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(e,n){var r=this.getDom("overlay").style,i=t.getEventOffset(e),s=this.lengthOfCellSide,o=Math.ceil(i.left/s),u=Math.ceil(i.top/s);this._track(o,u)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)},_onMore:function(){this.fireEvent("more")}},e.inherits(r,n)}(),function(){var e=baidu.editor.browser,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,r='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(e.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return r})},Stateful_onMouseEnter:function(e,t){if(!this.isDisabled()||this.alwalysHoverable)this.addState("hover"),this.fireEvent("over")},Stateful_onMouseLeave:function(e,t){if(!this.isDisabled()||this.alwalysHoverable)this.removeState("hover"),this.removeState("active"),this.fireEvent("out")},Stateful_onMouseOver:function(e,t){var r=e.relatedTarget;!n.contains(t,r)&&t!==r&&this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var r=e.relatedTarget;!n.contains(t,r)&&t!==r&&this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(e,t){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(e,t){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return t.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&t.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){e?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Stateful,r=baidu.editor.ui.Button=function(e){this.initOptions(e),this.initButton()};r.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div>"+"</div>"+"</div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onClick:function(){this.isDisabled()||this.fireEvent("click")}},e.inherits(r,t),e.extend(r.prototype,n)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.dom.domUtils,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.Stateful,s=baidu.editor.ui.SplitButton=function(e){this.initOptions(e),this.initSplitButton()};s.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase(),this.Stateful_init();var e=this;if(this.popup!=null){var t=this.popup;this.popup=null,this.setPopup(t)}},_UIBase_postRender:r.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(n){if(this.popup===n)return;this.popup!=null&&this.popup.dispose(),n.addListener("show",e.bind(this._onPopupShow,this)),n.addListener("hide",e.bind(this._onPopupHide,this)),n.addListener("postrender",e.bind(function(){n.getDom("body").appendChild(t.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(t.getClientRect(this.getDom()).width-2)+'px"></div>')),n.getDom().className+=" "+this.className},this)),this.popup=n},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body">'+'<div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);">'+'<div class="edui-box edui-icon"></div>'+"</div>"+'<div class="edui-box edui-splitborder"></div>'+'<div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div>'+"</div></div></div>"},showPopup:function(){var e=t.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS,e.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(e)},_onArrowClick:function(e,t){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},e.inherits(s,r),e.extend(s.prototype,i,!0)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.ColorPicker,r=baidu.editor.ui.Popup,i=baidu.editor.ui.SplitButton,s=baidu.editor.ui.ColorButton=function(e){this.initOptions(e),this.initColorButton()};s.prototype={initColorButton:function(){var e=this;this.popup=new r({content:new n({noColorText:e.editor.getLang("clearColor"),editor:e.editor,onpickcolor:function(t,n){e._onPickColor(n)},onpicknocolor:function(t,n){e._onPickNoColor(n)}}),editor:e.editor}),this.initSplitButton()},_SplitButton_postRender:i.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(t.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(e){this.getDom("colorlump").style.backgroundColor=e,this.color=e},_onPickColor:function(e){this.fireEvent("pickcolor",e)!==!1&&(this.setColor(e),this.popup.hide())},_onPickNoColor:function(e){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}},e.inherits(s,i)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,n=baidu.editor.ui.TablePicker,r=baidu.editor.ui.SplitButton,i=baidu.editor.ui.TableButton=function(e){this.initOptions(e),this.initTableButton()};i.prototype={initTableButton:function(){var e=this;this.popup=new t({content:new n({editor:e.editor,onpicktable:function(t,n,r){e._onPickTable(n,r)},onmore:function(){e.popup.hide(),e.fireEvent("more")}}),editor:e.editor}),this.initSplitButton()},_onPickTable:function(e,t){this.fireEvent("picktable",e,t)!==!1&&this.popup.hide()}},e.inherits(i,r)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.AutoTypeSetPicker=function(e){this.initOptions(e),this.initAutoTypeSetPicker()};n.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,t=e.options.autotypeset,n=e.getLang("autoTypeSet");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td colspan="2"><input type="checkbox" name="mergeEmptyline" '+(t.mergeEmptyline?"checked":"")+">"+n.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(t.removeEmptyline?"checked":"")+">"+n.delLine+"</td></tr>"+'<tr><td colspan="2"><input type="checkbox" name="removeClass" '+(t.removeClass?"checked":"")+">"+n.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(t.indent?"checked":"")+">"+n.indent+"</td></tr>"+'<tr><td colspan="2"><input type="checkbox" name="textAlign" '+(t.textAlign?"checked":"")+">"+n.alignment+'</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+(t.textAlign&&t["textAlign"]=="left"?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="textAlignValue" value="center" '+(t.textAlign&&t["textAlign"]=="center"?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="textAlignValue" value="right" '+(t.textAlign&&t["textAlign"]=="right"?"checked":"")+">"+e.getLang("justifyright")+" </tr>"+'<tr><td colspan="2"><input type="checkbox" name="imageBlockLine" '+(t.imageBlockLine?"checked":"")+">"+n.imageFloat+"</td>"+'<td colspan="2" id="imageBlockLineValue">'+'<input type="radio" name="imageBlockLineValue" value="none" '+(t.imageBlockLine&&t["imageBlockLine"]=="none"?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="imageBlockLineValue" value="left" '+(t.imageBlockLine&&t["imageBlockLine"]=="left"?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="imageBlockLineValue" value="center" '+(t.imageBlockLine&&t["imageBlockLine"]=="center"?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="imageBlockLineValue" value="right" '+(t.imageBlockLine&&t["imageBlockLine"]=="right"?"checked":"")+">"+e.getLang("justifyright")+"</tr>"+'<tr><td colspan="2"><input type="checkbox" name="clearFontSize" '+(t.clearFontSize?"checked":"")+">"+n.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(t.clearFontFamily?"checked":"")+">"+n.removeFontFamily+"</td></tr>"+'<tr><td colspan="4"><input type="checkbox" name="removeEmptyNode" '+(t.removeEmptyNode?"checked":"")+">"+n.removeHtml+"</td></tr>"+'<tr><td colspan="4"><input type="checkbox" name="pasteFilter" '+(t.pasteFilter?"checked":"")+">"+n.pasteFilter+"</td></tr>"+'<tr><td colspan="4" align="right"><button >'+n.run+"</button></td></tr>"+"</table>"+"</div>"+"</div>"},_UIBase_render:t.prototype.render},e.inherits(n,t)}(),function(){function s(e){var t=e.editor.options.autotypeset,n=e.getDom(),r=domUtils.getElementsByTagName(n,"input");for(var i=r.length-1,s;s=r[i--];)if(s.getAttribute("type")=="checkbox"){var o=s.getAttribute("name");t[o]&&delete t[o];if(s.checked){var u=document.getElementById(o+"Value");if(u)if(/input/ig.test(u.tagName))t[o]=u.value;else{var a=u.getElementsByTagName("input");for(var f=a.length-1,l;l=a[f--];)if(l.checked){t[o]=l.value;break}}else t[o]=!0}}var c=domUtils.getElementsByTagName(n,"select");for(var i=0,h;h=c[i++];){var p=h.getAttribute("name");t[p]=t[p]?h.value:""}e.editor.options.autotypeset=t}var e=baidu.editor.utils,t=baidu.editor.ui.Popup,n=baidu.editor.ui.AutoTypeSetPicker,r=baidu.editor.ui.SplitButton,i=baidu.editor.ui.AutoTypeSetButton=function(e){this.initOptions(e),this.initAutoTypeSetButton()};i.prototype={initAutoTypeSetButton:function(){var e=this;this.popup=new t({content:new n({editor:e.editor}),editor:e.editor,hide:function(){!this._hidden&&this.getDom()&&(s(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}});var r=0;this.popup.addListener("postRenderAfter",function(){var t=this;if(r)return;var n=this.getDom(),i=n.getElementsByTagName("button")[0];i.onclick=function(){s(t),e.editor.execCommand("autotypeset")},r=1}),this.initSplitButton()}},e.inherits(i,r)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.ui.Toolbar=function(e){this.initOptions(e),this.initToolbar()};r.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var e=[];for(var t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){var e=this.getDom();for(var n=0;n<this.items.length;n++)this.items[n].postRender();t.makeUnselectable(e)},_onMouseDown:function(){return!1}},e.inherits(r,n)}(),function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,r=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,s=baidu.editor.ui.Stateful,o=baidu.editor.ui.Menu=function(e){this.initOptions(e),this.initMenu()},u={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};o.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];t=="-"?this.items[e]=this.getSeparator():t instanceof a||(this.items[e]=this.createItem(t))}},getSeparator:function(){return u},createItem:function(e){return new a(e)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0)return this._Popup_getContentHtmlTpl();var e=[];for(var t=0;t<this.items.length;t++){var n=this.items[t];e[t]=n.renderHtml()}return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:i.prototype.postRender,postRender:function(){var e=this;for(var r=0;r<this.items.length;r++){var i=this.items[r];i.ownerMenu=this,i.postRender()}t.on(this.getDom(),"mouseover",function(t){t=t||event;var r=t.relatedTarget||t.fromElement,i=e.getDom();!n.contains(i,r)&&i!==r&&e.fireEvent("over")}),this._Popup_postRender()},queryAutoHide:function(e){if(e){if(n.contains(this.getDom(),e))return!1;for(var t=0;t<this.items.length;t++){var r=this.items[t];if(r.queryAutoHide(e)===!1)return!1}}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer),clearTimeout(t._closingTimer),t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&t.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},e.inherits(o,i);var a=baidu.editor.ui.MenuItem=function(e){this.initOptions(e),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof o)&&(this.subMenu=new o(this.subMenu))};a.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div>"+"</div>"},postRender:function(){var e=this;this.addListener("over",function(){e.ownerMenu.fireEvent("submenuover",e),e.subMenu&&e.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){e.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(e._closingTimer),e._closingTimer=null,e.addState("opened")}),this.ownerMenu.addListener("hide",function(){e.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,n){n!==e&&e.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(t){return t&&n.contains(e.getDom(),t)?!1:this._bakQueryAutoHide(t)}),this.getDom().style.tabIndex="-1",n.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;e.isDisabled()||(e.addState("opened"),clearTimeout(e._showingTimer),clearTimeout(e._closingTimer),e._closingTimer=null,e._showingTimer=setTimeout(function(){e.showSubMenu()},250))},delayHideSubMenu:function(){var e=this;e.isDisabled()||(e.removeState("opened"),clearTimeout(e._showingTimer),e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu(),e._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(e)},_onClick:function(e,t){if(this.hasState("disabled"))return;this.fireEvent("click",e,t)!==!1&&(this.subMenu?this.showSubMenu():i.postHide())},showSubMenu:function(){var e=n.getClientRect(this.getDom());e.right-=5,e.left+=2,e.width-=7,e.top-=4,e.bottom+=4,e.height+=8,this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},e.inherits(a,r),e.extend(a.prototype,s,!0)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.Menu,r=baidu.editor.ui.SplitButton,i=baidu.editor.ui.Combox=function(e){this.initOptions(e),this.initCombox()};i.prototype={uiName:"combox",initCombox:function(){var e=this;this.items=this.items||[];for(var t=0;t<this.items.length;t++){var r=this.items[t];r.uiName="listitem",r.index=t,r.onclick=function(){e.selectByIndex(this.index)}}this.popup=new n({items:this.items,uiName:"list",editor:this.editor}),this.initSplitButton()},_SplitButton_postRender:r.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var e=t.getClientRect(this.getDom());e.top+=1,e.bottom-=1,e.height-=2,this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);t!=-1?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(e)),this.value=e)},setLabel:function(e){this.getDom("button_body").innerHTML=e,this.label=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++)if(e==this.items[t].value)return t;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){e<this.items.length&&this.fireEvent("select",e)!==!1&&(this.selectedIndex=e,this.value=this.items[e].value,this.setLabel(this.items[e].label))}},e.inherits(i,r)}(),function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,r=baidu.editor.ui.Mask,i=baidu.editor.ui.UIBase,s=baidu.editor.ui.Button,o=baidu.editor.ui.Dialog=function(t){this.initOptions(e.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(e,t){return t?this.onok():this.oncancel()}},t)),this.initDialog()},u,a;o.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var e=this;this.initUIBase(),this.modalMask=u||(u=new r({className:"edui-dialog-modalmask"})),this.dragMask=a||(a=new r({className:"edui-dialog-dragmask"})),this.closeButton=new s({className:"edui-dialog-closebutton",title:e.closeDialog,onclick:function(){e.close(!1)}});if(this.buttons)for(var t=0;t<this.buttons.length;t++)this.buttons[t]instanceof s||(this.buttons[t]=new s(this.buttons[t]))},fitSize:function(){var e=this.getDom("body"),t=this.mesureSize();return e.style.width=t.width+"px",e.style.height=t.height+"px",t},safeSetOffset:function(e){var t=this,r=t.getDom(),i=n.getViewportRect(),s=n.getClientRect(r),o=e.left;o+s.width>i.right&&(o=i.right-s.width);var u=e.top;u+s.height>i.bottom&&(u=i.bottom-s.height),r.style.left=Math.max(o,0)+"px",r.style.top=Math.max(u,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var e=n.getViewportRect(),r=this.fitSize(),i=this.getDom("titlebar").offsetHeight|0,s=e.width/2-r.width/2,o=e.height/2-(r.height-i)/2-i,u=this.getDom();this.safeSetOffset({left:Math.max(s|0,0),top:Math.max(o|0,0)}),t.hasClass(u,"edui-state-centered")||(u.className+=" edui-state-centered"),this._show()},getContentHtml:function(){var e="";return typeof this.content=="string"?e=this.content:this.iframeUrl&&(e='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),e},getHtmlTpl:function(){var e="";if(this.buttons){var t=[];for(var n=0;n<this.buttons.length;n++)t[n]=this.buttons[n].renderHtml();e='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+t.join("")+"</div>"+"</div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span>"+"</div>"+this.closeButton.renderHtml()+"</div>"+'<div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+e+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var e=this;this.addListener("show",function(){e.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){e.modalMask.hide()});if(this.buttons)for(var r=0;r<this.buttons.length;r++)this.buttons[r].postRender();t.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e.safeSetOffset(n.getClientRect(e.getDom()))})}),this._hide()},mesureSize:function(){var e=this.getDom("body"),t=n.getClientRect(this.getDom("content")).width,r=e.style;return r.width=t,n.getClientRect(e)},_onTitlebarMouseDown:function(e,r){if(this.draggable){var i,s=n.getViewportRect(),o=this;n.startDrag(e,{ondragstart:function(){i=n.getClientRect(o.getDom()),o.getDom("contmask").style.visibility="visible",o.dragMask.show(o.getDom().style.zIndex-1)},ondragmove:function(e,t){var n=i.left+e,r=i.top+t;o.safeSetOffset({left:n,top:r})},ondragstop:function(){o.getDom("contmask").style.visibility="hidden",t.removeClasses(o.getDom(),["edui-state-centered"]),o.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){this._hidden||(this.getDom().style.display="none",this.getDom().style.zIndex="",this._hidden=!0,this.fireEvent("hide"))},open:function(){if(this.autoReset)try{this.reset()}catch(e){this.render(),this.open()}this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(t){}},_onCloseButtonClick:function(e,t){this.close(!1)},close:function(e){this.fireEvent("close",e)!==!1&&this._hide()}},e.inherits(o,i)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.Menu,n=baidu.editor.ui.SplitButton,r=baidu.editor.ui.MenuButton=function(e){this.initOptions(e),this.initMenuButton()};r.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton",this.popup=new t({items:e.items,className:e.className,editor:e.editor}),this.popup.addListener("show",function(){var t=this;for(var n=0;n<t.items.length;n++)t.items[n].removeState("checked"),t.items[n].value==e._value&&(t.items[n].addState("checked"),this.value=e._value)}),this.initSplitButton()},setValue:function(e){this._value=e}},e.inherits(r,n)}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui,n=t.Dialog;t.Dialog=function(e){var t=new n(e);return t.addListener("hide",function(){if(t.editor){var e=t.editor;try{if(browser.gecko){var n=e.window.scrollY,r=e.window.scrollX;e.body.focus(),e.window.scrollTo(r,n)}else e.focus()}catch(i){}}}),t};var r={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",inserttable:"~/dialogs/table/table.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",highlightcode:"~/dialogs/highlightcode/highlightcode.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"},i=["undo","redo","formatmatch","bold","italic","underline","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","selectmodule"];for(var s=0,o;o=i[s++];)o=o.toLowerCase(),t[o]=function(e){return function(n){var r=new t.Button({className:"edui-for-"+e,title:n.options.labelMap[e]||n.getLang("labelMap."+e)||"",onclick:function(){n.execCommand(e)},showText:!1});return n.addListener("selectionchange",function(t,i,s){var o=n.queryCommandState(e);o==-1?(r.setDisabled(!0),r.setChecked(!1)):s||(r.setDisabled(!1),r.setChecked(o))}),r}}(o);t.cleardoc=function(e){var n=new t.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});return e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("cleardoc")==-1)}),n};var u={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var a in u)(function(e,n){for(var r=0,i;i=n[r++];)(function(n){t[e.replace("float","")+n]=function(r){var i=new t.Button({className:"edui-for-"+e.replace("float","")+n,title:r.options.labelMap[e.replace("float","")+n]||r.getLang("labelMap."+e.replace("float","")+n)||"",onclick:function(){r.execCommand(e,n)}});return r.addListener("selectionchange",function(t,s,o){i.setDisabled(r.queryCommandState(e)==-1),i.setChecked(r.queryCommandValue(e)==n&&!o)}),i}})(i)})(a,u[a]);for(var s=0,o;o=["backcolor","forecolor"][s++];)t[o]=function(e){return function(n){var r=new t.ColorButton({className:"edui-for-"+e,color:"default",title:n.options.labelMap[e]||n.getLang("labelMap."+e)||"",editor:n,onpickcolor:function(t,r){n.execCommand(e,r)},onpicknocolor:function(){n.execCommand(e,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){n.execCommand(e,this.color)}});return n.addListener("selectionchange",function(){r.setDisabled(n.queryCommandState(e)==-1)}),r}}(o);var f={noOk:["searchreplace","help","spechars","webapp"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","highlightcode","insertframe","edittd","scrawl","template","background"]};for(var a in f)(function(n,i){for(var s=0,o;o=i[s++];){if(browser.opera&&o==="searchreplace")continue;(function(i){t[i]=function(s,o,u){o=o||(s.options.iframeUrlMap||{})[i]||r[i],u=s.options.labelMap[i]||s.getLang("labelMap."+i)||"";var a;o&&(a=new t.Dialog(e.extend({iframeUrl:s.ui.mapUrl(o),editor:s,className:"edui-for-"+i,title:u,closeDialog:s.getLang("closeDialog")},n=="ok"?{buttons:[{className:"edui-okbutton",label:s.getLang("ok"),onclick:function(){a.close(!0)}},{className:"edui-cancelbutton",label:s.getLang("cancel"),onclick:function(){a.close(!1)}}]}:{})),s.ui._dialogs[i+"Dialog"]=a);var f=new t.Button({className:"edui-for-"+i,title:u,onclick:function(){if(a)switch(i){case"wordimage":s.execCommand("wordimage","word_img"),s.word_img&&(a.render(),a.open());break;case"scrawl":s.queryCommandState("scrawl")!=-1&&(a.render(),a.open());break;default:a.render(),a.open()}},disabled:i=="scrawl"&&s.queryCommandState("scrawl")==-1});return s.addListener("selectionchange",function(){var e={edittd:1,edittable:1};if(i in e)return;var t=s.queryCommandState(i);f.setDisabled(t==-1),f.setChecked(t)}),f}})(o.toLowerCase())}})(a,f[a]);t.snapscreen=function(e,n,i){i=e.options.labelMap.snapscreen||e.getLang("labelMap.snapscreen")||"";var s=new t.Button({className:"edui-for-snapscreen",title:i,onclick:function(){e.execCommand("snapscreen")},disabled:!browser.ie});if(browser.ie){n=n||(e.options.iframeUrlMap||{}).snapscreen||r.snapscreen;if(n){var o=new t.Dialog({iframeUrl:e.ui.mapUrl(n),editor:e,className:"edui-for-snapscreen",title:i,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),onclick:function(){o.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),onclick:function(){o.close(!1)}}]});o.render(),e.ui._dialogs.snapscreenDialog=o}}return e.addListener("selectionchange",function(){s.setDisabled(e.queryCommandState("snapscreen")==-1)}),s},t.fontfamily=function(n,r,i){r=n.options.fontfamily||[],i=n.options.labelMap.fontfamily||n.getLang("labelMap.fontfamily")||"";for(var s=0,o,u=[];o=r[s];s++){var a=n.getLang("fontfamily")[o.name]||"";(function(t,n){u.push({label:t,value:n,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+e.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(o.label||a,o.val)}var f=new t.Combox({editor:n,items:u,onselect:function(e,t){n.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:i,initValue:i,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t=0,n;n=this.items[t];t++)if(n.value.indexOf(e)!=-1)return t;return-1}});return n.addListener("selectionchange",function(e,t,r){if(!r){var i=n.queryCommandState("FontFamily");if(i==-1)f.setDisabled(!0);else{f.setDisabled(!1);var s=n.queryCommandValue("FontFamily");s&&(s=s.replace(/['"]/g,"").split(",")[0]),f.setValue(s)}}}),f},t.fontsize=function(e,n,r){r=e.options.labelMap.fontsize||e.getLang("labelMap.fontsize")||"",n=
n||e.options.fontsize||[];var i=[];for(var s=0;s<n.length;s++){var o=n[s]+"px";i.push({label:o,value:o,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var u=new t.Combox({editor:e,items:i,title:r,initValue:r,onselect:function(t,n){e.execCommand("FontSize",this.items[n].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return e.addListener("selectionchange",function(t,n,r){if(!r){var i=e.queryCommandState("FontSize");i==-1?u.setDisabled(!0):(u.setDisabled(!1),u.setValue(e.queryCommandValue("FontSize")))}}),u},t.paragraph=function(e,n,r){r=e.options.labelMap.paragraph||e.getLang("labelMap.paragraph")||"",n=e.options.paragraph||[];var i=[];for(var s in n)i.push({value:s,label:n[s]||e.getLang("paragraph")[s],renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var o=new t.Combox({editor:e,items:i,title:r,initValue:r,className:"edui-for-paragraph",onselect:function(t,n){e.execCommand("Paragraph",this.items[n].value)},onbuttonclick:function(){this.showPopup()}});return e.addListener("selectionchange",function(t,n,r){if(!r){var i=e.queryCommandState("Paragraph");if(i==-1)o.setDisabled(!0);else{o.setDisabled(!1);var s=e.queryCommandValue("Paragraph"),u=o.indexByValue(s);u!=-1?o.setValue(s):o.setValue(o.initValue)}}}),o},t.customstyle=function(e){var n=e.options.customstyle||[],r=e.options.labelMap.customstyle||e.getLang("labelMap.customstyle")||"";if(!n)return;var i=e.getLang("customstyle");for(var s=0,o=[],u;u=n[s++];)(function(e){var t={};t.label=e.label?e.label:i[e.name],t.style=e.style,t.className=e.className,t.tag=e.tag,o.push({label:t.label,value:t,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+t.tag+" "+(t.className?' class="'+t.className+'"':"")+(t.style?' style="'+t.style+'"':"")+">"+t.label+"</"+t.tag+">"+"</div>"}})})(u);var a=new t.Combox({editor:e,items:o,title:r,initValue:r,className:"edui-for-customstyle",onselect:function(t,n){e.execCommand("customstyle",this.items[n].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t=0,n;n=this.items[t++];)if(n.label==e)return t-1;return-1}});return e.addListener("selectionchange",function(t,n,r){if(!r){var i=e.queryCommandState("customstyle");if(i==-1)a.setDisabled(!0);else{a.setDisabled(!1);var s=e.queryCommandValue("customstyle"),o=a.indexByValue(s);o!=-1?a.setValue(s):a.setValue(a.initValue)}}}),a},t.inserttable=function(e,n,i){n=n||(e.options.iframeUrlMap||{}).inserttable||r.inserttable,i=e.options.labelMap.inserttable||e.getLang("labelMap.inserttable")||"";if(n){var s=new t.Dialog({iframeUrl:e.ui.mapUrl(n),editor:e,className:"edui-for-inserttable",title:i,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),onclick:function(){s.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),onclick:function(){s.close(!1)}}]});s.render(),e.ui._dialogs.inserttableDialog=s}var o=function(){s&&(browser.webkit&&(s.open(),s.close()),s.open())},u=new t.TableButton({editor:e,title:i,className:"edui-for-inserttable",onpicktable:function(t,n,r){e.execCommand("InsertTable",{numRows:r,numCols:n,border:1})},onmore:o,onbuttonclick:o});return e.addListener("selectionchange",function(){u.setDisabled(e.queryCommandState("inserttable")==-1)}),u},t.lineheight=function(e){var n=e.options.lineheight;for(var r=0,i,s=[];i=n[r++];)s.push({label:i,value:i,onclick:function(){e.execCommand("lineheight",this.value)}});var o=new t.MenuButton({editor:e,className:"edui-for-lineheight",title:e.options.labelMap.lineheight||e.getLang("labelMap.lineheight")||"",items:s,onbuttonclick:function(){var t=e.queryCommandValue("LineHeight")||this.value;e.execCommand("LineHeight",t)}});return e.addListener("selectionchange",function(){var t=e.queryCommandState("LineHeight");if(t==-1)o.setDisabled(!0);else{o.setDisabled(!1);var n=e.queryCommandValue("LineHeight");n&&o.setValue((n+"").replace(/cm/,"")),o.setChecked(t)}}),o};var l=["top","bottom"];for(var c=0,h;h=l[c++];)(function(e){t["rowspacing"+e]=function(n){var r=n.options["rowspacing"+e];for(var i=0,s,o=[];s=r[i++];)o.push({label:s,value:s,onclick:function(){n.execCommand("rowspacing",this.value,e)}});var u=new t.MenuButton({editor:n,className:"edui-for-rowspacing"+e,title:n.options.labelMap["rowspacing"+e]||n.getLang("labelMap.rowspacing"+e)||"",items:o,onbuttonclick:function(){var t=n.queryCommandValue("rowspacing",e)||this.value;n.execCommand("rowspacing",t,e)}});return n.addListener("selectionchange",function(){var t=n.queryCommandState("rowspacing",e);if(t==-1)u.setDisabled(!0);else{u.setDisabled(!1);var r=n.queryCommandValue("rowspacing",e);r&&u.setValue((r+"").replace(/%/,"")),u.setChecked(t)}}),u}})(h);var p=["insertorderedlist","insertunorderedlist"];for(var d=0,v;v=p[d++];)(function(e){t[e]=function(n){var r=n.options[e],i=function(){n.execCommand(e,this.value)},s=[];for(var o in r)s.push({label:r[o]||n.getLang()[e][o]||"",value:o,onclick:i});var u=new t.MenuButton({editor:n,className:"edui-for-"+e,title:n.getLang("labelMap."+e)||"",items:s,onbuttonclick:function(){var t=n.queryCommandValue(e)||this.value;n.execCommand(e,t)}});return n.addListener("selectionchange",function(){var t=n.queryCommandState(e);if(t==-1)u.setDisabled(!0);else{u.setDisabled(!1);var r=n.queryCommandValue(e);u.setValue(r),u.setChecked(t)}}),u}})(v);t.fullscreen=function(e,n){n=e.options.labelMap.fullscreen||e.getLang("labelMap.fullscreen")||"";var r=new t.Button({className:"edui-for-fullscreen",title:n,onclick:function(){e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen()),this.setChecked(e.ui.isFullScreen())}});return e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");r.setDisabled(t==-1),r.setChecked(e.ui.isFullScreen())}),r},t.emotion=function(e,n){var i=new t.MultiMenuPop({title:e.options.labelMap.emotion||e.getLang("labelMap.emotion")||"",editor:e,className:"edui-for-emotion",iframeUrl:e.ui.mapUrl(n||(e.options.iframeUrlMap||{}).emotion||r.emotion)});return e.addListener("selectionchange",function(){i.setDisabled(e.queryCommandState("emotion")==-1)}),i},t.autotypeset=function(e){var n=new t.AutoTypeSetButton({editor:e,title:e.options.labelMap.autotypeset||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});return e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("autotypeset")==-1)}),n}}(),function(){function i(e){this.initOptions(e),this.initEditorUI()}var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,r=baidu.editor.dom.domUtils;i.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars();var e=this.editor,t=this;e.addListener("ready",function(){e.getDialog=function(t){return e.ui._dialogs[t+"Dialog"]},r.on(e.window,"scroll",function(){baidu.editor.ui.Popup.postHide()}),e.options.elementPathEnabled&&(e.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+e.getLang("elementPathTip")+":</div>"),e.options.wordCount&&(e.ui.getDom("wordcount").innerHTML=e.getLang("wordCountTip"),e.addListener("keyup",function(e,n){var r=n.keyCode||n.which;r==32&&t._wordCount()})),!e.options.elementPathEnabled&&!e.options.wordCount&&(e.ui.getDom("elementpath").style.display="none",e.ui.getDom("wordcount").style.display="none");if(!e.selection.isFocus())return;e.fireEvent("selectionchange",!1,!0)}),e.addListener("mousedown",function(e,t){var n=t.target||t.srcElement;baidu.editor.ui.Popup.postHide(n)}),e.addListener("contextmenu",function(e,t){baidu.editor.ui.Popup.postHide()}),e.addListener("selectionchange",function(){e.options.elementPathEnabled&&t[(e.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"](),e.options.wordCount&&t[(e.queryCommandState("wordcount")==-1?"dis":"en")+"ableWordCount"]()});var n=new baidu.editor.ui.Popup({editor:e,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),e.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(t){this.hide(),e.ui._dialogs[t]&&e.ui._dialogs[t].open()},_onImgSetFloat:function(t){this.hide(),e.execCommand("imagefloat",t)},_setIframeAlign:function(e){var t=n.anchorEl,i=t.cloneNode(!0);switch(e){case-2:i.setAttribute("align","");break;case-1:i.setAttribute("align","left");break;case 1:i.setAttribute("align","right");break;case 2:i.setAttribute("align","middle")}t.parentNode.insertBefore(i,t),r.remove(t),n.anchorEl=i,n.showAnchor(n.anchorEl)},_updateIframe:function(){e._iframe=n.anchorEl,e.ui._dialogs.insertframeDialog.open(),n.hide()},_onRemoveButtonClick:function(t){e.execCommand(t),this.hide()},queryAutoHide:function(t){if(t&&t.ownerDocument==e.document)if(t.tagName.toLowerCase()=="img"||r.findParentByTagName(t,"a",!0))return t!==n.anchorEl;return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,t)}});n.render(),e.options.imagePopup&&(e.addListener("mouseover",function(t,r){r=r||window.event;var i=r.target||r.srcElement;if(e.ui._dialogs.insertframeDialog&&/iframe/ig.test(i.tagName)){var s=n.formatHtml("<nobr>"+e.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+e.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+e.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+e.getLang("justifyright")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._setIframeAlign(2) class="edui-clickable">'+e.getLang("justifycenter")+"</span>"+' <span onclick="$$._updateIframe( this);" class="edui-clickable">'+e.getLang("modify")+"</span></nobr>");s?(n.getDom("content").innerHTML=s,n.anchorEl=i,n.showAnchor(n.anchorEl)):n.hide()}}),e.addListener("selectionchange",function(t,i){if(!i)return;var s="",o=e.selection.getRange().getClosedNode(),u=e.ui._dialogs;if(o&&o.tagName=="IMG"){var a="insertimageDialog";o.className.indexOf("edui-faked-video")!=-1&&(a="insertvideoDialog"),o.className.indexOf("edui-faked-webapp")!=-1&&(a="webappDialog"),o.src.indexOf("http://api.map.baidu.com")!=-1&&(a="mapDialog"),o.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1&&(a="gmapDialog"),o.getAttribute("anchorname")&&(a="anchorDialog",s=n.formatHtml("<nobr>"+e.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+e.getLang("modify")+"</span>&nbsp;&nbsp;"+"<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+e.getLang("delete")+"</span></nobr>")),o.getAttribute("word_img")&&(e.word_img=[o.getAttribute("word_img")],a="wordimageDialog");if(!u[a])return;!s&&(s=n.formatHtml("<nobr>"+e.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+e.getLang("default")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+e.getLang("justifyleft")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+e.getLang("justifyright")+"</span>&nbsp;&nbsp;"+'<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+e.getLang("justifycenter")+"</span>&nbsp;&nbsp;"+"<span onclick=\"$$._onImgEditButtonClick('"+a+'\');" class="edui-clickable">'+e.getLang("modify")+"</span></nobr>"))}if(e.ui._dialogs.linkDialog){var f=r.findParentByTagName(e.selection.getStart(),"a",!0),l;if(f&&(l=f.getAttribute("data_ue_src")||f.getAttribute("href",2))){var c=l;l.length>30&&(c=l.substring(0,20)+"..."),s&&(s+='<div style="height:5px;"></div>'),s+=n.formatHtml("<nobr>"+e.getLang("anthorMsg")+': <a target="_blank" href="'+l+'" title="'+l+'" >'+c+"</a>"+' <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+e.getLang("modify")+"</span>"+' <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+e.getLang("clear")+"</span></nobr>"),n.showAnchor(f)}}s?(n.getDom("content").innerHTML=s,n.anchorEl=o||f,n.showAnchor(n.anchorEl)):n.hide()}))},_initToolbars:function(){var e=this.editor,t=this.toolbars||[],n=[];for(var r=0;r<t.length;r++){var i=t[r],s=new baidu.editor.ui.Toolbar;for(var o=0;o<i.length;o++){var u=i[o],a=null;if(typeof u=="string"){u=u.toLowerCase(),u=="|"&&(u="Separator"),baidu.editor.ui[u]&&(a=new baidu.editor.ui[u](e));if(u=="fullscreen"){n&&n[0]?n[0].items.splice(0,0,a):a&&s.items.splice(0,0,a);continue}}else a=u;a&&s.add(a)}n[r]=s}this.toolbars=n},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;">'+'<div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+"</div>"+'<div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div>'+'<div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div>'+'<div style="height:0;overflow:hidden;clear:both;"></div>'+"</div>"+"</div>"+'<div id="##_iframeholder" class="%%-iframeholder"></div>'+'<div id="##_bottombar" class="%%-bottomContainer"><table><tr>'+'<td id="##_elementpath" class="%%-bottombar"></td>'+'<td id="##_wordcount" class="%%-wordcount"></td>'+"</tr></table></div>"+"</div>"},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img"),this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){var e=[];for(var t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},setFullScreen:function(e){if(this._fullscreen!=e){this._fullscreen=e,this.editor.fireEvent("beforefullscreenchange",e);var t=this.editor;if(baidu.editor.browser.gecko)var n=t.selection.getRange().createBookmark();e?(this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,this._updateFullScreen()):(this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,window.scrollTo(0,this._bakScrollTop));if(baidu.editor.browser.gecko){var r=document.createElement("input");document.body.appendChild(r),t.body.contentEditable=!1,setTimeout(function(){r.focus(),setTimeout(function(){t.body.contentEditable=!0,t.selection.getRange().moveToBookmark(n).select(!0),baidu.editor.dom.domUtils.remove(r),e&&window.scroll(0,0)})})}this.editor.fireEvent("fullscreenchanged",e),this.triggerLayout()}},_wordCount:function(){var e=this.getDom("wordcount");if(!this.editor.options.wordCount){e.style.display="none";return}e.innerHTML=this.editor.queryCommandValue("wordcount")},disableWordCount:function(){var e=this.getDom("wordcount");e.innerHTML="",e.style.display="none",this.wordcount=!1},enableWordCount:function(){var e=this.getDom("wordcount");e.style.display="",this.wordcount=!0,this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var e=t.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(this.getDom().style.zIndex*1+100),t.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0))}},_updateElementPath:function(){var e=this.getDom("elementpath"),t;if(this.elementPathEnabled&&(t=this.editor.queryCommandValue("elementpath"))){var n=[];for(var r=0,i;i=t[r];r++)n[r]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+r+'&quot;);">'+i+"</span>");e.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+n.join(" &gt; ")+"</div>"}else e.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="",e.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){n.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();var t=this,r,i=baidu.editor.dom.domUtils,s=function(){clearTimeout(r),r=setTimeout(function(){t._updateFullScreen()})};i.on(window,"resize",s),t.addListener("destroy",function(){i.un(window,"resize",s),clearTimeout(r)})},showToolbarMsg:function(e,t){this.getDom("toolbarmsg_label").innerHTML=e,this.getDom("toolbarmsg").style.display="";if(!t){var n=this.getDom("upload_dialog");n.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom=="1"?e.style.zoom="100%":e.style.zoom="1"}},e.inherits(i,baidu.editor.ui.UIBase),baidu.editor.ui.Editor=function(t){var n=new baidu.editor.Editor(t);n.options.editor=n;var r=n.render;return n.render=function(t){e.domReady(function(){function e(){n.setOpt({labelMap:n.options.labelMap||UE.I18N[n.options.lang].labelMap}),new i(n.options);if(t){t.constructor===String&&(t=document.getElementById(t)),t&&t.getAttribute("name")&&(n.options.textarea=t.getAttribute("name"));if(t&&/script|textarea/ig.test(t.tagName)){var e=document.createElement("div");t.parentNode.insertBefore(e,t);var s=t.value||t.innerHTML;n.options.initialContent=/^[\t\r\n ]*$/.test(s)?n.options.initialContent:s.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),t.id&&(e.id=t.id),t.className&&(e.className=t.className),t.style.cssText&&(e.style.cssText=t.style.cssText),/textarea/i.test(t.tagName)?(n.textarea=t,n.textarea.style.display="none"):t.parentNode.removeChild(t),t=e,t.innerHTML=""}}n.ui.render(t);var o=n.ui.getDom("iframeholder");n.container=n.ui.getDom(),n.container.style.zIndex=n.options.zIndex,r.call(n,o)}n.langIsReady?e():n.addListener("langReady",e)})},n}}(),function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,n=baidu.editor.ui.SplitButton,r=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e),this.initMultiMenu()};r.prototype={initMultiMenu:function(){var e=this;this.popup=new t({content:"",editor:e.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>',e.editor.container.style.zIndex&&(this.getDom().style.zIndex=e.editor.container.style.zIndex*1+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},e.inherits(r,n)}()})();